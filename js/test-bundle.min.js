// peggy 4.1.1
//
// https://peggyjs.org/
//
// Copyright (c) 2024- the Peggy authors
// Licensed under the MIT License.

var global,factory;global=this,factory=function(require$$0,require$$0$1){var generatedParserApi_spec={},grammarLocation,hasRequiredGrammarLocation,grammarError,hasRequiredGrammarError,visitor_1,hasRequiredVisitor,asts_1,hasRequiredAsts,addImportedRules_1,hasRequiredAddImportedRules,fixLibraryNumbers_1,hasRequiredFixLibraryNumbers,opcodes_1,hasRequiredOpcodes,intern,hasRequiredIntern,inferenceMatchResult_1,hasRequiredInferenceMatchResult,generateBytecode_1,hasRequiredGenerateBytecode;function requireGrammarLocation(){if(hasRequiredGrammarLocation)return grammarLocation;hasRequiredGrammarLocation=1;var e=function(){function e(e,t){this.source=e,this.start=t}return e.prototype.toString=function(){return String(this.source)},e.prototype.offset=function(e){return{line:e.line+this.start.line-1,column:1===e.line?e.column+this.start.column-1:e.column,offset:e.offset+this.start.offset}},e.offsetStart=function(e){return e.source&&"function"==typeof e.source.offset?e.source.offset(e.start):e.start},e.offsetEnd=function(e){return e.source&&"function"==typeof e.source.offset?e.source.offset(e.end):e.end},e}();return grammarLocation=e}function requireGrammarError(){if(hasRequiredGrammarError)return grammarError;hasRequiredGrammarError=1;var e,t=grammarError&&grammarError.__extends||(e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)},function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function a(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(a.prototype=r.prototype,new a)}),r=requireGrammarLocation(),a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n=function(e){function n(t,r,o){var s=e.call(this,t)||this;return a(s,n.prototype),s.name="GrammarError",s.location=r,void 0===o&&(o=[]),s.diagnostics=o,s.stage=null,s.problems=[["error",t,r,o]],s}return t(n,e),n.prototype.toString=function(){var t=e.prototype.toString.call(this);this.location&&(t+="\n at ",void 0!==this.location.source&&null!==this.location.source&&(t+="".concat(this.location.source,":")),t+="".concat(this.location.start.line,":").concat(this.location.start.column));for(var r=0,a=this.diagnostics;r<a.length;r++){var n=a[r];t+="\n from ",void 0!==n.location.source&&null!==n.location.source&&(t+="".concat(n.location.source,":")),t+="".concat(n.location.start.line,":").concat(n.location.start.column,": ").concat(n.message)}return t},n.prototype.format=function(e){var t=e.map((function(e){var t=e.source,r=e.text;return{source:t,text:null!=r?String(r).split(/\r\n|\n|\r/g):[]}}));function a(e,a,n){void 0===n&&(n="");var o="",s=t.find((function(t){return t.source===e.source})),i=e.start,c=r.offsetStart(e);if(s){var u=e.end,l=s.text[i.line-1],p=(i.line===u.line?u.column:l.length+1)-i.column||1;n&&(o+="\nnote: ".concat(n)),o+="\n --\x3e ".concat(e.source,":").concat(c.line,":").concat(c.column,"\n").concat("".padEnd(a)," |\n").concat(c.line.toString().padStart(a)," | ").concat(l,"\n").concat("".padEnd(a)," | ").concat("".padEnd(i.column-1)).concat("".padEnd(p,"^"))}else o+="\n at ".concat(e.source,":").concat(c.line,":").concat(c.column),n&&(o+=": ".concat(n));return o}function n(e,t,n,o){void 0===o&&(o=[]);var s=-1/0;s=(s=n?o.reduce((function(e,t){var a=t.location;return Math.max(e,r.offsetStart(a).line)}),n.start.line):Math.max.apply(null,o.map((function(e){return e.location.start.line})))).toString().length;var i="".concat(e,": ").concat(t);n&&(i+=a(n,s));for(var c=0,u=o;c<u.length;c++){var l=u[c];i+=a(l.location,s,l.message)}return i}return this.problems.filter((function(e){return"info"!==e[0]})).map((function(e){return n.apply(void 0,e)})).join("\n\n")},n}(Error);return grammarError=n}function requireVisitor(){if(hasRequiredVisitor)return visitor_1;hasRequiredVisitor=1;var e=visitor_1&&visitor_1.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},t={build:function(t){function r(r){for(var a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];return t[r.type].apply(t,e([r],a,!1))}function a(){}function n(t){for(var a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];return r.apply(void 0,e([t.expression],a,!1))}function o(t){return function(a){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];a[t].forEach((function(t){return r.apply(void 0,e([t],n,!1))}))}}var s={grammar:function(t){for(var a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];for(var o=0,s=t.imports;o<s.length;o++){var i=s[o];r.apply(void 0,e([i],a,!1))}if(t.topLevelInitializer)if(Array.isArray(t.topLevelInitializer))for(var c=0,u=t.topLevelInitializer;c<u.length;c++){var l=u[c];r.apply(void 0,e([l],a,!1))}else r.apply(void 0,e([t.topLevelInitializer],a,!1));if(t.initializer)if(Array.isArray(t.initializer))for(var p=0,f=t.initializer;p<f.length;p++){var d=f[p];r.apply(void 0,e([d],a,!1))}else r.apply(void 0,e([t.initializer],a,!1));t.rules.forEach((function(t){return r.apply(void 0,e([t],a,!1))}))},grammar_import:a,top_level_initializer:a,initializer:a,rule:n,named:n,choice:o("alternatives"),action:n,sequence:o("elements"),labeled:n,text:n,simple_and:n,simple_not:n,optional:n,zero_or_more:n,one_or_more:n,repeated:function(t){for(var a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];return t.delimiter&&r.apply(void 0,e([t.delimiter],a,!1)),r.apply(void 0,e([t.expression],a,!1))},group:n,semantic_and:a,semantic_not:a,rule_ref:a,library_ref:a,literal:a,class:a,any:a};return Object.keys(s).forEach((function(e){Object.prototype.hasOwnProperty.call(t,e)||(t[e]=s[e])})),r}};return visitor_1=t}function requireAsts(){if(hasRequiredAsts)return asts_1;hasRequiredAsts=1;var e=requireVisitor();function t(e,t){if(!e||!t)return e||t;var r=Array.isArray(e)?e:[e];return r.push(t),r}var r={findRule:function(e,t){for(var r=0;r<e.rules.length;r++)if(e.rules[r].name===t)return e.rules[r]},indexOfRule:function(e,t){for(var r=0;r<e.rules.length;r++)if(e.rules[r].name===t)return r;return-1},alwaysConsumesOnSuccess:function(t,a){function n(){return!0}function o(){return!1}var s=e.build({choice:function(e){return e.alternatives.every(s)},sequence:function(e){return e.elements.some(s)},simple_and:o,simple_not:o,optional:o,zero_or_more:o,repeated:function(e){var t=e.min?e.min:e.max;return!("constant"!==t.type||0===t.value||!s(e.expression)&&!(t.value>1&&e.delimiter&&s(e.delimiter)))},semantic_and:o,semantic_not:o,rule_ref:function(e){var a=r.findRule(t,e.name);return a?s(a):void 0},library_ref:function(){return!1},literal:function(e){return""!==e.value},class:n,any:n});return s(a)},combine:function(e){return e.reduce((function(e,r){return e.topLevelInitializer=t(e.topLevelInitializer,r.topLevelInitializer),e.initializer=t(e.initializer,r.initializer),e.rules=e.rules.concat(r.rules),e}))}};return asts_1=r}function requireAddImportedRules(){return hasRequiredAddImportedRules?addImportedRules_1:(hasRequiredAddImportedRules=1,addImportedRules_1=function(e){for(var t=0,r=0,a=e.imports;r<a.length;r++){for(var n=a[r],o=0,s=n.what;o<s.length;o++){var i=s[o],c=void 0;switch(i.type){case"import_binding_all":continue;case"import_binding_default":break;case"import_binding":c=i.binding;break;case"import_binding_rename":c=i.rename;break;default:throw new TypeError("Unknown binding type")}e.rules.push({type:"rule",name:i.binding,nameLocation:i.location,expression:{type:"library_ref",name:c,library:n.from.module,libraryNumber:t,location:i.location},location:n.from.location})}t++}})}function requireFixLibraryNumbers(){if(hasRequiredFixLibraryNumbers)return fixLibraryNumbers_1;hasRequiredFixLibraryNumbers=1;var e=requireVisitor();return fixLibraryNumbers_1=function(t,r,a){var n=e.build({library_ref:function(e){-1===e.libraryNumber&&(e.libraryNumber=function(e,t){for(var r=0,a=0,n=e.imports;a<n.length;a++){for(var o=0,s=n[a].what;o<s.length;o++){var i=s[o];if("import_binding_all"===i.type&&i.binding===t)return r}r++}return-1}(t,e.library),-1===e.libraryNumber&&a.error('Unknown module "'.concat(e.library,'"'),e.location))}});n(t)},fixLibraryNumbers_1}function requireOpcodes(){return hasRequiredOpcodes?opcodes_1:(hasRequiredOpcodes=1,opcodes_1={PUSH:0,PUSH_EMPTY_STRING:35,PUSH_UNDEFINED:1,PUSH_NULL:2,PUSH_FAILED:3,PUSH_EMPTY_ARRAY:4,PUSH_CURR_POS:5,POP:6,POP_CURR_POS:7,POP_N:8,NIP:9,APPEND:10,WRAP:11,TEXT:12,PLUCK:36,IF:13,IF_ERROR:14,IF_NOT_ERROR:15,IF_LT:30,IF_GE:31,IF_LT_DYNAMIC:32,IF_GE_DYNAMIC:33,WHILE_NOT_ERROR:16,MATCH_ANY:17,MATCH_STRING:18,MATCH_STRING_IC:19,MATCH_CHAR_CLASS:20,MATCH_REGEXP:20,ACCEPT_N:21,ACCEPT_STRING:22,FAIL:23,LOAD_SAVED_POS:24,UPDATE_SAVED_POS:25,CALL:26,RULE:27,LIBRARY_RULE:41,SILENT_FAILS_ON:28,SILENT_FAILS_OFF:29,SOURCE_MAP_PUSH:37,SOURCE_MAP_POP:38,SOURCE_MAP_LABEL_PUSH:39,SOURCE_MAP_LABEL_POP:40})}function requireIntern(){if(hasRequiredIntern)return intern;hasRequiredIntern=1;var e=intern&&intern.__assign||function(){return e=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},e.apply(this,arguments)},t=function(){function t(t){this.options=e({stringify:String,convert:function(e){return e}},t),this.items=[],this.offsets=Object.create(null)}return t.prototype.add=function(e){var t=this.options.convert(e);if(!t)return-1;var r=this.options.stringify(t),a=this.offsets[r];return void 0===a&&(a=this.items.push(t)-1,this.offsets[r]=a),a},t.prototype.get=function(e){return this.items[e]},t.prototype.map=function(e){return this.items.map(e)},t}();return intern=t}function requireInferenceMatchResult(){if(hasRequiredInferenceMatchResult)return inferenceMatchResult_1;hasRequiredInferenceMatchResult=1;var e=requireVisitor(),t=requireAsts(),r=requireGrammarError(),a=-1;function n(n){function o(e){return e.match=0}function s(e){return u(e.expression),e.match=1}function i(e){return e.match=u(e.expression)}function c(e,t){for(var r=e.length,n=0,o=0,s=0;s<r;++s){var i=u(e[s]);1===i&&++n,i===a&&++o}return n===r?1:t?o===r?a:0:o>0?a:0}var u=e.build({rule:function(e){var t,a=0;if(void 0===e.match){e.match=0;do{if(t=e.match,e.match=u(e.expression),++a>6)throw new r("Infinity cycle detected when trying to evaluate node match result",e.location)}while(t!==e.match)}return e.match},named:i,choice:function(e){return e.match=c(e.alternatives,!0)},action:i,sequence:function(e){return e.match=c(e.elements,!1)},labeled:i,text:i,simple_and:i,simple_not:function(e){return e.match=-u(e.expression)},optional:s,zero_or_more:s,one_or_more:i,repeated:function(e){var t=u(e.expression),r=e.delimiter?u(e.delimiter):a,n=e.min?e.min:e.max;return"constant"!==n.type||"constant"!==e.max.type?e.match=0:0===e.max.value||null!==e.max.value&&n.value>e.max.value?e.match=a:t===a?e.match=0===n.value?1:a:1===t?e.delimiter&&n.value>=2?e.match=r:e.match=1:e.delimiter&&n.value>=2?e.match=r===a?a:0:e.match=0===n.value?1:0},group:i,semantic_and:o,semantic_not:o,rule_ref:function(e){var r=t.findRule(n,e.name);return r?e.match=u(r):0},library_ref:function(){return 0},literal:function(e){var t=0===e.value.length?1:0;return e.match=t},class:function(e){var t=0===e.parts.length?a:0;return e.match=t},any:o});u(n)}return n.ALWAYS_MATCH=1,n.SOMETIMES_MATCH=0,n.NEVER_MATCH=a,inferenceMatchResult_1=n}function requireGenerateBytecode(){if(hasRequiredGenerateBytecode)return generateBytecode_1;hasRequiredGenerateBytecode=1;var e=generateBytecode_1&&generateBytecode_1.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},t=requireAsts(),r=requireOpcodes(),a=requireVisitor(),n=requireIntern(),o=requireInferenceMatchResult(),s=o.ALWAYS_MATCH,i=o.SOMETIMES_MATCH,c=o.NEVER_MATCH;return generateBytecode_1=function(o,u){var l=new n,p=new n({stringify:JSON.stringify,convert:function(e){return{value:e.parts,inverted:e.inverted,ignoreCase:e.ignoreCase}}}),f=new n({stringify:JSON.stringify}),d=new n,m=[],h=[];function g(e,t,r){var a={predicate:e,params:t,body:r.code,location:r.codeLocation},n=JSON.stringify(a),o=m.findIndex((function(e){return JSON.stringify(e)===n}));return-1===o?m.push(a)-1:o}function b(e){return h.push(e)-1}function v(e){var t={};return Object.keys(e).forEach((function(r){t[r]=e[r]})),t}function y(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return e.concat.apply(e,t)}function A(e,t,r,a){return e===s?r:e===c?a:t.concat([r.length,a.length],r,a)}function x(e,t,a,n){var o=Object.keys(a).map((function(e){return n-a[e]}));return[r.CALL,e,t,o.length].concat(o)}function _(e,t,a){var n=e.match||0;return y([r.PUSH_CURR_POS],[r.SILENT_FAILS_ON],w(e,{sp:a.sp+1,env:v(a.env),action:null}),[r.SILENT_FAILS_OFF],A(t?-n:n,[t?r.IF_ERROR:r.IF_NOT_ERROR],y([r.POP],[t?r.POP:r.POP_CURR_POS],[r.PUSH_UNDEFINED]),y([r.POP],[t?r.POP_CURR_POS:r.POP],[r.PUSH_FAILED])))}function S(e,t,a){var n=g(!0,Object.keys(a.env),e);return y([r.UPDATE_SAVED_POS],x(n,0,a.env,a.sp),A(e.match||0,[r.IF],y([r.POP],t?[r.PUSH_FAILED]:[r.PUSH_UNDEFINED]),y([r.POP],t?[r.PUSH_UNDEFINED]:[r.PUSH_FAILED])))}function E(e){return t=[r.WHILE_NOT_ERROR],a=y([r.APPEND],e),t.concat([a.length],a);var t,a}function R(e,t,a,n){switch(e.type){case"constant":return{pre:[],post:[],sp:a};case"variable":return e.sp=n+a-t[e.value],{pre:[],post:[],sp:a};case"function":return e.sp=n,{pre:x(g(!0,Object.keys(t),{code:e.value,codeLocation:e.codeLocation}),0,t,a),post:[r.NIP],sp:a+1};default:throw function(e){return new Error('Unknown boundary type "'.concat(e.type,'" for the "repeated" node'))}(e)}}function C(e,t){if(null!==t.value){var a="constant"===t.type?[r.IF_GE,t.value]:[r.IF_GE_DYNAMIC,t.sp||0];return A(i,a,[r.PUSH_FAILED],e)}return e}var T,w=(T={grammar:function(e){e.rules.forEach(w),e.literals=l.items,e.classes=p.items,e.expectations=f.items,e.importedNames=d.items,e.functions=m,e.locations=h},rule:function(e){e.bytecode=w(e.expression,{sp:-1,env:{},pluck:[],action:null})},named:function(e,t){var a=e.match||0,n=a===c?-1:f.add({type:"rule",value:e.name});return y([r.SILENT_FAILS_ON],w(e.expression,t),[r.SILENT_FAILS_OFF],A(a,[r.IF_ERROR],[r.FAIL,n],[]))},choice:function(e,t){return function e(t,a){var n=t[0].match||0,o=w(t[0],{sp:a.sp,env:v(a.env),action:null});return n===s?o:y(o,t.length>1?A(i,[r.IF_ERROR],y([r.POP],e(t.slice(1),a)),[]):[])}(e.alternatives,t)},action:function(e,t){var a=v(t.env),n="sequence"!==e.expression.type||0===e.expression.elements.length,o=w(e.expression,{sp:t.sp+(n?1:0),env:a,action:e}),s=e.expression.match||0,i=n&&s!==c?g(!1,Object.keys(a),e):-1;return n?y([r.PUSH_CURR_POS],o,A(s,[r.IF_NOT_ERROR],y([r.LOAD_SAVED_POS,1],x(i,1,a,t.sp+2)),[]),[r.NIP]):o},sequence:function(e,t){return y([r.PUSH_CURR_POS],function t(a,n){if(a.length>0){var o=e.elements.length-a.length+1;return y(w(a[0],{sp:n.sp,env:n.env,pluck:n.pluck,action:null}),A(a[0].match||0,[r.IF_NOT_ERROR],t(a.slice(1),{sp:n.sp+1,env:n.env,pluck:n.pluck,action:n.action}),y(o>1?[r.POP_N,o]:[r.POP],[r.POP_CURR_POS],[r.PUSH_FAILED])))}if(n.pluck&&n.pluck.length>0)return y([r.PLUCK,e.elements.length+1,n.pluck.length],n.pluck.map((function(e){return n.sp-e})));if(n.action){var s=g(!1,Object.keys(n.env),n.action);return y([r.LOAD_SAVED_POS,e.elements.length],x(s,e.elements.length+1,n.env,n.sp))}return y([r.WRAP,e.elements.length],[r.NIP])}(e.elements,{sp:t.sp+1,env:t.env,pluck:[],action:t.action}))},labeled:function(e,t){var a=t.env,n=e.label,o=t.sp+1;n&&(a=v(t.env),t.env[n]=o),e.pick&&t.pluck.push(o);var s=w(e.expression,{sp:t.sp,env:a,action:null});return n&&e.labelLocation&&u&&"source-and-map"===u.output?y([r.SOURCE_MAP_LABEL_PUSH,o,l.add(n),b(e.labelLocation)],s,[r.SOURCE_MAP_LABEL_POP,o]):s},text:function(e,t){return y([r.PUSH_CURR_POS],w(e.expression,{sp:t.sp+1,env:v(t.env),action:null}),A(e.match||0,[r.IF_NOT_ERROR],y([r.POP],[r.TEXT]),[r.NIP]))},simple_and:function(e,t){return _(e.expression,!1,t)},simple_not:function(e,t){return _(e.expression,!0,t)},optional:function(e,t){return y(w(e.expression,{sp:t.sp,env:v(t.env),action:null}),A(-(e.expression.match||0),[r.IF_ERROR],y([r.POP],[r.PUSH_NULL]),[]))},zero_or_more:function(e,t){var a=w(e.expression,{sp:t.sp+1,env:v(t.env),action:null});return y([r.PUSH_EMPTY_ARRAY],a,E(a),[r.POP])},one_or_more:function(e,t){var a=w(e.expression,{sp:t.sp+1,env:v(t.env),action:null});return y([r.PUSH_EMPTY_ARRAY],a,A(e.expression.match||0,[r.IF_NOT_ERROR],y(E(a),[r.POP]),y([r.POP],[r.POP],[r.PUSH_FAILED])))},repeated:function(e,t){var a=e.min?e.min:e.max,n="constant"!==a.type||a.value>0,o="constant"!==e.max.type&&null!==e.max.value,s=n?2:1,c=e.min?R(e.min,t.env,t.sp,2+("function"===e.max.type?1:0)):{pre:[],post:[],sp:t.sp},u=R(e.max,t.env,c.sp,s),l=w(e.expression,{sp:u.sp+s,env:v(t.env),action:null}),p=null!==e.delimiter?w(e.expression,{sp:u.sp+s+1,env:v(t.env),action:null}):l,f=function(e,t,a,n,o){return e?y([r.PUSH_CURR_POS],w(e,{sp:n.sp+o+1,env:v(n.env),action:null}),A(e.match||0,[r.IF_NOT_ERROR],y([r.POP],a,A(-t,[r.IF_ERROR],[r.POP,r.POP_CURR_POS,r.PUSH_FAILED],[r.NIP])),[r.NIP])):a}(e.delimiter,e.expression.match||0,p,t,s),d=C(f,e.max),m=o?C(l,e.max):l,h=y(n?[r.PUSH_CURR_POS]:[],[r.PUSH_EMPTY_ARRAY],m,E(d),[r.POP]);return y(c.pre,u.pre,n?function(e,t){var a="constant"===t.type?[r.IF_LT,t.value]:[r.IF_LT_DYNAMIC,t.sp||0];return y(e,A(i,a,[r.POP,r.POP_CURR_POS,r.PUSH_FAILED],[r.NIP]))}(h,a):h,u.post,c.post)},group:function(e,t){return w(e.expression,{sp:t.sp,env:v(t.env),action:null})},semantic_and:function(e,t){return S(e,!1,t)},semantic_not:function(e,t){return S(e,!0,t)},rule_ref:function(e){return[r.RULE,t.indexOfRule(o,e.name)]},library_ref:function(e){return[r.LIBRARY_RULE,e.libraryNumber,d.add(e.name)]},literal:function(e){if(e.value.length>0){var t=e.match||0,a=t===i||t===s&&!e.ignoreCase?l.add(e.ignoreCase?e.value.toLowerCase():e.value):-1,n=t!==s?f.add({type:"literal",value:e.value,ignoreCase:e.ignoreCase}):-1;return A(t,e.ignoreCase?[r.MATCH_STRING_IC,a]:[r.MATCH_STRING,a],e.ignoreCase?[r.ACCEPT_N,e.value.length]:[r.ACCEPT_STRING,a],[r.FAIL,n])}return[r.PUSH_EMPTY_STRING]},class:function(e){var t=e.match||0,a=t===i?p.add(e):-1,n=t!==s?f.add({type:"class",value:e.parts,inverted:e.inverted,ignoreCase:e.ignoreCase}):-1;return A(t,[r.MATCH_CHAR_CLASS,a],[r.ACCEPT_N,1],[r.FAIL,n])},any:function(e){var t=e.match||0,a=t!==s?f.add({type:"any"}):-1;return A(t,[r.MATCH_ANY],[r.ACCEPT_N,1],[r.FAIL,a])}},u&&"source-and-map"===u.output&&Object.keys(T).forEach((function(t){var a=T[t];T[t]=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];var s=a.apply(void 0,e([t],n,!1));return void 0!==s&&t.location?y([r.SOURCE_MAP_PUSH,b(t.location)],s,[r.SOURCE_MAP_POP]):s}})),a.build(T));w(o)},generateBytecode_1}var sourceMap$1={},sourceMapGenerator$1={},base64Vlq$1={},base64$1={},hasRequiredBase64$1,hasRequiredBase64Vlq$1;function requireBase64$1(){if(hasRequiredBase64$1)return base64$1;hasRequiredBase64$1=1;const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return base64$1.encode=function(t){if(0<=t&&t<e.length)return e[t];throw new TypeError("Must be between 0 and 63: "+t)},base64$1}function requireBase64Vlq$1(){if(hasRequiredBase64Vlq$1)return base64Vlq$1;hasRequiredBase64Vlq$1=1;const e=requireBase64$1();return base64Vlq$1.encode=function(t){let r,a="",n=function(e){return e<0?1+(-e<<1):0+(e<<1)}(t);do{r=31&n,n>>>=5,n>0&&(r|=32),a+=e.encode(r)}while(n>0);return a},base64Vlq$1}var util$1={},hasRequiredUtil$1;function requireUtil$1(){if(hasRequiredUtil$1)return util$1;hasRequiredUtil$1=1,util$1.getArg=function(e,t,r){if(t in e)return e[t];if(3===arguments.length)return r;throw new Error('"'+t+'" is a required argument.')};const e=!("__proto__"in Object.create(null));function t(e){return e}function r(e){if(!e)return!1;const t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(let r=t-10;r>=0;r--)if(36!==e.charCodeAt(r))return!1;return!0}function a(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}util$1.toSetString=e?t:function(e){return r(e)?"$"+e:e},util$1.fromSetString=e?t:function(e){return r(e)?e.slice(1):e},util$1.compareByGeneratedPositionsInflated=function(e,t){let r=e.generatedLine-t.generatedLine;return 0!==r?r:(r=e.generatedColumn-t.generatedColumn,0!==r?r:(r=a(e.source,t.source),0!==r?r:(r=e.originalLine-t.originalLine,0!==r?r:(r=e.originalColumn-t.originalColumn,0!==r?r:a(e.name,t.name)))))};const n="http://host";function o(e){return t=>{const r=u(t),a=i(t),n=new URL(t,a);e(n);const o=n.toString();return"absolute"===r?o:"scheme-relative"===r?o.slice(5):"path-absolute"===r?o.slice(11):l(a,o)}}function s(e,t){return new URL(e,t).toString()}function i(e){const t=e.split("..").length-1,r=function(e,t){let r=0;for(;;){const e="p"+r++;if(-1===t.indexOf(e))return e}}(0,e);let a=`${n}/`;for(let e=0;e<t;e++)a+=`${r}/`;return a}const c=/^[A-Za-z0-9\+\-\.]+:/;function u(e){return"/"===e[0]?"/"===e[1]?"scheme-relative":"path-absolute":c.test(e)?"absolute":"path-relative"}function l(e,t){"string"==typeof e&&(e=new URL(e)),"string"==typeof t&&(t=new URL(t));const r=t.pathname.split("/"),a=e.pathname.split("/");for(a.length>0&&!a[a.length-1]&&a.pop();r.length>0&&a.length>0&&r[0]===a[0];)r.shift(),a.shift();return a.map((()=>"..")).concat(r).join("/")+t.search+t.hash}const p=o((e=>{e.pathname=e.pathname.replace(/\/?$/,"/")})),f=o((e=>{}));return util$1.normalize=f,util$1.join=function(e,t){const r=u(t),a=u(e);if(e=p(e),"absolute"===r)return s(t,void 0);if("absolute"===a)return s(t,e);if("scheme-relative"===r)return f(t);if("scheme-relative"===a)return s(t,s(e,n)).slice(5);if("path-absolute"===r)return f(t);if("path-absolute"===a)return s(t,s(e,n)).slice(11);const o=i(t+e);return l(o,s(t,s(e,o)))},util$1.relative=function(e,t){const r=function(e,t){if(u(e)!==u(t))return null;const r=i(e+t),a=new URL(e,r),n=new URL(t,r);try{new URL("",n.toString())}catch(e){return null}return n.protocol!==a.protocol||n.user!==a.user||n.password!==a.password||n.hostname!==a.hostname||n.port!==a.port?null:l(a,n)}(e,t);return"string"==typeof r?r:f(t)},util$1}var arraySet$1={},hasRequiredArraySet$1;function requireArraySet$1(){if(hasRequiredArraySet$1)return arraySet$1;hasRequiredArraySet$1=1;class e{constructor(){this._array=[],this._set=new Map}static fromArray(t,r){const a=new e;for(let e=0,n=t.length;e<n;e++)a.add(t[e],r);return a}size(){return this._set.size}add(e,t){const r=this.has(e),a=this._array.length;r&&!t||this._array.push(e),r||this._set.set(e,a)}has(e){return this._set.has(e)}indexOf(e){const t=this._set.get(e);if(t>=0)return t;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}}return arraySet$1.ArraySet=e,arraySet$1}var mappingList$1={},hasRequiredMappingList$1,hasRequiredSourceMapGenerator$1;function requireMappingList$1(){if(hasRequiredMappingList$1)return mappingList$1;hasRequiredMappingList$1=1;const e=requireUtil$1();return mappingList$1.MappingList=class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(e,t){this._array.forEach(e,t)}add(t){!function(t,r){const a=t.generatedLine,n=r.generatedLine,o=t.generatedColumn,s=r.generatedColumn;return n>a||n==a&&s>=o||e.compareByGeneratedPositionsInflated(t,r)<=0}(this._last,t)?(this._sorted=!1,this._array.push(t)):(this._last=t,this._array.push(t))}toArray(){return this._sorted||(this._array.sort(e.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}},mappingList$1}function requireSourceMapGenerator$1(){if(hasRequiredSourceMapGenerator$1)return sourceMapGenerator$1;hasRequiredSourceMapGenerator$1=1;const e=requireBase64Vlq$1(),t=requireUtil$1(),r=requireArraySet$1().ArraySet,a=requireMappingList$1().MappingList;class n{constructor(e){e||(e={}),this._file=t.getArg(e,"file",null),this._sourceRoot=t.getArg(e,"sourceRoot",null),this._skipValidation=t.getArg(e,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new a,this._sourcesContents=null}static fromSourceMap(e){const r=e.sourceRoot,a=new n({file:e.file,sourceRoot:r});return e.eachMapping((function(e){const n={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(n.source=e.source,null!=r&&(n.source=t.relative(r,n.source)),n.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(n.name=e.name)),a.addMapping(n)})),e.sources.forEach((function(n){let o=n;null!=r&&(o=t.relative(r,n)),a._sources.has(o)||a._sources.add(o);const s=e.sourceContentFor(n);null!=s&&a.setSourceContent(n,s)})),a}addMapping(e){const r=t.getArg(e,"generated"),a=t.getArg(e,"original",null);let n=t.getArg(e,"source",null),o=t.getArg(e,"name",null);this._skipValidation||this._validateMapping(r,a,n,o),null!=n&&(n=String(n),this._sources.has(n)||this._sources.add(n)),null!=o&&(o=String(o),this._names.has(o)||this._names.add(o)),this._mappings.add({generatedLine:r.line,generatedColumn:r.column,originalLine:a&&a.line,originalColumn:a&&a.column,source:n,name:o})}setSourceContent(e,r){let a=e;null!=this._sourceRoot&&(a=t.relative(this._sourceRoot,a)),null!=r?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[t.toSetString(a)]=r):this._sourcesContents&&(delete this._sourcesContents[t.toSetString(a)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))}applySourceMap(e,a,n){let o=a;if(null==a){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');o=e.file}const s=this._sourceRoot;null!=s&&(o=t.relative(s,o));const i=this._mappings.toArray().length>0?new r:this._sources,c=new r;this._mappings.unsortedForEach((function(r){if(r.source===o&&null!=r.originalLine){const a=e.originalPositionFor({line:r.originalLine,column:r.originalColumn});null!=a.source&&(r.source=a.source,null!=n&&(r.source=t.join(n,r.source)),null!=s&&(r.source=t.relative(s,r.source)),r.originalLine=a.line,r.originalColumn=a.column,null!=a.name&&(r.name=a.name))}const a=r.source;null==a||i.has(a)||i.add(a);const u=r.name;null==u||c.has(u)||c.add(u)}),this),this._sources=i,this._names=c,e.sources.forEach((function(r){const a=e.sourceContentFor(r);null!=a&&(null!=n&&(r=t.join(n,r)),null!=s&&(r=t.relative(s,r)),this.setSourceContent(r,a))}),this)}_validateMapping(e,t,r,a){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!r&&!a);else if(!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:a}))}_serializeMappings(){let r,a,n,o,s=0,i=1,c=0,u=0,l=0,p=0,f="";const d=this._mappings.toArray();for(let m=0,h=d.length;m<h;m++){if(a=d[m],r="",a.generatedLine!==i)for(s=0;a.generatedLine!==i;)r+=";",i++;else if(m>0){if(!t.compareByGeneratedPositionsInflated(a,d[m-1]))continue;r+=","}r+=e.encode(a.generatedColumn-s),s=a.generatedColumn,null!=a.source&&(o=this._sources.indexOf(a.source),r+=e.encode(o-p),p=o,r+=e.encode(a.originalLine-1-u),u=a.originalLine-1,r+=e.encode(a.originalColumn-c),c=a.originalColumn,null!=a.name&&(n=this._names.indexOf(a.name),r+=e.encode(n-l),l=n)),f+=r}return f}_generateSourcesContent(e,r){return e.map((function(e){if(!this._sourcesContents)return null;null!=r&&(e=t.relative(r,e));const a=t.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,a)?this._sourcesContents[a]:null}),this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}}return n.prototype._version=3,sourceMapGenerator$1.SourceMapGenerator=n,sourceMapGenerator$1}var sourceNode$1={},hasRequiredSourceNode$1,hasRequiredSourceMap$1,stack,hasRequiredStack;function requireSourceNode$1(){if(hasRequiredSourceNode$1)return sourceNode$1;hasRequiredSourceNode$1=1;const e=requireSourceMapGenerator$1().SourceMapGenerator,t=requireUtil$1(),r=/(\r?\n)/,a="$$$isSourceNode$$$";class n{constructor(e,t,r,n,o){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==o?null:o,this[a]=!0,null!=n&&this.add(n)}static fromStringWithSourceMap(e,a,o){const s=new n,i=e.split(r);let c=0;const u=function(){return e()+(e()||"");function e(){return c<i.length?i[c++]:void 0}};let l,p=1,f=0,d=null;return a.eachMapping((function(e){if(null!==d){if(!(p<e.generatedLine)){l=i[c]||"";const t=l.substr(0,e.generatedColumn-f);return i[c]=l.substr(e.generatedColumn-f),f=e.generatedColumn,m(d,t),void(d=e)}m(d,u()),p++,f=0}for(;p<e.generatedLine;)s.add(u()),p++;f<e.generatedColumn&&(l=i[c]||"",s.add(l.substr(0,e.generatedColumn)),i[c]=l.substr(e.generatedColumn),f=e.generatedColumn),d=e}),this),c<i.length&&(d&&m(d,u()),s.add(i.splice(c).join(""))),a.sources.forEach((function(e){const r=a.sourceContentFor(e);null!=r&&(null!=o&&(e=t.join(o,e)),s.setSourceContent(e,r))})),s;function m(e,r){if(null===e||void 0===e.source)s.add(r);else{const a=o?t.join(o,e.source):e.source;s.add(new n(e.originalLine,e.originalColumn,a,r,e.name))}}}add(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this}prepend(e){if(Array.isArray(e))for(let t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this}walk(e){let t;for(let r=0,n=this.children.length;r<n;r++)t=this.children[r],t[a]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})}join(e){let t,r;const a=this.children.length;if(a>0){for(t=[],r=0;r<a-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this}replaceRight(e,t){const r=this.children[this.children.length-1];return r[a]?r.replaceRight(e,t):"string"==typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this}setSourceContent(e,r){this.sourceContents[t.toSetString(e)]=r}walkSourceContents(e){for(let t=0,r=this.children.length;t<r;t++)this.children[t][a]&&this.children[t].walkSourceContents(e);const r=Object.keys(this.sourceContents);for(let a=0,n=r.length;a<n;a++)e(t.fromSetString(r[a]),this.sourceContents[r[a]])}toString(){let e="";return this.walk((function(t){e+=t})),e}toStringWithSourceMap(t){const r={code:"",line:1,column:0},a=new e(t);let n=!1,o=null,s=null,i=null,c=null;return this.walk((function(e,t){r.code+=e,null!==t.source&&null!==t.line&&null!==t.column?(o===t.source&&s===t.line&&i===t.column&&c===t.name||a.addMapping({source:t.source,original:{line:t.line,column:t.column},generated:{line:r.line,column:r.column},name:t.name}),o=t.source,s=t.line,i=t.column,c=t.name,n=!0):n&&(a.addMapping({generated:{line:r.line,column:r.column}}),o=null,n=!1);for(let s=0,i=e.length;s<i;s++)10===e.charCodeAt(s)?(r.line++,r.column=0,s+1===i?(o=null,n=!1):n&&a.addMapping({source:t.source,original:{line:t.line,column:t.column},generated:{line:r.line,column:r.column},name:t.name})):r.column++})),this.walkSourceContents((function(e,t){a.setSourceContent(e,t)})),{code:r.code,map:a}}}return sourceNode$1.SourceNode=n,sourceNode$1}function requireSourceMap$1(){return hasRequiredSourceMap$1||(hasRequiredSourceMap$1=1,sourceMap$1.SourceMapGenerator=requireSourceMapGenerator$1().SourceMapGenerator,sourceMap$1.SourceNode=requireSourceNode$1().SourceNode),sourceMap$1}function requireStack(){if(hasRequiredStack)return stack;hasRequiredStack=1;var e=requireSourceMap$1().SourceNode,t=requireGrammarLocation(),r=function(){function r(e,t,r,a){this.sp=-1,this.maxSp=-1,this.varName=t,this.ruleName=e,this.type=r,this.bytecode=a,this.labels={},this.sourceMapStack=[]}return r.prototype.name=function(e){if(e<0)throw new RangeError("Rule '".concat(this.ruleName,"': The variable stack underflow: attempt to use a variable '").concat(this.varName,"<x>' at an index ").concat(e,".\nBytecode: ").concat(this.bytecode));return this.varName+e},r.sourceNode=function(r,a,n){var o=t.offsetStart(r);return new e(o.line,o.column?o.column-1:null,String(r.source),a,n)},r.prototype.push=function(t){++this.sp>this.maxSp&&(this.maxSp=this.sp);var a=this.labels[this.sp],n=[this.name(this.sp)," = ",t,";"];if(a){if(this.sourceMapStack.length){var o=r.sourceNode(a.location,n.splice(0,2),a.label),s=this.sourceMapPopInternal(),i=s.parts,c=s.location,u=c.start.offset<a.location.end.offset?{start:a.location.end,end:c.end,source:c.source}:c,l=r.sourceNode(u,n.concat("\n"));return this.sourceMapStack.push([i,i.length+1,c]),new e(null,null,a.location.source,[o,l])}return r.sourceNode(a.location,n.concat("\n"))}return n.join("")},r.prototype.pop=function(e){var t=this;return void 0!==e?(this.sp-=e,Array.from({length:e},(function(e,r){return t.name(t.sp+1+r)}))):this.name(this.sp--)},r.prototype.top=function(){return this.name(this.sp)},r.prototype.index=function(e){if(e<0)throw new RangeError("Rule '".concat(this.ruleName,"': The variable stack overflow: attempt to get a variable at a negative index ").concat(e,".\nBytecode: ").concat(this.bytecode));return this.name(this.sp-e)},r.prototype.result=function(){if(this.maxSp<0)throw new RangeError("Rule '".concat(this.ruleName,"': The variable stack is empty, can't get the result.\nBytecode: ").concat(this.bytecode));return this.name(0)},r.prototype.defines=function(){var e=this;return this.maxSp<0?"":this.type+" "+Array.from({length:this.maxSp+1},(function(t,r){return e.name(r)})).join(", ")+";"},r.prototype.checkedIf=function(e,t,r){var a=this.sp,n=t();if(!r)return[n];var o=this.sp;this.sp=a;var s=r();if(o!==this.sp)throw new Error("Rule '"+this.ruleName+"', position "+e+": Branches of a condition can't move the stack pointer differently (before: "+a+", after then: "+o+", after else: "+this.sp+"). Bytecode: "+this.bytecode);return[n,s]},r.prototype.checkedLoop=function(e,t){var r=this.sp,a=t();if(r!==this.sp)throw new Error("Rule '"+this.ruleName+"', position "+e+": Body of a loop can't move the stack pointer (before: "+r+", after: "+this.sp+"). Bytecode: "+this.bytecode);return a},r.prototype.sourceMapPush=function(e,t){if(this.sourceMapStack.length){var r=this.sourceMapStack[this.sourceMapStack.length-1];r[2].start.offset===t.start.offset&&r[2].end.offset>t.end.offset&&(r[2]={start:t.end,end:r[2].end,source:r[2].source})}this.sourceMapStack.push([e,e.length,t])},r.prototype.sourceMapPopInternal=function(){var r=this.sourceMapStack.pop();if(!r)throw new RangeError("Rule '".concat(this.ruleName,"': Attempting to pop an empty source map stack.\nBytecode: ").concat(this.bytecode));var a=r[0],n=r[1],o=r[2],s=a.splice(n).map((function(t){return t instanceof e?t:t+"\n"}));if(s.length){var i=t.offsetStart(o);a.push(new e(i.line,i.column-1,String(o.source),s))}return{parts:a,location:o}},r.prototype.sourceMapPop=function(e){var t=this.sourceMapPopInternal().location;if(this.sourceMapStack.length&&t.end.offset<this.sourceMapStack[this.sourceMapStack.length-1][2].end.offset){var r=this.sourceMapPopInternal(),a=r.parts,n=r.location,o=n.start.offset<t.end.offset?{start:t.end,end:n.end,source:n.source}:n;this.sourceMapStack.push([a,a.length+(e||0),o])}},r}();return stack=r}var version$1={},hasRequiredVersion;function requireVersion(){return hasRequiredVersion||(hasRequiredVersion=1,version$1.version="4.1.1"),version$1}var utils$1={},hasRequiredUtils$1,parser,hasRequiredParser,generateJs,hasRequiredGenerateJs,removeProxyRules_1,hasRequiredRemoveProxyRules,mergeCharacterClasses_1,hasRequiredMergeCharacterClasses,reportDuplicateImports_1,hasRequiredReportDuplicateImports,reportDuplicateLabels_1,hasRequiredReportDuplicateLabels,reportDuplicateRules_1,hasRequiredReportDuplicateRules,reportInfiniteRecursion_1,hasRequiredReportInfiniteRecursion,reportInfiniteRepetition_1,hasRequiredReportInfiniteRepetition,reportUndefinedRules_1,hasRequiredReportUndefinedRules,reportIncorrectPlucking_1,hasRequiredReportIncorrectPlucking,session,hasRequiredSession,compiler_1,hasRequiredCompiler,peg_1,hasRequiredPeg;function requireUtils$1(){if(hasRequiredUtils$1)return utils$1;function e(e){return e.charCodeAt(0).toString(16).toUpperCase()}return hasRequiredUtils$1=1,utils$1.hex=e,utils$1.stringEscape=function(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\v/g,"\\v").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+e(t)})).replace(/[\x10-\x1F\x7F-\xFF]/g,(function(t){return"\\x"+e(t)})).replace(/[\u0100-\u0FFF]/g,(function(t){return"\\u0"+e(t)})).replace(/[\u1000-\uFFFF]/g,(function(t){return"\\u"+e(t)}))},utils$1.regexpClassEscape=function(t){return t.replace(/\\/g,"\\\\").replace(/\//g,"\\/").replace(/]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\v/g,"\\v").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+e(t)})).replace(/[\x10-\x1F\x7F-\xFF]/g,(function(t){return"\\x"+e(t)})).replace(/[\u0100-\u0FFF]/g,(function(t){return"\\u0"+e(t)})).replace(/[\u1000-\uFFFF]/g,(function(t){return"\\u"+e(t)}))},utils$1.base64=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=e.length%3,a=e.length-r,n="",o=0;o<a;o+=3)n+=t[e[o]>>2],n+=t[(3&e[o])<<4|e[o+1]>>4],n+=t[(15&e[o+1])<<2|e[o+2]>>6],n+=t[63&e[o+2]];return 1===r?(n+=t[e[a]>>2],n+=t[(3&e[a])<<4],n+="=="):2===r&&(n+=t[e[a]>>2],n+=t[(3&e[a])<<4|e[a+1]>>4],n+=t[(15&e[a+1])<<2],n+="="),n},utils$1}function requireParser(){if(hasRequiredParser)return parser;hasRequiredParser=1;var e={$:"text","&":"simple_and","!":"simple_not"},t={"?":"optional","*":"zero_or_more","+":"one_or_more"},r={"&":"semantic_and","!":"semantic_not"};function a(e,t,r,n){var o=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(o,a.prototype),o.expected=t,o.found=r,o.location=n,o.name="SyntaxError",o}function n(e,t,r){return r=r||" ",e.length>t?e:(t-=e.length,e+(r+=r.repeat(t)).slice(0,t))}return function(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}(a,Error),a.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var r,a=null;for(r=0;r<e.length;r++)if(e[r].source===this.location.source){a=e[r].text.split(/\r\n|\n|\r/g);break}var o=this.location.start,s=this.location.source&&"function"==typeof this.location.source.offset?this.location.source.offset(o):o,i=this.location.source+":"+s.line+":"+s.column;if(a){var c=this.location.end,u=n("",s.line.toString().length," "),l=a[o.line-1],p=(o.line===c.line?c.column:l.length+1)-o.column||1;t+="\n --\x3e "+i+"\n"+u+" |\n"+s.line+" | "+l+"\n"+u+" | "+n("",o.column-1," ")+n("",p,"^")}else t+="\n at "+i}return t},a.buildMessage=function(e,t){var r={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?o(e[0])+"-"+o(e[1]):o(e)}));return"["+(e.inverted?"^":"")+t.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function a(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}function s(e){return r[e.type](e)}return"Expected "+function(e){var t,r,a=e.map(s);if(a.sort(),a.length>0){for(t=1,r=1;t<a.length;t++)a[t-1]!==a[t]&&(a[r]=a[t],r++);a.length=r}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+n(e)+'"':"end of input"}(t)+" found."},parser={StartRules:["Grammar","ImportsAndSource"],SyntaxError:a,parse:function(n,o){var s,i={},c=(o=void 0!==o?o:{}).grammarSource,u={Grammar:jr,ImportsAndSource:function(){var e,t,r;return e=Rr,t=function(){var e,t;return e=Rr,t=Rr,Mr(),t=n.substring(t,Rr),Cr=e,Rt(t)}(),r=function(){var e,t,r,a;for(e=Rr,t=Rr,r=[],n.length>Rr?(a=n.charAt(Rr),Rr++):(a=i,0===qr&&Or(fe));a!==i;)r.push(a),n.length>Rr?(a=n.charAt(Rr),Rr++):(a=i,0===qr&&Or(fe));return t=n.substring(t,Rr),Cr=e,Et(t)}(),Cr=e,St(t,r)}},l=jr,p="import",f=";",d=",",m="*",h="as",g="{",b="}",v="from",y="=",A="/",x="@",_=":",S="|",E="..",R="(",C=")",T=".",w="\n",P="\r\n",q="/*",F="*/",$="//",L="\\",B="i",D='"',I="'",k="[",O="^",j="]",M="-",N="0",U="b",G="f",z="n",H="r",V="t",W="v",J="x",Y="u",Z=/^[!$&]/,K=/^[*-+?]/,X=/^[!&]/,Q=/^[\t\v-\f \xA0\u1680\u2000-\u200A\u202F\u205F\u3000\uFEFF]/,ee=/^[\n\r\u2028\u2029]/,te=/^[\r\u2028-\u2029]/,re=/^[A-Z_a-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376-\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E-\u066F\u0671-\u06D3\u06D5\u06E5-\u06E6\u06EE-\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4-\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F-\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC-\u09DD\u09DF-\u09E1\u09F0-\u09F1\u0A05-\u0A0A\u0A0F-\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32-\u0A33\u0A35-\u0A36\u0A38-\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2-\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0-\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F-\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32-\u0B33\u0B35-\u0B39\u0B3D\u0B5C-\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99-\u0B9A\u0B9C\u0B9E-\u0B9F\u0BA3-\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60-\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0-\u0CE1\u0CF1-\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32-\u0E33\u0E40-\u0E46\u0E81-\u0E82\u0E84\u0E87-\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA-\u0EAB\u0EAD-\u0EB0\u0EB2-\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065-\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16EE-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE-\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5-\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2160-\u2188\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2-\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005-\u3007\u3021-\u3029\u3031-\u3035\u3038-\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A-\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6EF\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AD\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5-\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40-\uFB41\uFB43-\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC]/,ae=/^[$0-9_\u0300-\u036F\u0483-\u0487\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u0669\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\u06F0-\u06F9\u0711\u0730-\u074A\u07A6-\u07B0\u07C0-\u07C9\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962-\u0963\u0966-\u096F\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7-\u09C8\u09CB-\u09CD\u09D7\u09E2-\u09E3\u09E6-\u09EF\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47-\u0A48\u0A4B-\u0A4D\u0A51\u0A66-\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2-\u0AE3\u0AE6-\u0AEF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47-\u0B48\u0B4B-\u0B4D\u0B56-\u0B57\u0B62-\u0B63\u0B66-\u0B6F\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0BE6-\u0BEF\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55-\u0C56\u0C62-\u0C63\u0C66-\u0C6F\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5-\u0CD6\u0CE2-\u0CE3\u0CE6-\u0CEF\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62-\u0D63\u0D66-\u0D6F\u0D82-\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DE6-\u0DEF\u0DF2-\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0E50-\u0E59\u0EB1\u0EB4-\u0EB9\u0EBB-\u0EBC\u0EC8-\u0ECD\u0ED0-\u0ED9\u0F18-\u0F19\u0F20-\u0F29\u0F35\u0F37\u0F39\u0F3E-\u0F3F\u0F71-\u0F84\u0F86-\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1040-\u1049\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752-\u1753\u1772-\u1773\u17B4-\u17D3\u17DD\u17E0-\u17E9\u180B-\u180D\u1810-\u1819\u18A9\u1920-\u192B\u1930-\u193B\u1946-\u194F\u19D0-\u19D9\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F-\u1A89\u1A90-\u1A99\u1AB0-\u1ABD\u1B00-\u1B04\u1B34-\u1B44\u1B50-\u1B59\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BB0-\u1BB9\u1BE6-\u1BF3\u1C24-\u1C37\u1C40-\u1C49\u1C50-\u1C59\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8-\u1CF9\u1DC0-\u1DF5\u1DFC-\u1DFF\u200C-\u200D\u203F-\u2040\u2054\u20D0-\u20DC\u20E1\u20E5-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099-\u309A\uA620-\uA629\uA66F\uA674-\uA67D\uA69E-\uA69F\uA6F0-\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880-\uA881\uA8B4-\uA8C4\uA8D0-\uA8D9\uA8E0-\uA8F1\uA900-\uA909\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9D0-\uA9D9\uA9E5\uA9F0-\uA9F9\uAA29-\uAA36\uAA43\uAA4C-\uAA4D\uAA50-\uAA59\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7-\uAAB8\uAABE-\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5-\uAAF6\uABE3-\uABEA\uABEC-\uABED\uABF0-\uABF9\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F\uFE33-\uFE34\uFE4D-\uFE4F\uFF10-\uFF19\uFF3F]/,ne=/^[\n\r"\\\u2028-\u2029]/,oe=/^[\n\r'\\\u2028-\u2029]/,se=/^[\n\r\\-\]\u2028-\u2029]/,ie=/^["'\\]/,ce=/^[0-9ux]/,ue=/^[0-9]/,le=/^[0-9a-f]/i,pe=/^[{}]/,fe={type:"any"},de=Lr("import",!1),me=Lr(";",!1),he=Lr(",",!1),ge=Lr("*",!1),be=Lr("as",!1),ve=Lr("{",!1),ye=Lr("}",!1),Ae=Lr("from",!1),xe=Lr("=",!1),_e=Lr("/",!1),Se=Lr("@",!1),Ee=Lr(":",!1),Re=Br(["!","$","&"],!1,!1),Ce=Br([["*","+"],"?"],!1,!1),Te=Lr("|",!1),we=Lr("..",!1),Pe=Lr("(",!1),qe=Lr(")",!1),Fe=Lr(".",!1),$e=Br(["!","&"],!1,!1),Le=Dr("whitespace"),Be=Br(["\t",["\v","\f"]," ","","",["",""],"","","","\ufeff"],!1,!1),De=Br(["\n","\r","\u2028","\u2029"],!1,!1),Ie=Dr("end of line"),ke=Lr("\n",!1),Oe=Lr("\r\n",!1),je=Br(["\r",["\u2028","\u2029"]],!1,!1),Me=Dr("comment"),Ne=Lr("/*",!1),Ue=Lr("*/",!1),Ge=Lr("//",!1),ze=Dr("identifier"),He=Br([["A","Z"],"_",["a","z"],"","","",["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],"","",["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"","",["",""],["",""],"",["",""],["",""],"",["",""],"","","",["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],"","",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],"","",["",""],["",""],["",""],"",["",""],"",["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],"",["",""],"","",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","","",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"","",["",""],"",["",""],"","","",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"","",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"",["",""],["",""],"","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""]],!1,!1),Ve=Lr("\\",!1),We=Br(["$",["0","9"],"_",["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],"",["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"","","",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],"",["",""],["",""],"",["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],"","","",["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],"",["",""],["",""],["",""],["",""],["",""],""],!1,!1),Je=Dr("literal"),Ye=Lr("i",!1),Ze=Dr("string"),Ke=Lr('"',!1),Xe=Lr("'",!1),Qe=Br(["\n","\r",'"',"\\",["\u2028","\u2029"]],!1,!1),et=Br(["\n","\r","'","\\",["\u2028","\u2029"]],!1,!1),tt=Dr("character class"),rt=Lr("[",!1),at=Lr("^",!1),nt=Lr("]",!1),ot=Lr("-",!1),st=Br(["\n","\r",["\\","]"],["\u2028","\u2029"]],!1,!1),it=Lr("0",!1),ct=Br(['"',"'","\\"],!1,!1),ut=Lr("b",!1),lt=Lr("f",!1),pt=Lr("n",!1),ft=Lr("r",!1),dt=Lr("t",!1),mt=Lr("v",!1),ht=Br([["0","9"],"u","x"],!1,!1),gt=Lr("x",!1),bt=Lr("u",!1),vt=Br([["0","9"]],!1,!1),yt=Br([["0","9"],["a","f"]],!1,!0),At=Dr("code block"),xt=Br(["{","}"],!1,!1),_t=function(e,t,r,a){return{type:"grammar",imports:e,topLevelInitializer:t,initializer:r,rules:a,location:Fr()}},St=function(e,t){return[e,t]},Et=function(e){return{type:"top_level_initializer",code:e,codeLocation:Fr()}},Rt=function(e){return{type:"top_level_initializer",code:e,codeLocation:Fr()}},Ct=function(e,t){return{type:"grammar_import",what:e,from:t,location:Fr()}},Tt=function(e){return{type:"grammar_import",what:[],from:e,location:Fr()}},wt=function(e,t){return t?Array.isArray(t)?(t.unshift(e),t):[e,t]:[e]},Pt=function(e){return{type:"import_binding_default",binding:e[0],location:e[1]}},qt=function(e){return[{type:"import_binding_all",binding:e[0],location:e[1]}]},Ft=function(){return[]},$t=function(e,t){return{type:"import_binding_rename",rename:e[0],renameLocation:e[1],binding:t[0],location:t[1]}},Lt=function(e){return{type:"import_binding",binding:e[0],location:e[1]}},Bt=function(e){return{type:"import_module_specifier",module:e,location:Fr()}},Dt=function(e){return[e,Fr()]},It=function(e){return[e,Fr()]},kt=function(e){return Ta.indexOf(e[0])>=0&&$r("Binding identifier can't be a reserved word \"".concat(e[0],'"'),e[1]),e[0]},Ot=function(e){return{type:"top_level_initializer",code:e[0],codeLocation:e[1],location:Fr()}},jt=function(e){return{type:"initializer",code:e[0],codeLocation:e[1],location:Fr()}},Mt=function(e,t,r){return{type:"rule",name:e[0],nameLocation:e[1],expression:null!==t?{type:"named",name:t,expression:r,location:Fr()}:r,location:Fr()}},Nt=function(e,t){return t.length>0?{type:"choice",alternatives:[e].concat(t),location:Fr()}:e},Ut=function(e,t){return null!==t?{type:"action",expression:e,code:t[0],codeLocation:t[1],location:Fr()}:e},Gt=function(e,t){return t.length>0||"labeled"===e.type&&e.pick?{type:"sequence",elements:[e].concat(t),location:Fr()}:e},zt=function(e,t,r){return r.type.startsWith("semantic_")&&$r('"@" cannot be used on a semantic predicate',e),{type:"labeled",label:null!==t?t[0]:null,labelLocation:null!==t?t[1]:e,pick:!0,expression:r,location:Fr()}},Ht=function(e,t){return{type:"labeled",label:e[0],labelLocation:e[1],expression:t,location:Fr()}},Vt=function(){return Fr()},Wt=function(e){return Ta.indexOf(e[0])>=0&&$r("Label can't be a reserved word \"".concat(e[0],'"'),e[1]),e},Jt=function(t,r){return{type:e[t],expression:r,location:Fr()}},Yt=function(e,r){return{type:t[r],expression:e,location:Fr()}},Zt=function(e,t,r){var a=t[0],n=t[1];return"constant"===n.type&&0===n.value&&$r("The maximum count of repetitions of the rule must be > 0",n.location),{type:"repeated",min:a,max:n,expression:e,delimiter:r,location:Fr()}},Kt=function(e,t){return[null!==e?e:{type:"constant",value:0},null!==t?t:{type:"constant",value:null}]},Xt=function(e){return[null,e]},Qt=function(e){return{type:"constant",value:e,location:Fr()}},er=function(e){return{type:"variable",value:e[0],location:Fr()}},tr=function(e){return{type:"function",value:e[0],codeLocation:e[1],location:Fr()}},rr=function(e){return"labeled"===e.type||"sequence"===e.type?{type:"group",expression:e,location:Fr()}:e},ar=function(e,t){return{type:"library_ref",name:t[0],library:e[0],libraryNumber:-1,location:Fr()}},nr=function(e){return{type:"rule_ref",name:e[0],location:Fr()}},or=function(e,t){return{type:r[e],code:t[0],codeLocation:t[1],location:Fr()}},sr=function(e,t){return[e+t.join(""),Fr()]},ir=function(e,t){return{type:"literal",value:e,ignoreCase:null!==t,location:Fr()}},cr=function(e){return e.join("")},ur=function(e){return e.join("")},lr=function(e,t,r){return{type:"class",parts:t.filter((function(e){return""!==e})),inverted:null!==e,ignoreCase:null!==r,location:Fr()}},pr=function(e,t){return e.charCodeAt(0)>t.charCodeAt(0)&&$r("Invalid character range: "+n.substring(Cr,Rr)+"."),[e,t]},fr=function(){return""},dr=function(){return"\0"},mr=function(){return"\b"},hr=function(){return"\f"},gr=function(){return"\n"},br=function(){return"\r"},vr=function(){return"\t"},yr=function(){return"\v"},Ar=function(e){return String.fromCharCode(parseInt(e,16))},xr=function(e){return String.fromCharCode(parseInt(e,16))},_r=function(){return{type:"any",location:Fr()}},Sr=function(e){return[e,Fr()]},Er=function(e){return parseInt(e,10)},Rr=0|o.peg$currPos,Cr=Rr,Tr=[{line:1,column:1}],wr=Rr,Pr=o.peg$maxFailExpected||[],qr=0|o.peg$silentFails;if(o.startRule){if(!(o.startRule in u))throw new Error("Can't start parsing from rule \""+o.startRule+'".');l=u[o.startRule]}function Fr(){return kr(Cr,Rr)}function $r(e,t){throw function(e,t){return new a(e,null,null,t)}(e,t=void 0!==t?t:kr(Cr,Rr))}function Lr(e,t){return{type:"literal",text:e,ignoreCase:t}}function Br(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function Dr(e){return{type:"other",description:e}}function Ir(e){var t,r=Tr[e];if(r)return r;if(e>=Tr.length)t=Tr.length-1;else for(t=e;!Tr[--t];);for(r={line:(r=Tr[t]).line,column:r.column};t<e;)10===n.charCodeAt(t)?(r.line++,r.column=1):r.column++,t++;return Tr[e]=r,r}function kr(e,t,r){var a=Ir(e),n=Ir(t);return{source:c,start:{offset:e,line:a.line,column:a.column},end:{offset:t,line:n.line,column:n.column}}}function Or(e){Rr<wr||(Rr>wr&&(wr=Rr,Pr=[]),Pr.push(e))}function jr(){var e,t,r,a,o,s,c,u;if(e=Rr,t=Mr(),r=Rr,a=Ra(),o=function(){var e,t,r,a;return e=Rr,123===n.charCodeAt(Rr)?(t=g,Rr++):(t=i,0===qr&&Or(ve)),t!==i&&(r=Sa())!==i?(125===n.charCodeAt(Rr)?(a=b,Rr++):(a=i,0===qr&&Or(ye)),a!==i&&Ca()!==i?(Cr=e,e=Ot(r)):(Rr=e,e=i)):(Rr=e,e=i),e}(),o!==i?r=o:(Rr=r,r=i),r===i&&(r=null),a=Rr,o=Ra(),s=function(){var e,t;return e=Rr,(t=Sa())!==i&&Ca()!==i?(Cr=e,e=jt(t)):(Rr=e,e=i),e}(),s!==i?a=s:(Rr=a,a=i),a===i&&(a=null),o=Ra(),s=[],c=Rr,(u=Wr())!==i?(Ra(),c=u):(Rr=c,c=i),c!==i)for(;c!==i;)s.push(c),c=Rr,(u=Wr())!==i?(Ra(),c=u):(Rr=c,c=i);else s=i;return s!==i?(Cr=e,e=_t(t,r,a,s)):(Rr=e,e=i),e}function Mr(){var e,t;for(e=[],t=Nr();t!==i;)e.push(t),t=Nr();return e}function Nr(){var e,t,r,a,o,s,c,u;return e=Rr,Ra(),n.substr(Rr,6)===p?(t=p,Rr+=6):(t=i,0===qr&&Or(de)),t!==i?(Ra(),r=function(){var e,t,r,a,o;return(e=Ur())===i&&(e=Gr())===i&&(e=Rr,t=function(){var e,t;return e=Rr,(t=Vr())!==i&&(Cr=e,t=Pt(t)),t}(),t!==i?(r=Rr,Ra(),44===n.charCodeAt(Rr)?(a=d,Rr++):(a=i,0===qr&&Or(he)),a!==i?(Ra(),(o=Ur())===i&&(o=Gr()),o!==i?r=o:(Rr=r,r=i)):(Rr=r,r=i),r===i&&(r=null),Cr=e,e=wt(t,r)):(Rr=e,e=i)),e}(),r!==i?(a=Ra(),o=function(){var e,t,r;return e=Rr,n.substr(Rr,4)===v?(t=v,Rr+=4):(t=i,0===qr&&Or(Ae)),t!==i?(Ra(),(r=Hr())!==i?e=r:(Rr=e,e=i)):(Rr=e,e=i),e}(),o!==i?(s=Rr,c=Ra(),59===n.charCodeAt(Rr)?(u=f,Rr++):(u=i,0===qr&&Or(me)),u!==i?s=c=[c,u]:(Rr=s,s=i),s===i&&(s=null),Cr=e,e=Ct(r,o)):(Rr=e,e=i)):(Rr=e,e=i)):(Rr=e,e=i),e===i&&(e=Rr,Ra(),n.substr(Rr,6)===p?(t=p,Rr+=6):(t=i,0===qr&&Or(de)),t!==i?(Ra(),(r=Hr())!==i?(a=Rr,o=Ra(),59===n.charCodeAt(Rr)?(s=f,Rr++):(s=i,0===qr&&Or(me)),s!==i?a=o=[o,s]:(Rr=a,a=i),a===i&&(a=null),Cr=e,e=Tt(r)):(Rr=e,e=i)):(Rr=e,e=i)),e}function Ur(){var e,t,r,a;return e=Rr,42===n.charCodeAt(Rr)?(t=m,Rr++):(t=i,0===qr&&Or(ge)),t!==i?(Ra(),n.substr(Rr,2)===h?(r=h,Rr+=2):(r=i,0===qr&&Or(be)),r!==i?(Ra(),(a=Vr())!==i?(Cr=e,e=qt(a)):(Rr=e,e=i)):(Rr=e,e=i)):(Rr=e,e=i),e}function Gr(){var e,t,r,a,o;return e=Rr,123===n.charCodeAt(Rr)?(t=g,Rr++):(t=i,0===qr&&Or(ve)),t!==i?(Ra(),125===n.charCodeAt(Rr)?(r=b,Rr++):(r=i,0===qr&&Or(ye)),r!==i?(Cr=e,e=Ft()):(Rr=e,e=i)):(Rr=e,e=i),e===i&&(e=Rr,123===n.charCodeAt(Rr)?(t=g,Rr++):(t=i,0===qr&&Or(ve)),t!==i?(Ra(),r=function(){var e,t,r,a,o,s;for(e=Rr,t=[],r=zr();r!==i;)t.push(r),r=Rr,a=Rr,o=Ra(),44===n.charCodeAt(Rr)?(s=d,Rr++):(s=i,0===qr&&Or(he)),s!==i?a=o=[o,s,Ra()]:(Rr=a,a=i),a!==i&&(a=zr())===i?(Rr=r,r=i):r=a;return t.length<1?(Rr=e,e=i):e=t,e}(),r!==i?(Ra(),a=Rr,44===n.charCodeAt(Rr)?(o=d,Rr++):(o=i,0===qr&&Or(he)),o!==i?a=o=[o,Ra()]:(Rr=a,a=i),a===i&&(a=null),125===n.charCodeAt(Rr)?(o=b,Rr++):(o=i,0===qr&&Or(ye)),o!==i?e=r:(Rr=e,e=i)):(Rr=e,e=i)):(Rr=e,e=i)),e}function zr(){var e,t,r,a;return e=Rr,t=function(){var e,t;return(e=ua())===i&&(e=Rr,(t=fa())!==i&&(Cr=e,t=It(t)),e=t),e}(),t!==i?(Ra(),n.substr(Rr,2)===h?(r=h,Rr+=2):(r=i,0===qr&&Or(be)),r!==i?(Ra(),(a=Vr())!==i?(Cr=e,e=$t(t,a)):(Rr=e,e=i)):(Rr=e,e=i)):(Rr=e,e=i),e===i&&(e=Rr,(t=Vr())!==i&&(Cr=e,t=Lt(t)),e=t),e}function Hr(){var e,t;return e=Rr,(t=fa())!==i&&(Cr=e,t=Bt(t)),t}function Vr(){var e,t;return e=Rr,t=function(){var e,t;return e=Rr,(t=ua())!==i&&(Cr=e,t=kt(t)),t}(),t!==i&&(Cr=e,t=Dt(t)),t}function Wr(){var e,t,r,a,o;return e=Rr,(t=ua())!==i?(Ra(),r=Rr,(a=fa())!==i?(Ra(),r=a):(Rr=r,r=i),r===i&&(r=null),61===n.charCodeAt(Rr)?(a=y,Rr++):(a=i,0===qr&&Or(xe)),a!==i?(Ra(),(o=Jr())!==i&&Ca()!==i?(Cr=e,e=Mt(t,r,o)):(Rr=e,e=i)):(Rr=e,e=i)):(Rr=e,e=i),e}function Jr(){var e,t,r,a,o,s;if(e=Rr,(t=Yr())!==i){for(r=[],a=Rr,Ra(),47===n.charCodeAt(Rr)?(o=A,Rr++):(o=i,0===qr&&Or(_e)),o!==i?(Ra(),(s=Yr())!==i?a=s:(Rr=a,a=i)):(Rr=a,a=i);a!==i;)r.push(a),a=Rr,Ra(),47===n.charCodeAt(Rr)?(o=A,Rr++):(o=i,0===qr&&Or(_e)),o!==i?(Ra(),(s=Yr())!==i?a=s:(Rr=a,a=i)):(Rr=a,a=i);Cr=e,e=Nt(t,r)}else Rr=e,e=i;return e}function Yr(){var e,t,r,a;return e=Rr,t=function(){var e,t,r,a,n;if(e=Rr,(t=Zr())!==i){for(r=[],a=Rr,Ra(),(n=Zr())!==i?a=n:(Rr=a,a=i);a!==i;)r.push(a),a=Rr,Ra(),(n=Zr())!==i?a=n:(Rr=a,a=i);Cr=e,e=Gt(t,r)}else Rr=e,e=i;return e}(),t!==i?(r=Rr,Ra(),(a=Sa())!==i?r=a:(Rr=r,r=i),r===i&&(r=null),Cr=e,e=Ut(t,r)):(Rr=e,e=i),e}function Zr(){var e,t,r,a;return e=Rr,t=function(){var e,t;return e=Rr,64===n.charCodeAt(Rr)?(t=x,Rr++):(t=i,0===qr&&Or(Se)),t!==i&&(Cr=e,t=Vt()),t}(),t!==i?((r=Kr())===i&&(r=null),(a=Xr())!==i?(Cr=e,e=zt(t,r,a)):(Rr=e,e=i)):(Rr=e,e=i),e===i&&(e=Rr,(t=Kr())!==i&&(r=Xr())!==i?(Cr=e,e=Ht(t,r)):(Rr=e,e=i),e===i&&(e=Xr())),e}function Kr(){var e,t,r;return e=Rr,(t=ua())!==i?(Ra(),58===n.charCodeAt(Rr)?(r=_,Rr++):(r=i,0===qr&&Or(Ee)),r!==i?(Ra(),Cr=e,e=Wt(t)):(Rr=e,e=i)):(Rr=e,e=i),e}function Xr(){var e,t,r;return e=Rr,t=function(){var e;return e=n.charAt(Rr),Z.test(e)?Rr++:(e=i,0===qr&&Or(Re)),e}(),t!==i?(Ra(),(r=Qr())!==i?(Cr=e,e=Jt(t,r)):(Rr=e,e=i)):(Rr=e,e=i),e===i&&(e=Qr()),e}function Qr(){var e,t,r;return e=Rr,(t=ta())!==i?(Ra(),r=function(){var e;return e=n.charAt(Rr),K.test(e)?Rr++:(e=i,0===qr&&Or(Ce)),e}(),r!==i?(Cr=e,e=Yt(t,r)):(Rr=e,e=i)):(Rr=e,e=i),e===i&&(e=function(){var e,t,r,a,o,s,c;return e=Rr,(t=ta())!==i?(Ra(),124===n.charCodeAt(Rr)?(r=S,Rr++):(r=i,0===qr&&Or(Te)),r!==i?(Ra(),a=function(){var e,t,r,a;return e=Rr,(t=ea())===i&&(t=null),Ra(),n.substr(Rr,2)===E?(r=E,Rr+=2):(r=i,0===qr&&Or(we)),r!==i?(Ra(),(a=ea())===i&&(a=null),Cr=e,e=Kt(t,a)):(Rr=e,e=i),e===i&&(e=Rr,(t=ea())!==i&&(Cr=e,t=Xt(t)),e=t),e}(),a!==i?(Ra(),o=Rr,44===n.charCodeAt(Rr)?(s=d,Rr++):(s=i,0===qr&&Or(he)),s!==i?(Ra(),(c=Jr())!==i?(Ra(),o=c):(Rr=o,o=i)):(Rr=o,o=i),o===i&&(o=null),124===n.charCodeAt(Rr)?(s=S,Rr++):(s=i,0===qr&&Or(Te)),s!==i?(Cr=e,e=Zt(t,a,o)):(Rr=e,e=i)):(Rr=e,e=i)):(Rr=e,e=i)):(Rr=e,e=i),e}(),e===i&&(e=ta())),e}function ea(){var e,t;return e=Rr,t=function(){var e,t,r,a;if(e=Rr,t=Rr,r=[],(a=xa())!==i)for(;a!==i;)r.push(a),a=xa();else r=i;return(t=r!==i?n.substring(t,Rr):r)!==i&&(Cr=e,t=Er(t)),t}(),t!==i&&(Cr=e,t=Qt(t)),(e=t)===i&&(e=Rr,(t=ua())!==i&&(Cr=e,t=er(t)),(e=t)===i&&(e=Rr,(t=Sa())!==i&&(Cr=e,t=tr(t)),e=t)),e}function ta(){var e,t,r,a;return e=function(){var e,t,r;return qr++,e=Rr,(t=fa())!==i?(105===n.charCodeAt(Rr)?(r=B,Rr++):(r=i,0===qr&&Or(Ye)),r===i&&(r=null),Cr=e,e=ir(t,r)):(Rr=e,e=i),qr--,e===i&&(t=i,0===qr&&Or(Je)),e}(),e===i&&(e=function(){var e,t,r,a,o,s;if(qr++,e=Rr,91===n.charCodeAt(Rr)?(t=k,Rr++):(t=i,0===qr&&Or(rt)),t!==i){for(94===n.charCodeAt(Rr)?(r=O,Rr++):(r=i,0===qr&&Or(at)),r===i&&(r=null),a=[],(o=ha())===i&&(o=ga());o!==i;)a.push(o),(o=ha())===i&&(o=ga());93===n.charCodeAt(Rr)?(o=j,Rr++):(o=i,0===qr&&Or(nt)),o!==i?(105===n.charCodeAt(Rr)?(s=B,Rr++):(s=i,0===qr&&Or(Ye)),s===i&&(s=null),Cr=e,e=lr(r,a,s)):(Rr=e,e=i)}else Rr=e,e=i;return qr--,e===i&&(t=i,0===qr&&Or(tt)),e}(),e===i&&(e=function(){var e,t;return e=Rr,46===n.charCodeAt(Rr)?(t=T,Rr++):(t=i,0===qr&&Or(Fe)),t!==i&&(Cr=e,t=_r()),t}(),e===i&&(e=function(){var e,t,r,a,o,s,c;return e=Rr,(t=ua())!==i?(46===n.charCodeAt(Rr)?(r=T,Rr++):(r=i,0===qr&&Or(Fe)),r!==i&&(a=ua())!==i?(Cr=e,e=ar(t,a)):(Rr=e,e=i)):(Rr=e,e=i),e===i&&(e=Rr,(t=ua())!==i?(r=Rr,qr++,a=Rr,o=Ra(),s=Rr,(c=fa())!==i?s=c=[c,Ra()]:(Rr=s,s=i),s===i&&(s=null),61===n.charCodeAt(Rr)?(c=y,Rr++):(c=i,0===qr&&Or(xe)),c!==i?a=o=[o,s,c]:(Rr=a,a=i),qr--,a===i?r=void 0:(Rr=r,r=i),r!==i?(Cr=e,e=nr(t)):(Rr=e,e=i)):(Rr=e,e=i)),e}(),e===i&&(e=function(){var e,t,r;return e=Rr,t=function(){var e;return e=n.charAt(Rr),X.test(e)?Rr++:(e=i,0===qr&&Or($e)),e}(),t!==i?(Ra(),(r=Sa())!==i?(Cr=e,e=or(t,r)):(Rr=e,e=i)):(Rr=e,e=i),e}(),e===i&&(e=Rr,40===n.charCodeAt(Rr)?(t=R,Rr++):(t=i,0===qr&&Or(Pe)),t!==i?(Ra(),(r=Jr())!==i?(Ra(),41===n.charCodeAt(Rr)?(a=C,Rr++):(a=i,0===qr&&Or(qe)),a!==i?(Cr=e,e=rr(r)):(Rr=e,e=i)):(Rr=e,e=i)):(Rr=e,e=i)))))),e}function ra(){var e;return n.length>Rr?(e=n.charAt(Rr),Rr++):(e=i,0===qr&&Or(fe)),e}function aa(){var e;return qr++,e=n.charAt(Rr),Q.test(e)?Rr++:(e=i,0===qr&&Or(Be)),qr--,e===i&&0===qr&&Or(Le),e}function na(){var e;return e=n.charAt(Rr),ee.test(e)?Rr++:(e=i,0===qr&&Or(De)),e}function oa(){var e;return qr++,10===n.charCodeAt(Rr)?(e=w,Rr++):(e=i,0===qr&&Or(ke)),e===i&&(n.substr(Rr,2)===P?(e=P,Rr+=2):(e=i,0===qr&&Or(Oe)),e===i&&(e=n.charAt(Rr),te.test(e)?Rr++:(e=i,0===qr&&Or(je)))),qr--,e===i&&0===qr&&Or(Ie),e}function sa(){var e;return qr++,(e=function(){var e,t,r,a,o,s;if(e=Rr,n.substr(Rr,2)===q?(t=q,Rr+=2):(t=i,0===qr&&Or(Ne)),t!==i){for(r=[],a=Rr,o=Rr,qr++,n.substr(Rr,2)===F?(s=F,Rr+=2):(s=i,0===qr&&Or(Ue)),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i);a!==i;)r.push(a),a=Rr,o=Rr,qr++,n.substr(Rr,2)===F?(s=F,Rr+=2):(s=i,0===qr&&Or(Ue)),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i);n.substr(Rr,2)===F?(a=F,Rr+=2):(a=i,0===qr&&Or(Ue)),a!==i?e=t=[t,r,a]:(Rr=e,e=i)}else Rr=e,e=i;return e}())===i&&(e=ca()),qr--,e===i&&0===qr&&Or(Me),e}function ia(){var e,t,r,a,o,s;if(e=Rr,n.substr(Rr,2)===q?(t=q,Rr+=2):(t=i,0===qr&&Or(Ne)),t!==i){for(r=[],a=Rr,o=Rr,qr++,n.substr(Rr,2)===F?(s=F,Rr+=2):(s=i,0===qr&&Or(Ue)),s===i&&(s=na()),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i);a!==i;)r.push(a),a=Rr,o=Rr,qr++,n.substr(Rr,2)===F?(s=F,Rr+=2):(s=i,0===qr&&Or(Ue)),s===i&&(s=na()),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i);n.substr(Rr,2)===F?(a=F,Rr+=2):(a=i,0===qr&&Or(Ue)),a!==i?e=t=[t,r,a]:(Rr=e,e=i)}else Rr=e,e=i;return e}function ca(){var e,t,r,a,o,s;if(e=Rr,n.substr(Rr,2)===$?(t=$,Rr+=2):(t=i,0===qr&&Or(Ge)),t!==i){for(r=[],a=Rr,o=Rr,qr++,s=na(),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i);a!==i;)r.push(a),a=Rr,o=Rr,qr++,s=na(),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i);e=t=[t,r]}else Rr=e,e=i;return e}function ua(){var e,t,r,a;if(qr++,e=Rr,(t=la())!==i){for(r=[],a=pa();a!==i;)r.push(a),a=pa();Cr=e,e=sr(t,r)}else Rr=e,e=i;return qr--,e===i&&(t=i,0===qr&&Or(ze)),e}function la(){var e,t,r;return e=n.charAt(Rr),re.test(e)?Rr++:(e=i,0===qr&&Or(He)),e===i&&(e=Rr,92===n.charCodeAt(Rr)?(t=L,Rr++):(t=i,0===qr&&Or(Ve)),t!==i&&(r=Aa())!==i?e=r:(Rr=e,e=i)),e}function pa(){var e;return(e=la())===i&&(e=n.charAt(Rr),ae.test(e)?Rr++:(e=i,0===qr&&Or(We))),e}function fa(){var e,t,r,a;if(qr++,e=Rr,34===n.charCodeAt(Rr)?(t=D,Rr++):(t=i,0===qr&&Or(Ke)),t!==i){for(r=[],a=da();a!==i;)r.push(a),a=da();34===n.charCodeAt(Rr)?(a=D,Rr++):(a=i,0===qr&&Or(Ke)),a!==i?(Cr=e,e=cr(r)):(Rr=e,e=i)}else Rr=e,e=i;if(e===i)if(e=Rr,39===n.charCodeAt(Rr)?(t=I,Rr++):(t=i,0===qr&&Or(Xe)),t!==i){for(r=[],a=ma();a!==i;)r.push(a),a=ma();39===n.charCodeAt(Rr)?(a=I,Rr++):(a=i,0===qr&&Or(Xe)),a!==i?(Cr=e,e=ur(r)):(Rr=e,e=i)}else Rr=e,e=i;return qr--,e===i&&(t=i,0===qr&&Or(Ze)),e}function da(){var e,t,r,a;return e=Rr,t=Rr,r=Rr,qr++,a=n.charAt(Rr),ne.test(a)?Rr++:(a=i,0===qr&&Or(Qe)),qr--,a===i?r=void 0:(Rr=r,r=i),r!==i&&(a=ra())!==i?t=r=[r,a]:(Rr=t,t=i),(e=t!==i?n.substring(e,Rr):t)===i&&(e=Rr,92===n.charCodeAt(Rr)?(t=L,Rr++):(t=i,0===qr&&Or(Ve)),t!==i&&(r=va())!==i?e=r:(Rr=e,e=i),e===i&&(e=ba())),e}function ma(){var e,t,r,a;return e=Rr,t=Rr,r=Rr,qr++,a=n.charAt(Rr),oe.test(a)?Rr++:(a=i,0===qr&&Or(et)),qr--,a===i?r=void 0:(Rr=r,r=i),r!==i&&(a=ra())!==i?t=r=[r,a]:(Rr=t,t=i),(e=t!==i?n.substring(e,Rr):t)===i&&(e=Rr,92===n.charCodeAt(Rr)?(t=L,Rr++):(t=i,0===qr&&Or(Ve)),t!==i&&(r=va())!==i?e=r:(Rr=e,e=i),e===i&&(e=ba())),e}function ha(){var e,t,r,a;return e=Rr,(t=ga())!==i?(45===n.charCodeAt(Rr)?(r=M,Rr++):(r=i,0===qr&&Or(ot)),r!==i&&(a=ga())!==i?(Cr=e,e=pr(t,a)):(Rr=e,e=i)):(Rr=e,e=i),e}function ga(){var e,t,r,a;return e=Rr,t=Rr,r=Rr,qr++,a=n.charAt(Rr),se.test(a)?Rr++:(a=i,0===qr&&Or(st)),qr--,a===i?r=void 0:(Rr=r,r=i),r!==i&&(a=ra())!==i?t=r=[r,a]:(Rr=t,t=i),(e=t!==i?n.substring(e,Rr):t)===i&&(e=Rr,92===n.charCodeAt(Rr)?(t=L,Rr++):(t=i,0===qr&&Or(Ve)),t!==i&&(r=va())!==i?e=r:(Rr=e,e=i),e===i&&(e=ba())),e}function ba(){var e,t;return e=Rr,92===n.charCodeAt(Rr)?(t=L,Rr++):(t=i,0===qr&&Or(Ve)),t!==i&&oa()!==i?(Cr=e,e=fr()):(Rr=e,e=i),e}function va(){var e,t,r,a;return e=function(){var e;return(e=ya())===i&&(e=function(){var e,t,r,a;return e=Rr,t=Rr,r=Rr,qr++,a=function(){var e;return(e=ya())===i&&(e=n.charAt(Rr),ce.test(e)?Rr++:(e=i,0===qr&&Or(ht))),e}(),a===i&&(a=na()),qr--,a===i?r=void 0:(Rr=r,r=i),r!==i&&(a=ra())!==i?t=r=[r,a]:(Rr=t,t=i),t!==i?n.substring(e,Rr):t}()),e}(),e===i&&(e=Rr,48===n.charCodeAt(Rr)?(t=N,Rr++):(t=i,0===qr&&Or(it)),t!==i?(r=Rr,qr++,a=xa(),qr--,a===i?r=void 0:(Rr=r,r=i),r!==i?(Cr=e,e=dr()):(Rr=e,e=i)):(Rr=e,e=i),e===i&&(e=function(){var e,t,r,a,o,s;return e=Rr,120===n.charCodeAt(Rr)?(t=J,Rr++):(t=i,0===qr&&Or(gt)),t!==i?(r=Rr,a=Rr,(o=_a())!==i&&(s=_a())!==i?a=o=[o,s]:(Rr=a,a=i),(r=a!==i?n.substring(r,Rr):a)!==i?(Cr=e,e=Ar(r)):(Rr=e,e=i)):(Rr=e,e=i),e}(),e===i&&(e=Aa()))),e}function ya(){var e,t;return e=n.charAt(Rr),ie.test(e)?Rr++:(e=i,0===qr&&Or(ct)),e===i&&(e=Rr,98===n.charCodeAt(Rr)?(t=U,Rr++):(t=i,0===qr&&Or(ut)),t!==i&&(Cr=e,t=mr()),(e=t)===i&&(e=Rr,102===n.charCodeAt(Rr)?(t=G,Rr++):(t=i,0===qr&&Or(lt)),t!==i&&(Cr=e,t=hr()),(e=t)===i&&(e=Rr,110===n.charCodeAt(Rr)?(t=z,Rr++):(t=i,0===qr&&Or(pt)),t!==i&&(Cr=e,t=gr()),(e=t)===i&&(e=Rr,114===n.charCodeAt(Rr)?(t=H,Rr++):(t=i,0===qr&&Or(ft)),t!==i&&(Cr=e,t=br()),(e=t)===i&&(e=Rr,116===n.charCodeAt(Rr)?(t=V,Rr++):(t=i,0===qr&&Or(dt)),t!==i&&(Cr=e,t=vr()),(e=t)===i&&(e=Rr,118===n.charCodeAt(Rr)?(t=W,Rr++):(t=i,0===qr&&Or(mt)),t!==i&&(Cr=e,t=yr()),e=t)))))),e}function Aa(){var e,t,r,a,o,s,c,u;return e=Rr,117===n.charCodeAt(Rr)?(t=Y,Rr++):(t=i,0===qr&&Or(bt)),t!==i?(r=Rr,a=Rr,(o=_a())!==i&&(s=_a())!==i&&(c=_a())!==i&&(u=_a())!==i?a=o=[o,s,c,u]:(Rr=a,a=i),(r=a!==i?n.substring(r,Rr):a)!==i?(Cr=e,e=xr(r)):(Rr=e,e=i)):(Rr=e,e=i),e}function xa(){var e;return e=n.charAt(Rr),ue.test(e)?Rr++:(e=i,0===qr&&Or(vt)),e}function _a(){var e;return e=n.charAt(Rr),le.test(e)?Rr++:(e=i,0===qr&&Or(yt)),e}function Sa(){var e,t,r,a;return qr++,e=Rr,123===n.charCodeAt(Rr)?(t=g,Rr++):(t=i,0===qr&&Or(ve)),t!==i?(r=function(){var e,t;return e=Rr,t=Ea(),Cr=e,t=Sr(t)}(),125===n.charCodeAt(Rr)?(a=b,Rr++):(a=i,0===qr&&Or(ye)),a!==i?e=r:(Rr=e,e=i)):(Rr=e,e=i),qr--,e===i&&(t=i,0===qr&&Or(At)),e}function Ea(){var e,t,r,a,o,s;if(e=Rr,t=[],r=[],a=Rr,o=Rr,qr++,s=n.charAt(Rr),pe.test(s)?Rr++:(s=i,0===qr&&Or(xt)),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i),a!==i)for(;a!==i;)r.push(a),a=Rr,o=Rr,qr++,s=n.charAt(Rr),pe.test(s)?Rr++:(s=i,0===qr&&Or(xt)),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i);else r=i;for(r===i&&(r=Rr,123===n.charCodeAt(Rr)?(a=g,Rr++):(a=i,0===qr&&Or(ve)),a!==i?(o=Ea(),125===n.charCodeAt(Rr)?(s=b,Rr++):(s=i,0===qr&&Or(ye)),s!==i?r=a=[a,o,s]:(Rr=r,r=i)):(Rr=r,r=i));r!==i;){if(t.push(r),r=[],a=Rr,o=Rr,qr++,s=n.charAt(Rr),pe.test(s)?Rr++:(s=i,0===qr&&Or(xt)),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i),a!==i)for(;a!==i;)r.push(a),a=Rr,o=Rr,qr++,s=n.charAt(Rr),pe.test(s)?Rr++:(s=i,0===qr&&Or(xt)),qr--,s===i?o=void 0:(Rr=o,o=i),o!==i&&(s=ra())!==i?a=o=[o,s]:(Rr=a,a=i);else r=i;r===i&&(r=Rr,123===n.charCodeAt(Rr)?(a=g,Rr++):(a=i,0===qr&&Or(ve)),a!==i?(o=Ea(),125===n.charCodeAt(Rr)?(s=b,Rr++):(s=i,0===qr&&Or(ye)),s!==i?r=a=[a,o,s]:(Rr=r,r=i)):(Rr=r,r=i))}return n.substring(e,Rr)}function Ra(){var e,t;for(e=[],(t=aa())===i&&(t=oa())===i&&(t=sa());t!==i;)e.push(t),(t=aa())===i&&(t=oa())===i&&(t=sa());return e}function Ca(){var e,t,r,a;if(e=[],t=Rr,r=Ra(),59===n.charCodeAt(Rr)?(a=f,Rr++):(a=i,0===qr&&Or(me)),a!==i?t=r=[r,a]:(Rr=t,t=i),t!==i)for(;t!==i;)e.push(t),t=Rr,r=Ra(),59===n.charCodeAt(Rr)?(a=f,Rr++):(a=i,0===qr&&Or(me)),a!==i?t=r=[r,a]:(Rr=t,t=i);else e=i;return e===i&&(e=Rr,t=function(){var e,t;for(e=[],(t=aa())===i&&(t=ia());t!==i;)e.push(t),(t=aa())===i&&(t=ia());return e}(),(r=ca())===i&&(r=null),(a=oa())!==i?e=t=[t,r,a]:(Rr=e,e=i),e===i&&(e=Rr,t=Ra(),r=function(){var e,t;return e=Rr,qr++,n.length>Rr?(t=n.charAt(Rr),Rr++):(t=i,0===qr&&Or(fe)),qr--,t===i?e=void 0:(Rr=e,e=i),e}(),r!==i?e=t=[t,r]:(Rr=e,e=i))),e}var Ta=o.reservedWords||[];if(s=l(),o.peg$library)return{peg$result:s,peg$currPos:Rr,peg$FAILED:i,peg$maxFailExpected:Pr,peg$maxFailPos:wr};if(s!==i&&Rr===n.length)return s;throw s!==i&&Rr<n.length&&Or({type:"end"}),function(e,t,r){return new a(a.buildMessage(e,t),e,t,r)}(Pr,wr<n.length?n.charAt(wr):null,wr<n.length?kr(wr,wr+1):kr(wr,wr))}},parser}function requireGenerateJs(){if(hasRequiredGenerateJs)return generateJs;hasRequiredGenerateJs=1;var e=generateJs&&generateJs.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},t=requireAsts(),r=requireOpcodes(),a=requireStack(),n=requireVersion().version,o=requireUtils$1(),s=o.stringEscape,i=o.regexpClassEscape,c=requireSourceMap$1().SourceNode,u=requireGrammarLocation(),l=requireParser().parse;function p(e,t,r){var a=u.offsetStart(t),n=a.line,o=a.column-1,s=e.split("\n");return 1===s.length?new c(n,o,String(t.source),e,r):new c(null,null,String(t.source),s.map((function(e,a){return new c(n+a,0===a?o:0,String(t.source),a===s.length-1?e:[e,"\n"],r)})))}function f(e,t,r,a,n){if(r){var o=u.offsetEnd(r);return new c(null,null,String(r.source),[e,p(t,r,n),new c(o.line,o.column-1,String(r.source),a)])}return new c(null,null,null,[e,t,a])}return generateJs=function(o,d){if(!(o.literals&&o.locations&&o.classes&&o.expectations&&o.functions&&o.importedNames))throw new Error("generateJS: generate bytecode was not called.");var m=o.literals,h=o.locations,g=o.classes,b=o.expectations,v=o.functions,y=o.importedNames;if(!d.allowedStartRules)throw new Error("generateJS: options.allowedStartRules was not set.");var A=d.allowedStartRules,x=d.dependencies||{};function _(e){var t=!0,r=0;return function e(a){return Array.isArray(a)?a.map((function(t){return e(t)})):a instanceof c?(r++,a.children=e(a.children),r--,a):(a=t?a.replace(/^(.+)$/gm,"  $1"):a.replace(/\n(\s*\S)/g,"\n  $1"),t=!r||a.endsWith("\n"),a)}(e)}function S(e){return"peg$c"+e}function E(e){return"peg$r"+e}function R(e){return"peg$e"+e}function C(e){return"peg$f"+e}function T(e){return"peg$import"+e}function w(e){return"peg$parse"+e}function P(e){return e.codeLocation?p(e.code,e.codeLocation,"$"+e.type):e.code}o.code=function(t){function r(){return["// @generated by Peggy ".concat(n,"."),"//","// https://peggyjs.org/"]}function a(){var e=["{"];return d.trace&&e.push("  DefaultTracer: peg$DefaultTracer,"),d.allowedStartRules&&e.push("  StartRules: ["+d.allowedStartRules.map((function(e){return'"'+e+'"'})).join(", ")+"],"),e.push("  SyntaxError: peg$SyntaxError,","  parse: peg$parse"),e.push("}"),e.join("\n")}var i={bare:function(){if(Object.keys(x).length>0||o.imports.length>0)throw new Error("Dependencies not supported in format 'bare'.");return e(e([],r(),!0),["(function() {",'  "use strict";',"",t,"",_("return "+a()+";"),"})()"],!1)},commonjs:function(){var e=Object.keys(x),n=r();n.push("",'"use strict";',""),e.length>0&&(e.forEach((function(e){n.push("var "+e+' = require("'+s(x[e])+'");')})),n.push(""));for(var i=o.imports.length,c=0;c<i;c++)n.push("var "+T(c)+' = require("'+s(o.imports[c].from.module)+'");');return n.push("",t,"","module.exports = "+a()+";"),n},es:function(){var e=Object.keys(x),a=r();a.push(""),e.length>0&&(e.forEach((function(e){a.push("import "+e+' from "'+s(x[e])+'";')})),a.push(""));for(var n=0;n<o.imports.length;n++)a.push("import * as "+T(n)+' from "'+s(o.imports[n].from.module)+'";');return a.push("",t,""),a.push("const peg$allowedStartRules = [","  "+(d.allowedStartRules?d.allowedStartRules.map((function(e){return'"'+e+'"'})).join(",\n  "):""),"];",""),a.push("export {"),d.trace&&a.push("  peg$DefaultTracer as DefaultTracer,"),a.push("  peg$allowedStartRules as StartRules,","  peg$SyntaxError as SyntaxError,","  peg$parse as parse","};"),a},amd:function(){if(o.imports.length>0)throw new Error("Imports are not supported in format 'amd'.");var n=Object.keys(x),i="["+n.map((function(e){return x[e]})).map((function(e){return'"'+s(e)+'"'})).join(", ")+"]",c=n.join(", ");return e(e([],r(),!0),["define("+i+", function("+c+") {",'  "use strict";',"",t,"",_("return "+a()+";"),"});"],!1)},globals:function(){if(Object.keys(x).length>0||o.imports.length>0)throw new Error("Dependencies not supported in format 'globals'.");if(!d.exportVar)throw new Error("No export variable defined for format 'globals'.");return e(e([],r(),!0),["(function(root) {",'  "use strict";',"",t,"",_("root."+d.exportVar+" = "+a()+";"),"})(this);"],!1)},umd:function(){if(o.imports.length>0)throw new Error("Imports are not supported in format 'umd'.");var e=Object.keys(x),n=e.map((function(e){return x[e]})),i="["+n.map((function(e){return'"'+s(e)+'"'})).join(", ")+"]",c=n.map((function(e){return'require("'+s(e)+'")'})).join(", "),u=e.join(", "),l=r();return l.push("(function(root, factory) {",'  if (typeof define === "function" && define.amd) {',"    define("+i+", factory);",'  } else if (typeof module === "object" && module.exports) {',"    module.exports = factory("+c+");"),d.exportVar&&l.push("  } else {","    root."+d.exportVar+" = factory();"),l.push("  }","})(this, function("+u+") {",'  "use strict";',"",t,"",_("return "+a()+";"),"});"),l}},u=i[d.format||"bare"]();return new c(null,null,d.grammarSource,u.map((function(e){return e instanceof c?e:e+"\n"})))}(function(){var n=[],p=o.topLevelInitializer;if(p)if(Array.isArray(p)){if("es"===d.format){for(var x=[],q=[],F=0,$=p;F<$.length;F++){var L=$[F],B=l(L.code,{startRule:"ImportsAndSource",grammarSource:new u(L.codeLocation.source,L.codeLocation.start)}),D=B[0],I=B[1];D.code?(x.push(D),q.push(I)):q.push(L)}p=q.concat(x)}for(var k=0,O=p.slice(0).reverse();k<O.length;k++)L=O[k],n.push(P(L)),n.push("")}else n.push(P(p)),n.push("");n.push("function peg$subclass(child, parent) {","  function C() { this.constructor = child; }","  C.prototype = parent.prototype;","  child.prototype = new C();","}","","function peg$SyntaxError(message, expected, found, location) {","  var self = Error.call(this, message);","  // istanbul ignore next Check is a necessary evil to support older environments","  if (Object.setPrototypeOf) {","    Object.setPrototypeOf(self, peg$SyntaxError.prototype);","  }","  self.expected = expected;","  self.found = found;","  self.location = location;",'  self.name = "SyntaxError";',"  return self;","}","","peg$subclass(peg$SyntaxError, Error);","","function peg$padEnd(str, targetLength, padString) {",'  padString = padString || " ";',"  if (str.length > targetLength) { return str; }","  targetLength -= str.length;","  padString += padString.repeat(targetLength);","  return str + padString.slice(0, targetLength);","}","","peg$SyntaxError.prototype.format = function(sources) {",'  var str = "Error: " + this.message;',"  if (this.location) {","    var src = null;","    var k;","    for (k = 0; k < sources.length; k++) {","      if (sources[k].source === this.location.source) {","        src = sources[k].text.split(/\\r\\n|\\n|\\r/g);","        break;","      }","    }","    var s = this.location.start;",'    var offset_s = (this.location.source && (typeof this.location.source.offset === "function"))',"      ? this.location.source.offset(s)","      : s;",'    var loc = this.location.source + ":" + offset_s.line + ":" + offset_s.column;',"    if (src) {","      var e = this.location.end;","      var filler = peg$padEnd(\"\", offset_s.line.toString().length, ' ');","      var line = src[s.line - 1];","      var last = s.line === e.line ? e.column : line.length + 1;","      var hatLen = (last - s.column) || 1;",'      str += "\\n --\x3e " + loc + "\\n"','          + filler + " |\\n"','          + offset_s.line + " | " + line + "\\n"','          + filler + " | " + peg$padEnd("", s.column - 1, \' \')','          + peg$padEnd("", hatLen, "^");',"    } else {",'      str += "\\n at " + loc;',"    }","  }","  return str;","};","","peg$SyntaxError.buildMessage = function(expected, found) {","  var DESCRIBE_EXPECTATION_FNS = {","    literal: function(expectation) {",'      return "\\"" + literalEscape(expectation.text) + "\\"";',"    },","","    class: function(expectation) {","      var escapedParts = expectation.parts.map(function(part) {","        return Array.isArray(part)",'          ? classEscape(part[0]) + "-" + classEscape(part[1])',"          : classEscape(part);","      });","",'      return "[" + (expectation.inverted ? "^" : "") + escapedParts.join("") + "]";',"    },","","    any: function() {",'      return "any character";',"    },","","    end: function() {",'      return "end of input";',"    },","","    other: function(expectation) {","      return expectation.description;","    }","  };","","  function hex(ch) {","    return ch.charCodeAt(0).toString(16).toUpperCase();","  }","","  function literalEscape(s) {","    return s",'      .replace(/\\\\/g, "\\\\\\\\")','      .replace(/"/g,  "\\\\\\"")','      .replace(/\\0/g, "\\\\0")','      .replace(/\\t/g, "\\\\t")','      .replace(/\\n/g, "\\\\n")','      .replace(/\\r/g, "\\\\r")','      .replace(/[\\x00-\\x0F]/g,          function(ch) { return "\\\\x0" + hex(ch); })','      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return "\\\\x"  + hex(ch); });',"  }","","  function classEscape(s) {","    return s",'      .replace(/\\\\/g, "\\\\\\\\")','      .replace(/\\]/g, "\\\\]")','      .replace(/\\^/g, "\\\\^")','      .replace(/-/g,  "\\\\-")','      .replace(/\\0/g, "\\\\0")','      .replace(/\\t/g, "\\\\t")','      .replace(/\\n/g, "\\\\n")','      .replace(/\\r/g, "\\\\r")','      .replace(/[\\x00-\\x0F]/g,          function(ch) { return "\\\\x0" + hex(ch); })','      .replace(/[\\x10-\\x1F\\x7F-\\x9F]/g, function(ch) { return "\\\\x"  + hex(ch); });',"  }","","  function describeExpectation(expectation) {","    return DESCRIBE_EXPECTATION_FNS[expectation.type](expectation);","  }","","  function describeExpected(expected) {","    var descriptions = expected.map(describeExpectation);","    var i, j;","","    descriptions.sort();","","    if (descriptions.length > 0) {","      for (i = 1, j = 1; i < descriptions.length; i++) {","        if (descriptions[i - 1] !== descriptions[i]) {","          descriptions[j] = descriptions[i];","          j++;","        }","      }","      descriptions.length = j;","    }","","    switch (descriptions.length) {","      case 1:","        return descriptions[0];","","      case 2:",'        return descriptions[0] + " or " + descriptions[1];',"","      default:",'        return descriptions.slice(0, -1).join(", ")','          + ", or "',"          + descriptions[descriptions.length - 1];","    }","  }","","  function describeFound(found) {",'    return found ? "\\"" + literalEscape(found) + "\\"" : "end of input";',"  }","",'  return "Expected " + describeExpected(expected) + " but " + describeFound(found) + " found.";',"};",""),d.trace&&n.push("function peg$DefaultTracer() {","  this.indentLevel = 0;","}","","peg$DefaultTracer.prototype.trace = function(event) {","  var that = this;","","  function log(event) {","    function repeat(string, n) {",'       var result = "", i;',"","       for (i = 0; i < n; i++) {","         result += string;","       }","","       return result;","    }","","    function pad(string, length) {",'      return string + repeat(" ", length - string.length);',"    }","",'    if (typeof console === "object") {',"      console.log(",'        event.location.start.line + ":" + event.location.start.column + "-"','          + event.location.end.line + ":" + event.location.end.column + " "','          + pad(event.type, 10) + " "','          + repeat("  ", that.indentLevel) + event.rule',"      );","    }","  }","","  switch (event.type) {",'    case "rule.enter":',"      log(event);","      this.indentLevel++;","      break;","",'    case "rule.match":',"      this.indentLevel--;","      log(event);","      break;","",'    case "rule.fail":',"      this.indentLevel--;","      log(event);","      break;","","    default:",'      throw new Error("Invalid event type: " + event.type + ".");',"  }","};","");var j="{ "+A.map((function(e){return e+": "+w(e)})).join(", ")+" }",M=w(A[0]);if(n.push("function peg$parse(input, options) {","  options = options !== undefined ? options : {};","","  var peg$FAILED = {};","  var peg$source = options.grammarSource;","","  var peg$startRuleFunctions = "+j+";","  var peg$startRuleFunction = "+M+";","",new c(null,null,d.grammarSource,e([m.map((function(e,t){return"  var "+S(t)+' = "'+s(e)+'";'})).concat("",g.map((function(e,t){return"  var "+E(t)+" = /^["+((r=e).inverted?"^":"")+r.value.map((function(e){return Array.isArray(e)?i(e[0])+"-"+i(e[1]):i(e)})).join("")+"]/"+(r.ignoreCase?"i":"")+";";var r}))).concat("",b.map((function(e,t){return"  var "+R(t)+" = "+function(e){switch(e.type){case"rule":return'peg$otherExpectation("'+s(e.value)+'")';case"literal":return'peg$literalExpectation("'+s(e.value)+'", '+e.ignoreCase+")";case"class":return"peg$classExpectation(["+e.value.map((function(e){return Array.isArray(e)?'["'+s(e[0])+'", "'+s(e[1])+'"]':'"'+s(e)+'"'})).join(", ")+"], "+e.inverted+", "+e.ignoreCase+")";case"any":return"peg$anyExpectation()";default:throw new Error("Unknown expectation type ("+JSON.stringify(e)+")")}}(e)+";"}))).concat("").join("\n")],v.map((function(e,t){return f("\n  var ".concat(C(t)," = function(").concat(e.params.join(", "),") {"),e.body,e.location,"};")})),!0)),"","  var peg$currPos = options.peg$currPos | 0;","  var peg$savedPos = peg$currPos;","  var peg$posDetailsCache = [{ line: 1, column: 1 }];","  var peg$maxFailPos = peg$currPos;","  var peg$maxFailExpected = options.peg$maxFailExpected || [];","  var peg$silentFails = options.peg$silentFails | 0;",""),d.cache&&n.push("  var peg$resultsCache = {};",""),d.trace&&n.push('  var peg$tracer = "tracer" in options ? options.tracer : new peg$DefaultTracer();',""),n.push("  var peg$result;","","  if (options.startRule) {","    if (!(options.startRule in peg$startRuleFunctions)) {",'      throw new Error("Can\'t start parsing from rule \\"" + options.startRule + "\\".");',"    }","","    peg$startRuleFunction = peg$startRuleFunctions[options.startRule];","  }","","  function text() {","    return input.substring(peg$savedPos, peg$currPos);","  }","","  function offset() {","    return peg$savedPos;","  }","","  function range() {","    return {","      source: peg$source,","      start: peg$savedPos,","      end: peg$currPos","    };","  }","","  function location() {","    return peg$computeLocation(peg$savedPos, peg$currPos);","  }","","  function expected(description, location) {","    location = location !== undefined","      ? location","      : peg$computeLocation(peg$savedPos, peg$currPos);","","    throw peg$buildStructuredError(","      [peg$otherExpectation(description)],","      input.substring(peg$savedPos, peg$currPos),","      location","    );","  }","","  function error(message, location) {","    location = location !== undefined","      ? location","      : peg$computeLocation(peg$savedPos, peg$currPos);","","    throw peg$buildSimpleError(message, location);","  }","","  function peg$literalExpectation(text, ignoreCase) {",'    return { type: "literal", text: text, ignoreCase: ignoreCase };',"  }","","  function peg$classExpectation(parts, inverted, ignoreCase) {",'    return { type: "class", parts: parts, inverted: inverted, ignoreCase: ignoreCase };',"  }","","  function peg$anyExpectation() {",'    return { type: "any" };',"  }","","  function peg$endExpectation() {",'    return { type: "end" };',"  }","","  function peg$otherExpectation(description) {",'    return { type: "other", description: description };',"  }","","  function peg$computePosDetails(pos) {","    var details = peg$posDetailsCache[pos];","    var p;","","    if (details) {","      return details;","    } else {","      if (pos >= peg$posDetailsCache.length) {","        p = peg$posDetailsCache.length - 1;","      } else {","        p = pos;","        while (!peg$posDetailsCache[--p]) {}","      }","","      details = peg$posDetailsCache[p];","      details = {","        line: details.line,","        column: details.column","      };","","      while (p < pos) {","        if (input.charCodeAt(p) === 10) {","          details.line++;","          details.column = 1;","        } else {","          details.column++;","        }","","        p++;","      }","","      peg$posDetailsCache[pos] = details;","","      return details;","    }","  }","","  function peg$computeLocation(startPos, endPos, offset) {","    var startPosDetails = peg$computePosDetails(startPos);","    var endPosDetails = peg$computePosDetails(endPos);","","    var res = {","      source: peg$source,","      start: {","        offset: startPos,","        line: startPosDetails.line,","        column: startPosDetails.column","      },","      end: {","        offset: endPos,","        line: endPosDetails.line,","        column: endPosDetails.column","      }","    };",'    if (offset && peg$source && (typeof peg$source.offset === "function")) {',"      res.start = peg$source.offset(res.start);","      res.end = peg$source.offset(res.end);","    }","    return res;","  }","","  function peg$fail(expected) {","    if (peg$currPos < peg$maxFailPos) { return; }","","    if (peg$currPos > peg$maxFailPos) {","      peg$maxFailPos = peg$currPos;","      peg$maxFailExpected = [];","    }","","    peg$maxFailExpected.push(expected);","  }","","  function peg$buildSimpleError(message, location) {","    return new peg$SyntaxError(message, null, null, location);","  }","","  function peg$buildStructuredError(expected, found, location) {","    return new peg$SyntaxError(","      peg$SyntaxError.buildMessage(expected, found),","      expected,","      found,","      location","    );","  }",""),o.imports.length>0&&n.push("  var peg$assign = Object.assign || function(t) {","    var i, s;","    for (i = 1; i < arguments.length; i++) {","      s = arguments[i];","      for (var p in s) {","        if (Object.prototype.hasOwnProperty.call(s, p)) {","          t[p] = s[p];","        }","      }","    }","    return t;","  };","","  function peg$callLibrary(lib, startRule) {","    const opts = peg$assign({}, options, {","      startRule: startRule,","      peg$currPos: peg$currPos,","      peg$silentFails: peg$silentFails,","      peg$library: true,","      peg$maxFailExpected: peg$maxFailExpected","    });","    const res = lib.parse(input, opts);","    peg$currPos = res.peg$currPos;","    peg$maxFailPos = res.peg$maxFailPos;","    peg$maxFailExpected = res.peg$maxFailExpected;","    return (res.peg$result === res.peg$FAILED) ? peg$FAILED : res.peg$result;","  }",""),o.rules.forEach((function(e){n.push.apply(n,_(function(e){var n=[],i=e.bytecode,c=new a(e.name,"s","var",i),u=function e(t){var a=0,n=t.length,s=[],i=void 0;function u(r,n,o){var i=n+3,u=t[a+i-2],l=t[a+i-1],p=c.checkedIf(a,(function(){return a+=i+u,(o||e)(t.slice(a-u,a))}),l>0?function(){return a+=l,e(t.slice(a-l,a))}:null),f=p[0],d=p[1];s.push("if ("+r+") {"),s.push.apply(s,_(f)),l>0&&(s.push("} else {"),s.push.apply(s,_(d))),s.push("}")}function l(n,o,i){var l=o+3,p=1===i?"input.charAt(peg$currPos)":"input.substr(peg$currPos, "+i+")",f=null;t[a+l]===r.ACCEPT_N&&t[a+l+1]===i&&(s.push(c.push(p)),p=c.pop(),f=function(t){c.sp++;var r=e(t.slice(2));return r.unshift(1===i?"peg$currPos++;":"peg$currPos += "+i+";"),r}),u(n(p,null!==f),o,f)}for(var p=function(){switch(t[a]){case r.PUSH_EMPTY_STRING:s.push(c.push("''")),a++;break;case r.PUSH_CURR_POS:s.push(c.push("peg$currPos")),a++;break;case r.PUSH_UNDEFINED:s.push(c.push("undefined")),a++;break;case r.PUSH_NULL:s.push(c.push("null")),a++;break;case r.PUSH_FAILED:s.push(c.push("peg$FAILED")),a++;break;case r.PUSH_EMPTY_ARRAY:s.push(c.push("[]")),a++;break;case r.POP:c.pop(),a++;break;case r.POP_CURR_POS:s.push("peg$currPos = "+c.pop()+";"),a++;break;case r.POP_N:c.pop(t[a+1]),a+=2;break;case r.NIP:i=c.pop(),c.pop(),s.push(c.push(i)),a++;break;case r.APPEND:i=c.pop(),s.push(c.top()+".push("+i+");"),a++;break;case r.WRAP:s.push(c.push("["+c.pop(t[a+1]).join(", ")+"]")),a+=2;break;case r.TEXT:s.push(c.push("input.substring("+c.pop()+", peg$currPos)")),a++;break;case r.PLUCK:var n=t[a+3-1],p=3+n;i=t.slice(a+3,a+p),i=1===n?c.index(i[0]):"[ ".concat(i.map((function(e){return c.index(e)})).join(", ")," ]"),c.pop(t[a+1]),s.push(c.push(i)),a+=p;break;case r.IF:u(c.top(),0);break;case r.IF_ERROR:u(c.top()+" === peg$FAILED",0);break;case r.IF_NOT_ERROR:u(c.top()+" !== peg$FAILED",0);break;case r.IF_LT:u(c.top()+".length < "+t[a+1],1);break;case r.IF_GE:u(c.top()+".length >= "+t[a+1],1);break;case r.IF_LT_DYNAMIC:u(c.top()+".length < ("+c.index(t[a+1])+"|0)",1);break;case r.IF_GE_DYNAMIC:u(c.top()+".length >= ("+c.index(t[a+1])+"|0)",1);break;case r.WHILE_NOT_ERROR:x=c.top()+" !== peg$FAILED",P=t[a+2-1],q=c.checkedLoop(a,(function(){return a+=2+P,e(t.slice(a-P,a))})),s.push("while ("+x+") {"),s.push.apply(s,_(q)),s.push("}");break;case r.MATCH_ANY:u("input.length > peg$currPos",0);break;case r.MATCH_STRING:var f=t[a+1],d=m[f];l((function(e,t){return d.length>1?"".concat(e," === ").concat(S(f)):(e=t?"".concat(e,".charCodeAt(0)"):"input.charCodeAt(peg$currPos)","".concat(e," === ").concat(d.charCodeAt(0)))}),1,d.length);break;case r.MATCH_STRING_IC:var g=t[a+1];l((function(e){return"".concat(e,".toLowerCase() === ").concat(S(g))}),1,m[g].length);break;case r.MATCH_CHAR_CLASS:var b=t[a+1];l((function(e){return"".concat(E(b),".test(").concat(e,")")}),1,1);break;case r.ACCEPT_N:s.push(c.push(t[a+1]>1?"input.substr(peg$currPos, "+t[a+1]+")":"input.charAt(peg$currPos)")),s.push(t[a+1]>1?"peg$currPos += "+t[a+1]+";":"peg$currPos++;"),a+=2;break;case r.ACCEPT_STRING:s.push(c.push(S(t[a+1]))),s.push(m[t[a+1]].length>1?"peg$currPos += "+m[t[a+1]].length+";":"peg$currPos++;"),a+=2;break;case r.FAIL:s.push(c.push("peg$FAILED")),s.push("if (peg$silentFails === 0) { peg$fail("+R(t[a+1])+"); }"),a+=2;break;case r.LOAD_SAVED_POS:s.push("peg$savedPos = "+c.index(t[a+1])+";"),a+=2;break;case r.UPDATE_SAVED_POS:s.push("peg$savedPos = peg$currPos;"),a++;break;case r.CALL:i=function(){var e=t[a+4-1];return C(t[a+1])+"("+t.slice(a+4,a+4+e).map((function(e){return c.index(e)})).join(", ")+")"}(),c.pop(t[a+2]),s.push(c.push(i)),a+=4+t[a+3];break;case r.RULE:s.push(c.push(w(o.rules[t[a+1]].name)+"()")),a+=2;break;case r.LIBRARY_RULE:var v=t[a+2],A=-1===v?"":', "'+y[v]+'"';s.push(c.push("peg$callLibrary("+T(t[a+1])+A+")")),a+=3;break;case r.SILENT_FAILS_ON:s.push("peg$silentFails++;"),a++;break;case r.SILENT_FAILS_OFF:s.push("peg$silentFails--;"),a++;break;case r.SOURCE_MAP_PUSH:c.sourceMapPush(s,h[t[a+1]]),a+=2;break;case r.SOURCE_MAP_POP:c.sourceMapPop(),a++;break;case r.SOURCE_MAP_LABEL_PUSH:c.labels[t[a+1]]={label:m[t[a+2]],location:h[t[a+3]]},a+=4;break;case r.SOURCE_MAP_LABEL_POP:delete c.labels[t[a+1]],a+=2;break;default:throw new Error("Invalid opcode: "+t[a]+".")}var x,P,q};a<n;)p();return s}(i);return n.push(f("function ",w(e.name),e.nameLocation,"() {\n",e.name)),d.trace&&n.push("  var startPos = peg$currPos;"),n.push(_(c.defines())),n.push.apply(n,_(function(e,t){var r=[];return r.push(""),d.trace&&r.push("peg$tracer.trace({",'  type: "rule.enter",',"  rule: "+e+",","  location: peg$computeLocation(startPos, startPos, true)","});",""),d.cache&&(r.push("var key = peg$currPos * "+o.rules.length+" + "+t+";","var cached = peg$resultsCache[key];","","if (cached) {","  peg$currPos = cached.nextPos;",""),d.trace&&r.push("if (cached.result !== peg$FAILED) {","  peg$tracer.trace({",'    type: "rule.match",',"    rule: "+e+",","    result: cached.result,","    location: peg$computeLocation(startPos, peg$currPos, true)","  });","} else {","  peg$tracer.trace({",'    type: "rule.fail",',"    rule: "+e+",","    location: peg$computeLocation(startPos, startPos, true)","  });","}",""),r.push("  return cached.result;","}","")),r}('"'+s(e.name)+'"',t.indexOfRule(o,e.name)))),n.push.apply(n,_(u)),n.push.apply(n,_(function(e,t){var r=[];return d.cache&&r.push("","peg$resultsCache[key] = { nextPos: peg$currPos, result: "+t+" };"),d.trace&&r.push("","if ("+t+" !== peg$FAILED) {","  peg$tracer.trace({",'    type: "rule.match",',"    rule: "+e+",","    result: "+t+",","    location: peg$computeLocation(startPos, peg$currPos, true)","  });","} else {","  peg$tracer.trace({",'    type: "rule.fail",',"    rule: "+e+",","    location: peg$computeLocation(startPos, startPos, true)","  });","}"),r.push("","return "+t+";"),r}('"'+s(e.name)+'"',c.result()))),n.push("}"),n}(e))),n.push("")})),o.initializer)if(Array.isArray(o.initializer))for(var N=0,U=o.initializer;N<U.length;N++){var G=U[N];n.push(P(G)),n.push("")}else n.push(P(o.initializer)),n.push("");return n.push("  peg$result = peg$startRuleFunction();","","  if (options.peg$library) {","    return /** @type {any} */ ({","      peg$result,","      peg$currPos,","      peg$FAILED,","      peg$maxFailExpected,","      peg$maxFailPos","    });","  }","  if (peg$result !== peg$FAILED && peg$currPos === input.length) {","    return peg$result;","  } else {","    if (peg$result !== peg$FAILED && peg$currPos < input.length) {","      peg$fail(peg$endExpectation());","    }","","    throw peg$buildStructuredError(","      peg$maxFailExpected,","      peg$maxFailPos < input.length ? input.charAt(peg$maxFailPos) : null,","      peg$maxFailPos < input.length","        ? peg$computeLocation(peg$maxFailPos, peg$maxFailPos + 1)","        : peg$computeLocation(peg$maxFailPos, peg$maxFailPos)","    );","  }","}"),new c(null,null,d.grammarSource,n.map((function(e){return e instanceof c?e:e+"\n"})))}())},generateJs}function requireRemoveProxyRules(){if(hasRequiredRemoveProxyRules)return removeProxyRules_1;hasRequiredRemoveProxyRules=1;var e=requireAsts(),t=requireVisitor();return removeProxyRules_1=function(r,a,n){var o=[];r.rules.forEach((function(s,i){var c;"rule"===(c=s).type&&"rule_ref"===c.expression.type&&(function(r,a,o){t.build({rule_ref:function(t){t.name===a&&(t.name=o,n.info('Proxy rule "'.concat(a,'" replaced by the rule "').concat(o,'"'),t.location,[{message:"This rule will be used",location:e.findRule(r,o).nameLocation}]))}})(r)}(r,s.name,s.expression.name),-1===a.allowedStartRules.indexOf(s.name)&&o.push(i))})),o.reverse(),o.forEach((function(e){r.rules.splice(e,1)}))},removeProxyRules_1}function requireMergeCharacterClasses(){if(hasRequiredMergeCharacterClasses)return mergeCharacterClasses_1;hasRequiredMergeCharacterClasses=1;var e=mergeCharacterClasses_1&&mergeCharacterClasses_1.__assign||function(){return e=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},e.apply(this,arguments)},t=mergeCharacterClasses_1&&mergeCharacterClasses_1.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},r=requireVisitor();function a(e,t){var r=e,a=t;Object.keys(r).forEach((function(e){return delete r[e]})),Object.keys(a).forEach((function(e){r[e]=a[e]}))}return mergeCharacterClasses_1=function(n){var o=Object.create(null);n.rules.forEach((function(e){return o[e.name]=e.expression}));var s=Object.create(null),i=[function(r,a){if("class"===r.type&&!r.inverted)return a&&((r=e({},r)).parts=t([],r.parts,!0)),r;if("literal"===r.type&&1===r.value.length)return{type:"class",parts:[r.value],inverted:!1,ignoreCase:r.ignoreCase,location:r.location};if("rule_ref"===r.type){var n=o[r.name];if(n){s[r.name]||(s[r.name]=!0,u(n));var i=c(n,!0);return i&&(i.location=r.location),i}}return null},r.build({choice:function(e){var t=null,r=!1;e.alternatives.forEach((function(a,n){var o;u(a);var s=c(a);s?t&&t.ignoreCase===s.ignoreCase?((o=t.parts).push.apply(o,s.parts),e.alternatives[n-1]=t,e.alternatives[n]=t,t.location={source:t.location.source,start:t.location.start,end:s.location.end},r=!0):t=s:t=null})),r&&(e.alternatives=e.alternatives.filter((function(e,t,r){return!t||e!==r[t-1]})),e.alternatives.forEach((function(t,r){"class"===t.type&&(t.parts=function(e){e.sort((function(e,t){var r=Array.isArray(e)?e:[e,e],a=r[0],n=r[1],o=Array.isArray(t)?t:[t,t],s=o[0],i=o[1];return a!==s?a<s?-1:1:n!==i?n>i?-1:1:0}));for(var t="",r="",a=0;a<e.length;a++){var n=e[a],o=Array.isArray(n)?n:[n,n],s=o[0],i=o[1];i<=r?e.splice(a--,1):r.charCodeAt(0)+1>=s.charCodeAt(0)?(e.splice(a--,1),e[a]=[t,r=i]):(t=s,r=i)}return e}(t.parts),1!==t.parts.length||Array.isArray(t.parts[0])||t.inverted||(e.alternatives[r]={type:"literal",value:t.parts[0],ignoreCase:t.ignoreCase,location:t.location}))})),1===e.alternatives.length&&a(e,e.alternatives[0]))},text:function(e){if(u(e.expression),"class"===e.expression.type||"literal"===e.expression.type){var t=e.location;a(e,e.expression),e.location=t}}})],c=i[0],u=i[1];n.rules.forEach((function(e){s[e.name]=!0,u(e.expression)}))}}function requireReportDuplicateImports(){return hasRequiredReportDuplicateImports||(hasRequiredReportDuplicateImports=1,reportDuplicateImports_1=function(e,t,r){for(var a={},n=0,o=e.imports;n<o.length;n++)for(var s=0,i=o[n].what;s<i.length;s++){var c=i[s];"import_binding_all"===c.type&&(Object.prototype.hasOwnProperty.call(a,c.binding)&&r.error('Module "'.concat(c.binding,'" is already imported'),c.location,[{message:"Original module location",location:a[c.binding]}]),a[c.binding]=c.location)}}),reportDuplicateImports_1}function requireReportDuplicateLabels(){if(hasRequiredReportDuplicateLabels)return reportDuplicateLabels_1;hasRequiredReportDuplicateLabels=1;var e=requireVisitor();return reportDuplicateLabels_1=function(t,r,a){function n(e){var t={};return Object.keys(e).forEach((function(r){t[r]=e[r]})),t}function o(e,t){s(e.expression,n(t))}var s=e.build({rule:function(e){s(e.expression,{})},choice:function(e,t){e.alternatives.forEach((function(e){s(e,n(t))}))},action:o,labeled:function(e,t){var r=e.label;r&&Object.prototype.hasOwnProperty.call(t,r)&&a.error('Label "'.concat(e.label,'" is already defined'),e.labelLocation,[{message:"Original label location",location:t[r]}]),s(e.expression,t),t[e.label]=e.labelLocation},text:o,simple_and:o,simple_not:o,optional:o,zero_or_more:o,one_or_more:o,repeated:function(e,t){e.delimiter&&s(e.delimiter,n(t)),s(e.expression,n(t))},group:o});s(t)},reportDuplicateLabels_1}function requireReportDuplicateRules(){if(hasRequiredReportDuplicateRules)return reportDuplicateRules_1;hasRequiredReportDuplicateRules=1;var e=requireVisitor();return reportDuplicateRules_1=function(t,r,a){var n={};e.build({rule:function(e){Object.prototype.hasOwnProperty.call(n,e.name)?a.error('Rule "'.concat(e.name,'" is already defined'),e.nameLocation,[{message:"Original rule location",location:n[e.name]}]):n[e.name]=e.nameLocation}})(t)},reportDuplicateRules_1}function requireReportInfiniteRecursion(){if(hasRequiredReportInfiniteRecursion)return reportInfiniteRecursion_1;hasRequiredReportInfiniteRecursion=1;var e=requireAsts(),t=requireVisitor();return reportInfiniteRecursion_1=function(r,a,n){var o=[],s=[],i=t.build({rule:function(e){n.errors>0||(o.push(e.name),i(e.expression),o.pop())},sequence:function(t){n.errors>0||t.elements.every((function(t){return i(t),!(n.errors>0||e.alwaysConsumesOnSuccess(r,t))}))},repeated:function(t){n.errors>0||(i(t.expression),t.delimiter&&!e.alwaysConsumesOnSuccess(r,t.expression)&&i(t.delimiter))},rule_ref:function(t){if(!(n.errors>0)){s.push(t);var a=e.findRule(r,t.name);if(-1!==o.indexOf(t.name))return o.push(t.name),void n.error("Possible infinite loop when parsing (left recursion: "+o.join(" -> ")+")",a.nameLocation,s.map((function(e,t,r){return{message:t+1!==r.length?"Step ".concat(t+1,': call of the rule "').concat(e.name,'" without input consumption'):"Step ".concat(t+1,": call itself without input consumption - left recursion"),location:e.location}})));a&&i(a),s.pop()}}});i(r)},reportInfiniteRecursion_1}function requireReportInfiniteRepetition(){if(hasRequiredReportInfiniteRepetition)return reportInfiniteRepetition_1;hasRequiredReportInfiniteRepetition=1;var e=requireAsts(),t=requireVisitor();return reportInfiniteRepetition_1=function(r,a,n){var o=t.build({zero_or_more:function(t){e.alwaysConsumesOnSuccess(r,t.expression)||n.error("Possible infinite loop when parsing (repetition used with an expression that may not consume any input)",t.location)},one_or_more:function(t){e.alwaysConsumesOnSuccess(r,t.expression)||n.error("Possible infinite loop when parsing (repetition used with an expression that may not consume any input)",t.location)},repeated:function(t){if(t.delimiter&&o(t.delimiter),!(e.alwaysConsumesOnSuccess(r,t.expression)||t.delimiter&&e.alwaysConsumesOnSuccess(r,t.delimiter)))if(null===t.max.value)n.error("Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",t.location);else{var a=t.min?t.min:t.max;n.warning("constant"===a.type&&"constant"===t.max.type?"An expression may not consume any input and may always match ".concat(t.max.value," times"):"An expression may not consume any input and may always match with a maximum repetition count",t.location)}}});o(r)},reportInfiniteRepetition_1}function requireReportUndefinedRules(){if(hasRequiredReportUndefinedRules)return reportUndefinedRules_1;hasRequiredReportUndefinedRules=1;var e=requireAsts(),t=requireVisitor();return reportUndefinedRules_1=function(r,a,n){t.build({rule_ref:function(t){e.findRule(r,t.name)||n.error('Rule "'.concat(t.name,'" is not defined'),t.location)}})(r)},reportUndefinedRules_1}function requireReportIncorrectPlucking(){if(hasRequiredReportIncorrectPlucking)return reportIncorrectPlucking_1;hasRequiredReportIncorrectPlucking=1;var e=requireVisitor();return reportIncorrectPlucking_1=function(t,r,a){var n=e.build({action:function(e){n(e.expression,e)},labeled:function(e,t){e.pick&&t&&a.error('"@" cannot be used with an action block',e.labelLocation,[{message:"Action block location",location:t.codeLocation}]),n(e.expression)}});n(t)},reportIncorrectPlucking_1}function requireSession(){if(hasRequiredSession)return session;hasRequiredSession=1;var e=session&&session.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},t=requireGrammarError(),r=function(){function e(e){"function"==typeof(e=void 0!==e?e:{}).error&&(this.error=e.error),"function"==typeof e.warning&&(this.warning=e.warning),"function"==typeof e.info&&(this.info=e.info)}return e.prototype.error=function(){},e.prototype.warning=function(){},e.prototype.info=function(){},e}(),a=function(){function a(e){this._callbacks=new r(e),this._firstError=null,this.errors=0,this.problems=[],this.stage=null}return a.prototype.error=function(){for(var r,a=[],n=0;n<arguments.length;n++)a[n]=arguments[n];++this.errors,null===this._firstError&&(this._firstError=new(t.bind.apply(t,e([void 0],a,!1))),this._firstError.stage=this.stage,this._firstError.problems=this.problems),this.problems.push(e(["error"],a,!0)),(r=this._callbacks).error.apply(r,e([this.stage],a,!1))},a.prototype.warning=function(){for(var t,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];this.problems.push(e(["warning"],r,!0)),(t=this._callbacks).warning.apply(t,e([this.stage],r,!1))},a.prototype.info=function(){for(var t,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];this.problems.push(e(["info"],r,!0)),(t=this._callbacks).info.apply(t,e([this.stage],r,!1))},a.prototype.checkErrors=function(){if(0!==this.errors)throw this._firstError},a}();return session=a}function requireCompiler(){if(hasRequiredCompiler)return compiler_1;hasRequiredCompiler=1;var addImportedRules=requireAddImportedRules(),fixLibraryNumbers=requireFixLibraryNumbers(),generateBytecode=requireGenerateBytecode(),generateJS=requireGenerateJs(),inferenceMatchResult=requireInferenceMatchResult(),removeProxyRules=requireRemoveProxyRules(),mergeCharacterClasses=requireMergeCharacterClasses(),reportDuplicateImports=requireReportDuplicateImports(),reportDuplicateLabels=requireReportDuplicateLabels(),reportDuplicateRules=requireReportDuplicateRules(),reportInfiniteRecursion=requireReportInfiniteRecursion(),reportInfiniteRepetition=requireReportInfiniteRepetition(),reportUndefinedRules=requireReportUndefinedRules(),reportIncorrectPlucking=requireReportIncorrectPlucking(),Session=requireSession(),visitor=requireVisitor(),base64=requireUtils$1().base64;function processOptions(e,t){var r={};return Object.keys(e).forEach((function(t){r[t]=e[t]})),Object.keys(t).forEach((function(e){Object.prototype.hasOwnProperty.call(r,e)||(r[e]=t[e])})),r}function isSourceMapCapable(e){return"string"==typeof e?e.length>0:e&&"function"==typeof e.offset}var compiler={visitor:visitor,passes:{prepare:[addImportedRules,reportInfiniteRecursion],check:[reportUndefinedRules,reportDuplicateRules,reportDuplicateLabels,reportInfiniteRepetition,reportIncorrectPlucking,reportDuplicateImports],transform:[fixLibraryNumbers,removeProxyRules,mergeCharacterClasses,inferenceMatchResult],generate:[generateBytecode,generateJS]},compile:function(ast,passes,options){options=void 0!==options?options:{};var defaultStartRules=[ast.rules[0].name];if(options=processOptions(options,{allowedStartRules:defaultStartRules,cache:!1,dependencies:{},exportVar:null,format:"bare",output:"parser",trace:!1}),null!==options.allowedStartRules&&void 0!==options.allowedStartRules||(options.allowedStartRules=defaultStartRules),!Array.isArray(options.allowedStartRules))throw new Error("allowedStartRules must be an array");0===options.allowedStartRules.length&&(options.allowedStartRules=defaultStartRules);var allRules=ast.rules.map((function(e){return e.name}));if(options.allowedStartRules.some((function(e){return"*"===e})))options.allowedStartRules=allRules;else for(var _i=0,_a=options.allowedStartRules;_i<_a.length;_i++){var rule=_a[_i];if(-1===allRules.indexOf(rule))throw new Error('Unknown start rule "'.concat(rule,'"'))}if(("source-and-map"===options.output||"source-with-inline-map"===options.output)&&!isSourceMapCapable(options.grammarSource))throw new Error("Must provide grammarSource (as a string or GrammarLocation) in order to generate source maps");var session=new Session(options);switch(Object.keys(passes).forEach((function(e){session.stage=e,session.info("Process stage ".concat(e)),passes[e].forEach((function(t){session.info("Process pass ".concat(e,".").concat(t.name)),t(ast,options,session)})),session.checkErrors()})),options.output){case"parser":return eval(ast.code.toString());case"source":return ast.code.toString();case"source-and-map":return ast.code;case"source-with-inline-map":if("undefined"==typeof TextEncoder)throw new Error("TextEncoder is not supported by this platform");var sourceMap=ast.code.toStringWithSourceMap(),encoder=new TextEncoder,b64=base64(encoder.encode(JSON.stringify(sourceMap.map.toJSON())));return sourceMap.code+"//# sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(b64,"\n");case"ast":return ast;default:throw new Error("Invalid output format: "+options.output+".")}}};return compiler_1=compiler,compiler_1}function requirePeg(){if(hasRequiredPeg)return peg_1;hasRequiredPeg=1;var e=requireGrammarError(),t=requireGrammarLocation(),r=requireAsts(),a=requireCompiler(),n=requireParser(),o={VERSION:requireVersion().version,RESERVED_WORDS:["break","case","catch","class","const","continue","debugger","default","delete","do","else","export","extends","finally","for","function","if","import","in","instanceof","new","return","super","switch","this","throw","try","typeof","var","void","while","with","null","true","false","enum","implements","interface","let","package","private","protected","public","static","yield","await","arguments","eval"],GrammarError:e,GrammarLocation:t,parser:n,compiler:a,generate:function(e,t){var a,n,s="plugins"in(t=void 0!==t?t:{})?t.plugins:[],i={parser:o.parser,passes:(a=o.compiler.passes,n={},Object.keys(a).forEach((function(e){n[e]=a[e].slice()})),n),reservedWords:o.RESERVED_WORDS.slice()};s.forEach((function(e){e.use(i,t)})),Array.isArray(e)||(e=[{source:t.grammarSource,text:e}]);var c=r.combine(e.map((function(e){var t=e.source,r=e.text;return i.parser.parse(r,{grammarSource:t,reservedWords:i.reservedWords})})));return o.compiler.compile(c,i.passes,t)}};return peg_1=o}var utils={},hasRequiredUtils,hasRequiredGeneratedParserApi_spec;function requireUtils(){if(hasRequiredUtils)return utils;hasRequiredUtils=1;var e=require$$0,t=function(){function t(e){this.args=e}return t.prototype.calledWithExactly=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return e.util.eql(this.args,t)},t}();function r(){function e(){for(var r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];e.callCount++,e.called=!0,e.calls.push(new t(r))}return e.called=!1,e.callCount=0,e.calls=[],e.getCall=function(t){return e.calls[t]},e}return utils.spy=function(){return r()},utils.stub=function(e,t){var a=e[t],n=r();return e[t]=n,n.restore=function(){e[t]=a},a},utils}function requireGeneratedParserApi_spec(){if(hasRequiredGeneratedParserApi_spec)return generatedParserApi_spec;hasRequiredGeneratedParserApi_spec=1;var e=require$$0,t=requirePeg(),r=requireUtils(),a=r.spy,n=r.stub,o=e.expect;return describe("generated parser API",(function(){describe("parse",(function(){it("parses input",(function(){var e=t.generate("start = 'a'");o(e.parse("a")).to.equal("a")})),it("throws an exception on syntax error",(function(){var e=t.generate("start = 'a'");o((function(){e.parse("b")})).to.throw()})),it("correctly describe character class in syntax error",(function(){var e=t.generate("start = [123-5]");o((function(){e.parse("0")})).to.throw("[123-5]")})),describe("start rule",(function(){var e=t.generate(["a = 'x' { return 'a'; }","b = 'x' { return 'b'; }","c = 'x' { return 'c'; }"].join("\n"),{allowedStartRules:["b","c"]});describe("when |startRule| is not set",(function(){it("starts parsing from the first allowed rule",(function(){o(e.parse("x")).to.equal("b")}))})),describe("when |startRule| is set to an allowed rule",(function(){it("starts parsing from specified rule",(function(){o(e.parse("x",{startRule:"b"})).to.equal("b"),o(e.parse("x",{startRule:"c"})).to.equal("c")}))})),describe("when |startRule| is set to a disallowed start rule",(function(){it("throws an exception",(function(){o((function(){e.parse("x",{startRule:"a"})})).to.throw()}))}))})),describe("tracing",(function(){var e=t.generate(["start = a / b","a = 'a'i","b = 'b'"].join("\n"),{trace:!0});describe("default tracer",(function(){it("traces using console.log (if console is defined)",(function(){var t=["1:1-1:1 rule.enter start","1:1-1:1 rule.enter   a","1:1-1:1 rule.fail    a","1:1-1:1 rule.enter   b","1:1-1:2 rule.match   b","1:1-1:2 rule.match start"];"object"==typeof console&&n(console,"log");try{e.parse("b"),"object"==typeof console&&(o(console.log.callCount).to.equal(t.length),t.forEach((function(e,t){var r=console.log.getCall(t);o(r.calledWithExactly(e)).to.equal(!0)})))}finally{"object"==typeof console&&console.log.restore()}}))})),describe("custom tracers",(function(){describe("trace",(function(){it("receives tracing events",(function(){var t=[{type:"rule.enter",rule:"start",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:0,line:1,column:1}}},{type:"rule.enter",rule:"a",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:0,line:1,column:1}}},{type:"rule.fail",rule:"a",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:0,line:1,column:1}}},{type:"rule.enter",rule:"b",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:0,line:1,column:1}}},{type:"rule.match",rule:"b",result:"b",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:1,line:1,column:2}}},{type:"rule.match",rule:"start",result:"b",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:1,line:1,column:2}}}],r={trace:a()};e.parse("b",{tracer:r}),o(r.trace.callCount).to.equal(t.length),t.forEach((function(e,t){var a=r.trace.getCall(t);o(a.calledWithExactly(e)).to.equal(!0)}))}))}))}))})),it("accepts custom options",(function(){t.generate("start = 'a'").parse("a",{foo:42})}))}))})),generatedParserApi_spec}requireGeneratedParserApi_spec();var pegjsApi_spec={},name="peggy",version="4.1.1",description="Parser generator for JavaScript",keywords=["grammar","parser generator","PEG","PEG.js"],homepage="https://peggyjs.org/",repository={type:"git",url:"git+https://github.com/peggyjs/peggy.git"},bugs="https://github.com/peggyjs/peggy/issues",license="MIT",author="David Majda <david@majda.cz> (https://majda.cz/)",main="lib/peg.js",browser="browser/peggy.min.js",unpkg="browser/peggy.min.js",jsdelivr="browser/peggy.min.js",types="lib/peg.d.ts",bin={peggy:"bin/peggy.js"},scripts={clean:"rimraf -g build browser bin/*.map && mkdir browser",parser:"node bin/peggy.js -c src/opts.mjs",examples:"node bin/peggy.js -c docs/js/options.js docs/js/examples.peggy",set_version:"package-extract -o lib/version.js -dcs && package-extract -u -o docs/index.html -r '(?<=https:\\/\\/unpkg.com\\/peggy@)(?<version>\\d+\\.\\d+\\.\\d+)(?=\\/browser\\/peggy\\.min\\.js)'",lint:"eslint .",ts:"tsc --build tsconfig.json",docs:"cd docs && npm run build",test:"node --experimental-vm-modules node_modules/jest/bin/jest.js","test:web":"cd web-test && npm test","test:all":"npm run test && npm run test:web",benchmark:"node ./benchmark/run_bench.js",rollup:"copyfiles package.json build/ts && rollup -c",terser:"npm run terser:peggy && npm run terser:tests && npm run terser:bench","terser:peggy":"terser -c passes=2 -m reserved=['GrammarLocation'] --sequences 40 build/rollup/peggy.umd.js -o build/peggy.min.js","terser:tests":"terser -c passes=2 -m --sequences 40 --module build/rollup/test.umd.js -o build/test-bundle.min.js","terser:bench":"terser -c passes=2 -m --sequences 40 --module build/rollup/benchmark.umd.js -o build/benchmark-bundle.min.js",headers:"node ./tools/header.js build/peggy.min.js build/benchmark-bundle.min.js build/test-bundle.min.js",deploy:"npm run deploy:peggy && npm run deploy:tests && npm run deploy:bench",coverage:"npm run rollup && npm run parser -- -m inline && npm test","deploy:peggy":"copyfiles -f build/peggy.min.js docs/vendor/peggy/ && copyfiles -f build/peggy.min.js browser/","deploy:tests":"copyfiles -f build/test-bundle.min.js docs/js/","deploy:bench":"copyfiles -f build/benchmark-bundle.min.js docs/js/",build:"npm run build:notidy && npm run tidy","build:notidy":"npm run clean && npm run make && npm run lint && npm run audit",make:"npm run parser && npm run ts && npm run rollup && npm run terser && npm run examples && npm run docs && npm run headers && npm run deploy",audit:"npm run test && npm run benchmark",tidy:"rimraf build",start:"cd docs && npm start",version:"npm run set_version && npm run parser && npm run parser && npm run test && npm run examples && git add lib/version.js lib/parser.js docs/index.html test/cli/fixtures/imports_peggy.js test/cli/fixtures/lib.js docs/js/examples.js"},devDependencies={"@peggyjs/eslint-config":"^4.0.4","@rollup/plugin-commonjs":"^28.0.0","@rollup/plugin-json":"^6.1.0","@rollup/plugin-multi-entry":"^6.0.1","@rollup/plugin-node-resolve":"^15.3.0","@rollup/plugin-typescript":"^12.1.0","@types/chai":"^4.3.11","@types/jest":"^29.5.13","@types/node":"^22.7.4",chai:"^4.3.11","chai-like":"^1.1.3",copyfiles:"^2.4.1",eslint:"^9.11.1","eslint-plugin-compat":"6.0.1","eslint-plugin-mocha":"10.5.0",express:"4.21.0",glob:"^11.0.0",jest:"^29.7.0","package-extract":"2.3.0",rimraf:"^5.0.10",rollup:"^4.24.0","rollup-plugin-ignore":"1.0.10","source-map":"^0.8.0-beta.0",terser:"^5.34.1","ts-jest":"^29.2.5",tslib:"^2.7.0",typescript:"5.5.4","typescript-eslint":"8.8.0"},dependencies={"@peggyjs/from-mem":"1.3.4",commander:"^12.1.0","source-map-generator":"0.8.0"},pnpm={overrides:{picomatch:"^4.0.2"}},browserslist=["defaults, maintained node versions, not op_mini all"],packageManager="pnpm@9.12.0",engines={node:">=18"},require$$2={name:name,version:version,description:description,keywords:keywords,homepage:homepage,repository:repository,bugs:bugs,license:license,author:author,main:main,browser:browser,unpkg:unpkg,jsdelivr:jsdelivr,types:types,bin:bin,scripts:scripts,devDependencies:devDependencies,dependencies:dependencies,pnpm:pnpm,browserslist:browserslist,packageManager:packageManager,engines:engines},sourceMap={},sourceMapGenerator={},base64Vlq={},base64={},hasRequiredBase64,hasRequiredBase64Vlq;function requireBase64(){if(hasRequiredBase64)return base64;hasRequiredBase64=1;const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");return base64.encode=function(t){if(0<=t&&t<e.length)return e[t];throw new TypeError("Must be between 0 and 63: "+t)},base64}function requireBase64Vlq(){if(hasRequiredBase64Vlq)return base64Vlq;hasRequiredBase64Vlq=1;const e=requireBase64();return base64Vlq.encode=function(t){let r,a="",n=function(e){return e<0?1+(-e<<1):0+(e<<1)}(t);do{r=31&n,n>>>=5,n>0&&(r|=32),a+=e.encode(r)}while(n>0);return a},base64Vlq}var util={},urlBrowser,hasRequiredUrlBrowser,hasRequiredUtil;function requireUrlBrowser(){return hasRequiredUrlBrowser?urlBrowser:(hasRequiredUrlBrowser=1,urlBrowser=require$$0$1.URL)}function requireUtil(){if(hasRequiredUtil)return util;hasRequiredUtil=1;const e=requireUrlBrowser();util.getArg=function(e,t,r){if(t in e)return e[t];if(3===arguments.length)return r;throw new Error('"'+t+'" is a required argument.')};const t=!("__proto__"in Object.create(null));function r(e){return e}function a(e){if(!e)return!1;const t=e.length;if(t<9)return!1;if(95!==e.charCodeAt(t-1)||95!==e.charCodeAt(t-2)||111!==e.charCodeAt(t-3)||116!==e.charCodeAt(t-4)||111!==e.charCodeAt(t-5)||114!==e.charCodeAt(t-6)||112!==e.charCodeAt(t-7)||95!==e.charCodeAt(t-8)||95!==e.charCodeAt(t-9))return!1;for(let r=t-10;r>=0;r--)if(36!==e.charCodeAt(r))return!1;return!0}function n(e,t){return e===t?0:null===e?1:null===t?-1:e>t?1:-1}util.toSetString=t?r:function(e){return a(e)?"$"+e:e},util.fromSetString=t?r:function(e){return a(e)?e.slice(1):e},util.compareByGeneratedPositionsInflated=function(e,t){let r=e.generatedLine-t.generatedLine;return 0!==r?r:(r=e.generatedColumn-t.generatedColumn,0!==r?r:(r=n(e.source,t.source),0!==r?r:(r=e.originalLine-t.originalLine,0!==r?r:(r=e.originalColumn-t.originalColumn,0!==r?r:n(e.name,t.name)))))},util.parseSourceMapInput=function(e){return JSON.parse(e.replace(/^\)]}'[^\n]*\n/,""))};const o="http://host";function s(t){return r=>{const a=l(r),n=c(r),o=new e(r,n);t(o);const s=o.toString();return"absolute"===a?s:"scheme-relative"===a?s.slice(5):"path-absolute"===a?s.slice(11):p(n,s)}}function i(t,r){return new e(t,r).toString()}function c(e){const t=e.split("..").length-1,r=function(e,t){let r=0;for(;;){const e="p"+r++;if(-1===t.indexOf(e))return e}}(0,e);let a=`${o}/`;for(let e=0;e<t;e++)a+=`${r}/`;return a}const u=/^[A-Za-z0-9\+\-\.]+:/;function l(e){return"/"===e[0]?"/"===e[1]?"scheme-relative":"path-absolute":u.test(e)?"absolute":"path-relative"}function p(t,r){"string"==typeof t&&(t=new e(t)),"string"==typeof r&&(r=new e(r));const a=r.pathname.split("/"),n=t.pathname.split("/");for(n.length>0&&!n[n.length-1]&&n.pop();a.length>0&&n.length>0&&a[0]===n[0];)a.shift(),n.shift();return n.map((()=>"..")).concat(a).join("/")+r.search+r.hash}const f=s((e=>{e.pathname=e.pathname.replace(/\/?$/,"/")})),d=s((t=>{t.href=new e(".",t.toString()).toString()})),m=s((e=>{}));function h(e,t){const r=l(t),a=l(e);if(e=f(e),"absolute"===r)return i(t,void 0);if("absolute"===a)return i(t,e);if("scheme-relative"===r)return m(t);if("scheme-relative"===a)return i(t,i(e,o)).slice(5);if("path-absolute"===r)return m(t);if("path-absolute"===a)return i(t,i(e,o)).slice(11);const n=c(t+e);return p(n,i(t,i(e,n)))}return util.normalize=m,util.join=h,util.relative=function(t,r){const a=function(t,r){if(l(t)!==l(r))return null;const a=c(t+r),n=new e(t,a),o=new e(r,a);try{new e("",o.toString())}catch(e){return null}return o.protocol!==n.protocol||o.user!==n.user||o.password!==n.password||o.hostname!==n.hostname||o.port!==n.port?null:p(n,o)}(t,r);return"string"==typeof a?a:m(r)},util.computeSourceURL=function(e,t,r){e&&"path-absolute"===l(t)&&(t=t.replace(/^\//,""));let a=m(t||"");return e&&(a=h(e,a)),r&&(a=h(d(r),a)),a},util}var arraySet={},hasRequiredArraySet;function requireArraySet(){if(hasRequiredArraySet)return arraySet;hasRequiredArraySet=1;class e{constructor(){this._array=[],this._set=new Map}static fromArray(t,r){const a=new e;for(let e=0,n=t.length;e<n;e++)a.add(t[e],r);return a}size(){return this._set.size}add(e,t){const r=this.has(e),a=this._array.length;r&&!t||this._array.push(e),r||this._set.set(e,a)}has(e){return this._set.has(e)}indexOf(e){const t=this._set.get(e);if(t>=0)return t;throw new Error('"'+e+'" is not in the set.')}at(e){if(e>=0&&e<this._array.length)return this._array[e];throw new Error("No element indexed by "+e)}toArray(){return this._array.slice()}}return arraySet.ArraySet=e,arraySet}var mappingList={},hasRequiredMappingList,hasRequiredSourceMapGenerator;function requireMappingList(){if(hasRequiredMappingList)return mappingList;hasRequiredMappingList=1;const e=requireUtil();return mappingList.MappingList=class{constructor(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}unsortedForEach(e,t){this._array.forEach(e,t)}add(t){!function(t,r){const a=t.generatedLine,n=r.generatedLine,o=t.generatedColumn,s=r.generatedColumn;return n>a||n==a&&s>=o||e.compareByGeneratedPositionsInflated(t,r)<=0}(this._last,t)?(this._sorted=!1,this._array.push(t)):(this._last=t,this._array.push(t))}toArray(){return this._sorted||(this._array.sort(e.compareByGeneratedPositionsInflated),this._sorted=!0),this._array}},mappingList}function requireSourceMapGenerator(){if(hasRequiredSourceMapGenerator)return sourceMapGenerator;hasRequiredSourceMapGenerator=1;const e=requireBase64Vlq(),t=requireUtil(),r=requireArraySet().ArraySet,a=requireMappingList().MappingList;class n{constructor(e){e||(e={}),this._file=t.getArg(e,"file",null),this._sourceRoot=t.getArg(e,"sourceRoot",null),this._skipValidation=t.getArg(e,"skipValidation",!1),this._sources=new r,this._names=new r,this._mappings=new a,this._sourcesContents=null}static fromSourceMap(e){const r=e.sourceRoot,a=new n({file:e.file,sourceRoot:r});return e.eachMapping((function(e){const n={generated:{line:e.generatedLine,column:e.generatedColumn}};null!=e.source&&(n.source=e.source,null!=r&&(n.source=t.relative(r,n.source)),n.original={line:e.originalLine,column:e.originalColumn},null!=e.name&&(n.name=e.name)),a.addMapping(n)})),e.sources.forEach((function(n){let o=n;null!==r&&(o=t.relative(r,n)),a._sources.has(o)||a._sources.add(o);const s=e.sourceContentFor(n);null!=s&&a.setSourceContent(n,s)})),a}addMapping(e){const r=t.getArg(e,"generated"),a=t.getArg(e,"original",null);let n=t.getArg(e,"source",null),o=t.getArg(e,"name",null);this._skipValidation||this._validateMapping(r,a,n,o),null!=n&&(n=String(n),this._sources.has(n)||this._sources.add(n)),null!=o&&(o=String(o),this._names.has(o)||this._names.add(o)),this._mappings.add({generatedLine:r.line,generatedColumn:r.column,originalLine:null!=a&&a.line,originalColumn:null!=a&&a.column,source:n,name:o})}setSourceContent(e,r){let a=e;null!=this._sourceRoot&&(a=t.relative(this._sourceRoot,a)),null!=r?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[t.toSetString(a)]=r):this._sourcesContents&&(delete this._sourcesContents[t.toSetString(a)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))}applySourceMap(e,a,n){let o=a;if(null==a){if(null==e.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');o=e.file}const s=this._sourceRoot;null!=s&&(o=t.relative(s,o));const i=this._mappings.toArray().length>0?new r:this._sources,c=new r;this._mappings.unsortedForEach((function(r){if(r.source===o&&null!=r.originalLine){const a=e.originalPositionFor({line:r.originalLine,column:r.originalColumn});null!=a.source&&(r.source=a.source,null!=n&&(r.source=t.join(n,r.source)),null!=s&&(r.source=t.relative(s,r.source)),r.originalLine=a.line,r.originalColumn=a.column,null!=a.name&&(r.name=a.name))}const a=r.source;null==a||i.has(a)||i.add(a);const u=r.name;null==u||c.has(u)||c.add(u)}),this),this._sources=i,this._names=c,e.sources.forEach((function(r){const a=e.sourceContentFor(r);null!=a&&(null!=n&&(r=t.join(n,r)),null!=s&&(r=t.relative(s,r)),this.setSourceContent(r,a))}),this)}_validateMapping(e,t,r,a){if(t&&"number"!=typeof t.line&&"number"!=typeof t.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if(e&&"line"in e&&"column"in e&&e.line>0&&e.column>=0&&!t&&!r&&!a);else if(!(e&&"line"in e&&"column"in e&&t&&"line"in t&&"column"in t&&e.line>0&&e.column>=0&&t.line>0&&t.column>=0&&r))throw new Error("Invalid mapping: "+JSON.stringify({generated:e,source:r,original:t,name:a}))}_serializeMappings(){let r,a,n,o,s=0,i=1,c=0,u=0,l=0,p=0,f="";const d=this._mappings.toArray();for(let m=0,h=d.length;m<h;m++){if(a=d[m],r="",a.generatedLine!==i)for(s=0;a.generatedLine!==i;)r+=";",i++;else if(m>0){if(!t.compareByGeneratedPositionsInflated(a,d[m-1]))continue;r+=","}r+=e.encode(a.generatedColumn-s),s=a.generatedColumn,null!=a.source&&(o=this._sources.indexOf(a.source),r+=e.encode(o-p),p=o,r+=e.encode(a.originalLine-1-u),u=a.originalLine-1,r+=e.encode(a.originalColumn-c),c=a.originalColumn,null!=a.name&&(n=this._names.indexOf(a.name),r+=e.encode(n-l),l=n)),f+=r}return f}_generateSourcesContent(e,r){return e.map((function(e){if(!this._sourcesContents)return null;null!=r&&(e=t.relative(r,e));const a=t.toSetString(e);return Object.prototype.hasOwnProperty.call(this._sourcesContents,a)?this._sourcesContents[a]:null}),this)}toJSON(){const e={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(e.file=this._file),null!=this._sourceRoot&&(e.sourceRoot=this._sourceRoot),this._sourcesContents&&(e.sourcesContent=this._generateSourcesContent(e.sources,e.sourceRoot)),e}toString(){return JSON.stringify(this.toJSON())}}return n.prototype._version=3,sourceMapGenerator.SourceMapGenerator=n,sourceMapGenerator}var sourceMapConsumer={},binarySearch={},hasRequiredBinarySearch;function requireBinarySearch(){return hasRequiredBinarySearch||(hasRequiredBinarySearch=1,function(e){function t(r,a,n,o,s,i){const c=Math.floor((a-r)/2)+r,u=s(n,o[c],!0);return 0===u?c:u>0?a-c>1?t(c,a,n,o,s,i):i==e.LEAST_UPPER_BOUND?a<o.length?a:-1:c:c-r>1?t(r,c,n,o,s,i):i==e.LEAST_UPPER_BOUND?c:r<0?-1:r}e.GREATEST_LOWER_BOUND=1,e.LEAST_UPPER_BOUND=2,e.search=function(r,a,n,o){if(0===a.length)return-1;let s=t(-1,a.length,r,a,n,o||e.GREATEST_LOWER_BOUND);if(s<0)return-1;for(;s-1>=0&&0===n(a[s],a[s-1],!0);)--s;return s}}(binarySearch)),binarySearch}var readWasmBrowser={exports:{}},hasRequiredReadWasmBrowser,wasm,hasRequiredWasm,hasRequiredSourceMapConsumer;function requireReadWasmBrowser(){if(hasRequiredReadWasmBrowser)return readWasmBrowser.exports;hasRequiredReadWasmBrowser=1;let e=null;return readWasmBrowser.exports=function(){if("string"==typeof e)return fetch(e).then((e=>e.arrayBuffer()));if(e instanceof ArrayBuffer)return Promise.resolve(e);throw new Error("You must provide the string URL or ArrayBuffer contents of lib/mappings.wasm by calling SourceMapConsumer.initialize({ 'lib/mappings.wasm': ... }) before using SourceMapConsumer")},readWasmBrowser.exports.initialize=t=>{e=t},readWasmBrowser.exports}function requireWasm(){if(hasRequiredWasm)return wasm;hasRequiredWasm=1;const e=requireReadWasmBrowser();function t(){this.generatedLine=0,this.generatedColumn=0,this.lastGeneratedColumn=null,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}let r=null;return wasm=function(){if(r)return r;const a=[];return r=e().then((e=>WebAssembly.instantiate(e,{env:{mapping_callback(e,r,n,o,s,i,c,u,l,p){const f=new t;f.generatedLine=e+1,f.generatedColumn=r,n&&(f.lastGeneratedColumn=o-1),s&&(f.source=i,f.originalLine=c+1,f.originalColumn=u,l&&(f.name=p)),a[a.length-1](f)},start_all_generated_locations_for(){console.time("all_generated_locations_for")},end_all_generated_locations_for(){console.timeEnd("all_generated_locations_for")},start_compute_column_spans(){console.time("compute_column_spans")},end_compute_column_spans(){console.timeEnd("compute_column_spans")},start_generated_location_for(){console.time("generated_location_for")},end_generated_location_for(){console.timeEnd("generated_location_for")},start_original_location_for(){console.time("original_location_for")},end_original_location_for(){console.timeEnd("original_location_for")},start_parse_mappings(){console.time("parse_mappings")},end_parse_mappings(){console.timeEnd("parse_mappings")},start_sort_by_generated_location(){console.time("sort_by_generated_location")},end_sort_by_generated_location(){console.timeEnd("sort_by_generated_location")},start_sort_by_original_location(){console.time("sort_by_original_location")},end_sort_by_original_location(){console.timeEnd("sort_by_original_location")}}}))).then((e=>({exports:e.instance.exports,withMappingCallback:(e,t)=>{a.push(e);try{t()}finally{a.pop()}}}))).then(null,(e=>{throw r=null,e})),r},wasm}function requireSourceMapConsumer(){if(hasRequiredSourceMapConsumer)return sourceMapConsumer;hasRequiredSourceMapConsumer=1;const e=requireUtil(),t=requireBinarySearch(),r=requireArraySet().ArraySet;requireBase64Vlq();const a=requireReadWasmBrowser(),n=requireWasm(),o=Symbol("smcInternal");class s{constructor(t,r){return t==o?Promise.resolve(this):function(t,r){let a=t;"string"==typeof t&&(a=e.parseSourceMapInput(t));const n=null!=a.sections?new c(a,r):new i(a,r);return Promise.resolve(n)}(t,r)}static initialize(e){a.initialize(e["lib/mappings.wasm"])}static fromSourceMap(e,t){return function(e,t){return i.fromSourceMap(e,t)}(e,t)}static async with(e,t,r){const a=await new s(e,t);try{return await r(a)}finally{a.destroy()}}eachMapping(e,t,r){throw new Error("Subclasses must implement eachMapping")}allGeneratedPositionsFor(e){throw new Error("Subclasses must implement allGeneratedPositionsFor")}destroy(){throw new Error("Subclasses must implement destroy")}}s.prototype._version=3,s.GENERATED_ORDER=1,s.ORIGINAL_ORDER=2,s.GREATEST_LOWER_BOUND=1,s.LEAST_UPPER_BOUND=2,sourceMapConsumer.SourceMapConsumer=s;class i extends s{constructor(t,a){return super(o).then((o=>{let s=t;"string"==typeof t&&(s=e.parseSourceMapInput(t));const i=e.getArg(s,"version"),c=e.getArg(s,"sources").map(String),u=e.getArg(s,"names",[]),l=e.getArg(s,"sourceRoot",null),p=e.getArg(s,"sourcesContent",null),f=e.getArg(s,"mappings"),d=e.getArg(s,"file",null);if(i!=o._version)throw new Error("Unsupported version: "+i);return o._sourceLookupCache=new Map,o._names=r.fromArray(u.map(String),!0),o._sources=r.fromArray(c,!0),o._absoluteSources=r.fromArray(o._sources.toArray().map((function(t){return e.computeSourceURL(l,t,a)})),!0),o.sourceRoot=l,o.sourcesContent=p,o._mappings=f,o._sourceMapURL=a,o.file=d,o._computedColumnSpans=!1,o._mappingsPtr=0,o._wasm=null,n().then((e=>(o._wasm=e,o)))}))}_findSourceIndex(t){const r=this._sourceLookupCache.get(t);if("number"==typeof r)return r;const a=e.computeSourceURL(null,t,this._sourceMapURL);if(this._absoluteSources.has(a)){const e=this._absoluteSources.indexOf(a);return this._sourceLookupCache.set(t,e),e}const n=e.computeSourceURL(this.sourceRoot,t,this._sourceMapURL);if(this._absoluteSources.has(n)){const e=this._absoluteSources.indexOf(n);return this._sourceLookupCache.set(t,e),e}return-1}static fromSourceMap(e,t){return new i(e.toString())}get sources(){return this._absoluteSources.toArray()}_getMappingsPtr(){return 0===this._mappingsPtr&&this._parseMappings(),this._mappingsPtr}_parseMappings(){const e=this._mappings,t=e.length,r=this._wasm.exports.allocate_mappings(t),a=new Uint8Array(this._wasm.exports.memory.buffer,r,t);for(let r=0;r<t;r++)a[r]=e.charCodeAt(r);const n=this._wasm.exports.parse_mappings(r);if(!n){const e=this._wasm.exports.get_last_error();let t=`Error parsing mappings (code ${e}): `;switch(e){case 1:t+="the mappings contained a negative line, column, source index, or name index";break;case 2:t+="the mappings contained a number larger than 2**32";break;case 3:t+="reached EOF while in the middle of parsing a VLQ";break;case 4:t+="invalid base 64 character while parsing a VLQ";break;default:t+="unknown error code"}throw new Error(t)}this._mappingsPtr=n}eachMapping(e,t,r){const a=t||null,n=r||s.GENERATED_ORDER;this._wasm.withMappingCallback((t=>{null!==t.source&&(t.source=this._absoluteSources.at(t.source),null!==t.name&&(t.name=this._names.at(t.name))),this._computedColumnSpans&&null===t.lastGeneratedColumn&&(t.lastGeneratedColumn=1/0),e.call(a,t)}),(()=>{switch(n){case s.GENERATED_ORDER:this._wasm.exports.by_generated_location(this._getMappingsPtr());break;case s.ORIGINAL_ORDER:this._wasm.exports.by_original_location(this._getMappingsPtr());break;default:throw new Error("Unknown order of iteration.")}}))}allGeneratedPositionsFor(t){let r=e.getArg(t,"source");const a=e.getArg(t,"line"),n=t.column||0;if(r=this._findSourceIndex(r),r<0)return[];if(a<1)throw new Error("Line numbers must be >= 1");if(n<0)throw new Error("Column numbers must be >= 0");const o=[];return this._wasm.withMappingCallback((e=>{let t=e.lastGeneratedColumn;this._computedColumnSpans&&null===t&&(t=1/0),o.push({line:e.generatedLine,column:e.generatedColumn,lastColumn:t})}),(()=>{this._wasm.exports.all_generated_locations_for(this._getMappingsPtr(),r,a-1,"column"in t,n)})),o}destroy(){0!==this._mappingsPtr&&(this._wasm.exports.free_mappings(this._mappingsPtr),this._mappingsPtr=0)}computeColumnSpans(){this._computedColumnSpans||(this._wasm.exports.compute_column_spans(this._getMappingsPtr()),this._computedColumnSpans=!0)}originalPositionFor(t){const r={generatedLine:e.getArg(t,"line"),generatedColumn:e.getArg(t,"column")};if(r.generatedLine<1)throw new Error("Line numbers must be >= 1");if(r.generatedColumn<0)throw new Error("Column numbers must be >= 0");let a,n=e.getArg(t,"bias",s.GREATEST_LOWER_BOUND);if(null==n&&(n=s.GREATEST_LOWER_BOUND),this._wasm.withMappingCallback((e=>a=e),(()=>{this._wasm.exports.original_location_for(this._getMappingsPtr(),r.generatedLine-1,r.generatedColumn,n)})),a&&a.generatedLine===r.generatedLine){let t=e.getArg(a,"source",null);null!==t&&(t=this._absoluteSources.at(t));let r=e.getArg(a,"name",null);return null!==r&&(r=this._names.at(r)),{source:t,line:e.getArg(a,"originalLine",null),column:e.getArg(a,"originalColumn",null),name:r}}return{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return!!this.sourcesContent&&this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(e){return null==e}))}sourceContentFor(e,t){if(!this.sourcesContent)return null;const r=this._findSourceIndex(e);if(r>=0)return this.sourcesContent[r];if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')}generatedPositionFor(t){let r=e.getArg(t,"source");if(r=this._findSourceIndex(r),r<0)return{line:null,column:null,lastColumn:null};const a={source:r,originalLine:e.getArg(t,"line"),originalColumn:e.getArg(t,"column")};if(a.originalLine<1)throw new Error("Line numbers must be >= 1");if(a.originalColumn<0)throw new Error("Column numbers must be >= 0");let n,o=e.getArg(t,"bias",s.GREATEST_LOWER_BOUND);if(null==o&&(o=s.GREATEST_LOWER_BOUND),this._wasm.withMappingCallback((e=>n=e),(()=>{this._wasm.exports.generated_location_for(this._getMappingsPtr(),a.source,a.originalLine-1,a.originalColumn,o)})),n&&n.source===a.source){let t=n.lastGeneratedColumn;return this._computedColumnSpans&&null===t&&(t=1/0),{line:e.getArg(n,"generatedLine",null),column:e.getArg(n,"generatedColumn",null),lastColumn:t}}return{line:null,column:null,lastColumn:null}}}i.prototype.consumer=s,sourceMapConsumer.BasicSourceMapConsumer=i;class c extends s{constructor(t,r){return super(o).then((a=>{let n=t;"string"==typeof t&&(n=e.parseSourceMapInput(t));const o=e.getArg(n,"version"),i=e.getArg(n,"sections");if(o!=a._version)throw new Error("Unsupported version: "+o);let c={line:-1,column:0};return Promise.all(i.map((t=>{if(t.url)throw new Error("Support for url field in sections not implemented.");const a=e.getArg(t,"offset"),n=e.getArg(a,"line"),o=e.getArg(a,"column");if(n<c.line||n===c.line&&o<c.column)throw new Error("Section offsets must be ordered and non-overlapping.");return c=a,new s(e.getArg(t,"map"),r).then((e=>({generatedOffset:{generatedLine:n+1,generatedColumn:o+1},consumer:e})))}))).then((e=>(a._sections=e,a)))}))}get sources(){const e=[];for(let t=0;t<this._sections.length;t++)for(let r=0;r<this._sections[t].consumer.sources.length;r++)e.push(this._sections[t].consumer.sources[r]);return e}originalPositionFor(r){const a={generatedLine:e.getArg(r,"line"),generatedColumn:e.getArg(r,"column")},n=t.search(a,this._sections,(function(e,t){return e.generatedLine-t.generatedOffset.generatedLine||e.generatedColumn-t.generatedOffset.generatedColumn})),o=this._sections[n];return o?o.consumer.originalPositionFor({line:a.generatedLine-(o.generatedOffset.generatedLine-1),column:a.generatedColumn-(o.generatedOffset.generatedLine===a.generatedLine?o.generatedOffset.generatedColumn-1:0),bias:r.bias}):{source:null,line:null,column:null,name:null}}hasContentsOfAllSources(){return this._sections.every((function(e){return e.consumer.hasContentsOfAllSources()}))}sourceContentFor(e,t){for(let t=0;t<this._sections.length;t++){const r=this._sections[t].consumer.sourceContentFor(e,!0);if(r)return r}if(t)return null;throw new Error('"'+e+'" is not in the SourceMap.')}_findSectionIndex(e){for(let t=0;t<this._sections.length;t++){const{consumer:r}=this._sections[t];if(-1!==r._findSourceIndex(e))return t}return-1}generatedPositionFor(t){const r=this._findSectionIndex(e.getArg(t,"source")),a=r>=0?this._sections[r]:null,n=r>=0&&r+1<this._sections.length?this._sections[r+1]:null,o=a&&a.consumer.generatedPositionFor(t);if(o&&null!==o.line){const e=a.generatedOffset.generatedLine-1,t=a.generatedOffset.generatedColumn-1;return 1===o.line&&(o.column+=t,"number"==typeof o.lastColumn&&(o.lastColumn+=t)),o.lastColumn===1/0&&n&&o.line===n.generatedOffset.generatedLine&&(o.lastColumn=n.generatedOffset.generatedColumn-2),o.line+=e,o}return{line:null,column:null,lastColumn:null}}allGeneratedPositionsFor(t){const r=this._findSectionIndex(e.getArg(t,"source")),a=r>=0?this._sections[r]:null,n=r>=0&&r+1<this._sections.length?this._sections[r+1]:null;return a?a.consumer.allGeneratedPositionsFor(t).map((e=>{const t=a.generatedOffset.generatedLine-1,r=a.generatedOffset.generatedColumn-1;return 1===e.line&&(e.column+=r,"number"==typeof e.lastColumn&&(e.lastColumn+=r)),e.lastColumn===1/0&&n&&e.line===n.generatedOffset.generatedLine&&(e.lastColumn=n.generatedOffset.generatedColumn-2),e.line+=t,e})):[]}eachMapping(e,t,r){this._sections.forEach(((a,n)=>{const o=n+1<this._sections.length?this._sections[n+1]:null,{generatedOffset:s}=a,i=s.generatedLine-1,c=s.generatedColumn-1;a.consumer.eachMapping((function(t){1===t.generatedLine&&(t.generatedColumn+=c,"number"==typeof t.lastGeneratedColumn&&(t.lastGeneratedColumn+=c)),t.lastGeneratedColumn===1/0&&o&&t.generatedLine===o.generatedOffset.generatedLine&&(t.lastGeneratedColumn=o.generatedOffset.generatedColumn-2),t.generatedLine+=i,e.call(this,t)}),t,r)}))}computeColumnSpans(){for(let e=0;e<this._sections.length;e++)this._sections[e].consumer.computeColumnSpans()}destroy(){for(let e=0;e<this._sections.length;e++)this._sections[e].consumer.destroy()}}return sourceMapConsumer.IndexedSourceMapConsumer=c,sourceMapConsumer}var sourceNode={},hasRequiredSourceNode,hasRequiredSourceMap;function requireSourceNode(){if(hasRequiredSourceNode)return sourceNode;hasRequiredSourceNode=1;const e=requireSourceMapGenerator().SourceMapGenerator,t=requireUtil(),r=/(\r?\n)/,a="$$$isSourceNode$$$";class n{constructor(e,t,r,n,o){this.children=[],this.sourceContents={},this.line=null==e?null:e,this.column=null==t?null:t,this.source=null==r?null:r,this.name=null==o?null:o,this[a]=!0,null!=n&&this.add(n)}static fromStringWithSourceMap(e,a,o){const s=new n,i=e.split(r);let c=0;const u=function(){return e()+(e()||"");function e(){return c<i.length?i[c++]:void 0}};let l,p=1,f=0,d=null;return a.eachMapping((function(e){if(null!==d){if(!(p<e.generatedLine)){l=i[c]||"";const t=l.substr(0,e.generatedColumn-f);return i[c]=l.substr(e.generatedColumn-f),f=e.generatedColumn,m(d,t),void(d=e)}m(d,u()),p++,f=0}for(;p<e.generatedLine;)s.add(u()),p++;f<e.generatedColumn&&(l=i[c]||"",s.add(l.substr(0,e.generatedColumn)),i[c]=l.substr(e.generatedColumn),f=e.generatedColumn),d=e}),this),c<i.length&&(d&&m(d,u()),s.add(i.splice(c).join(""))),a.sources.forEach((function(e){const r=a.sourceContentFor(e);null!=r&&(null!=o&&(e=t.join(o,e)),s.setSourceContent(e,r))})),s;function m(e,r){if(null===e||void 0===e.source)s.add(r);else{const a=o?t.join(o,e.source):e.source;s.add(new n(e.originalLine,e.originalColumn,a,r,e.name))}}}add(e){if(Array.isArray(e))e.forEach((function(e){this.add(e)}),this);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);e&&this.children.push(e)}return this}prepend(e){if(Array.isArray(e))for(let t=e.length-1;t>=0;t--)this.prepend(e[t]);else{if(!e[a]&&"string"!=typeof e)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+e);this.children.unshift(e)}return this}walk(e){let t;for(let r=0,n=this.children.length;r<n;r++)t=this.children[r],t[a]?t.walk(e):""!==t&&e(t,{source:this.source,line:this.line,column:this.column,name:this.name})}join(e){let t,r;const a=this.children.length;if(a>0){for(t=[],r=0;r<a-1;r++)t.push(this.children[r]),t.push(e);t.push(this.children[r]),this.children=t}return this}replaceRight(e,t){const r=this.children[this.children.length-1];return r[a]?r.replaceRight(e,t):"string"==typeof r?this.children[this.children.length-1]=r.replace(e,t):this.children.push("".replace(e,t)),this}setSourceContent(e,r){this.sourceContents[t.toSetString(e)]=r}walkSourceContents(e){for(let t=0,r=this.children.length;t<r;t++)this.children[t][a]&&this.children[t].walkSourceContents(e);const r=Object.keys(this.sourceContents);for(let a=0,n=r.length;a<n;a++)e(t.fromSetString(r[a]),this.sourceContents[r[a]])}toString(){let e="";return this.walk((function(t){e+=t})),e}toStringWithSourceMap(t){const r={code:"",line:1,column:0},a=new e(t);let n=!1,o=null,s=null,i=null,c=null;return this.walk((function(e,t){r.code+=e,null!==t.source&&null!==t.line&&null!==t.column?(o===t.source&&s===t.line&&i===t.column&&c===t.name||a.addMapping({source:t.source,original:{line:t.line,column:t.column},generated:{line:r.line,column:r.column},name:t.name}),o=t.source,s=t.line,i=t.column,c=t.name,n=!0):n&&(a.addMapping({generated:{line:r.line,column:r.column}}),o=null,n=!1);for(let s=0,i=e.length;s<i;s++)10===e.charCodeAt(s)?(r.line++,r.column=0,s+1===i?(o=null,n=!1):n&&a.addMapping({source:t.source,original:{line:t.line,column:t.column},generated:{line:r.line,column:r.column},name:t.name})):r.column++})),this.walkSourceContents((function(e,t){a.setSourceContent(e,t)})),{code:r.code,map:a}}}return sourceNode.SourceNode=n,sourceNode}function requireSourceMap(){return hasRequiredSourceMap||(hasRequiredSourceMap=1,sourceMap.SourceMapGenerator=requireSourceMapGenerator().SourceMapGenerator,sourceMap.SourceMapConsumer=requireSourceMapConsumer().SourceMapConsumer,sourceMap.SourceNode=requireSourceNode().SourceNode),sourceMap}var chaiLike$1={exports:{}},hasRequiredChaiLike$1,chaiLike,hasRequiredChaiLike,hasRequiredPegjsApi_spec;function requireChaiLike$1(){if(hasRequiredChaiLike$1)return chaiLike$1.exports;hasRequiredChaiLike$1=1;let e=[];return chaiLike$1.exports=function(t,r){function a(e,t){return r.type(t).toUpperCase()===e.toUpperCase()}function n(t,r){for(let a of e)if(a.match(t,r))return a.assert(t,r);if(t===r)return!0;if(a("object",r)&&a("object",t)){for(let e of Object.keys(r)){if(!(e in t))return!1;if(!n(t[e],r[e]))return!1}return!0}if(a("array",r)&&a("array",t)){if(t.length!==r.length)return!1;for(let e=0;e<r.length;e++)if(!n(t[e],r[e]))return!1;return!0}return a("RegExp",t)&&a("RegExp",r)?t.toString()===r.toString():a("Date",t)&&a("Date",r)?t.getTime()===r.getTime():!!(a("string",t)&&a("string",r)||a("number",t)&&a("number",r)||a("boolean",t)&&a("boolean",r))&&t==r}t.Assertion.addMethod("like",(function(e){let a=r.flag(this,"object");this.assert(n(a,e),"expected #{this} to be like #{exp}","expected #{this} to not like #{exp}",e,a,t.config.showDiff)}))},chaiLike$1.exports.extend=function(t){e.push(t)},chaiLike$1.exports.clearPlugins=function(){e=[]},chaiLike$1.exports}function requireChaiLike(){return hasRequiredChaiLike?chaiLike:(hasRequiredChaiLike=1,chaiLike=requireChaiLike$1())}function requirePegjsApi_spec(){if(hasRequiredPegjsApi_spec)return pegjsApi_spec;hasRequiredPegjsApi_spec=1;var chai=require$$0,peg=requirePeg(),pkg=require$$2,SourceMapConsumer=requireSourceMap().SourceMapConsumer,spy=requireUtils().spy;chai.use(requireChaiLike()),beforeEach((function(){return"undefined"!=typeof window?SourceMapConsumer.initialize({"lib/mappings.wasm":"https://raw.githubusercontent.com/mozilla/source-map/0.7.3/lib/mappings.wasm"}):null}));var expect=chai.expect;return describe("Peggy API",(function(){it("has the correct VERSION",(function(){expect(peg.VERSION).to.equal(pkg.version),globalThis.peggyVersion=peg.VERSION})),describe("generate",(function(){it("generates a parser",(function(){var e=peg.generate("start = 'a'");expect(e).to.be.an("object"),expect(e.parse("a")).to.equal("a")})),it("throws an exception on syntax error",(function(){expect((function(){peg.generate("start = @")})).to.throw()})),it("throws an exception on semantic error",(function(){expect((function(){peg.generate("start = undefined")})).to.throw()})),describe("allowed start rules",(function(){var e=["a = 'x'","b = 'x'","c = 'x'"].join("\n");describe("when |allowedStartRules| is not set",(function(){it("generated parser can start only from the first rule",(function(){var t=peg.generate(e);expect(t.parse("x",{startRule:"a"})).to.equal("x"),expect((function(){t.parse("x",{startRule:"b"})})).to.throw(),expect((function(){t.parse("x",{startRule:"c"})})).to.throw()}))})),describe("when |allowedStartRules| is set",(function(){it("generated parser can start only from specified rules",(function(){var t=peg.generate(e,{allowedStartRules:["b","c"]});expect((function(){t.parse("x",{startRule:"a"})})).to.throw(),expect(t.parse("x",{startRule:"b"})).to.equal("x"),expect(t.parse("x",{startRule:"c"})).to.equal("x")}))}))})),describe("intermediate results caching",(function(){var e=["{ var n = 0; }","start = (a 'b') / (a 'c') { return n; }","a = 'a' { n++; }"].join("\n");describe("when |cache| is not set",(function(){it("generated parser doesn't cache intermediate parse results",(function(){var t=peg.generate(e);expect(t.parse("ac")).to.equal(2)}))})),describe("when |cache| is set to |false|",(function(){it("generated parser doesn't cache intermediate parse results",(function(){var t=peg.generate(e,{cache:!1});expect(t.parse("ac")).to.equal(2)}))})),describe("when |cache| is set to |true|",(function(){it("generated parser caches intermediate parse results",(function(){var t=peg.generate(e,{cache:!0});expect(t.parse("ac")).to.equal(1)}))}))})),describe("tracing",(function(){var e="start = 'a'";describe("when |trace| is not set",(function(){it("generated parser doesn't trace",(function(){var t=peg.generate(e),r={trace:spy()};t.parse("a",{tracer:r}),expect(r.trace.called).to.equal(!1)}))})),describe("when |trace| is set to |false|",(function(){it("generated parser doesn't trace",(function(){var t=peg.generate(e,{trace:!1}),r={trace:spy()};t.parse("a",{tracer:r}),expect(r.trace.called).to.equal(!1)}))})),describe("when |trace| is set to |true|",(function(){it("generated parser traces",(function(){var t=peg.generate(e,{trace:!0}),r={trace:spy()};t.parse("a",{tracer:r}),expect(r.trace.called).to.equal(!0)}))}))})),describe("output",(function(){var grammar="start = 'a'";describe("when |output| is not set",(function(){it("returns generated parser object",(function(){var e=peg.generate(grammar);expect(e).to.be.an("object"),expect(e.parse("a")).to.equal("a")}))})),describe('when |output| is set to |"parser"|',(function(){it("returns generated parser object",(function(){var e=peg.generate(grammar,{output:"parser"});expect(e).to.be.an("object"),expect(e.parse("a")).to.equal("a")}))})),describe('when |output| is set to |"source"|',(function(){it("returns generated parser source code",(function(){var source=peg.generate(grammar,{output:"source"});expect(source).to.be.a("string"),expect(eval(source).parse("a")).to.equal("a")}))})),describe('when |output| is set to |"ast"|',(function(){it("returns generated parser AST",(function(){var e=peg.generate(grammar,{output:"ast"});expect(e).to.be.an("object"),expect(e).to.be.like(peg.parser.parse(grammar))}))}))})),describe("reserved words",(function(){describe("throws an exception on reserved JS words used as a label",(function(){for(var e=function(e){it(e,(function(){expect((function(){peg.generate(["start = "+e+":end","end = 'a'"].join("\n"),{output:"source"})})).to.throw(peg.parser.SyntaxError)}))},t=0,r=peg.RESERVED_WORDS;t<r.length;t++)e(r[t])})),describe("does not throw an exception on special non-reserved JS words used as a label",(function(){for(var nonReserved=["abstract","boolean","byte","char","double","final","float","goto","int","long","native","short","synchronized","throws","transient","volatile","as","async","from","get","of","set"],_loop_2=function(label){it(label,(function(){var source=peg.generate(["start = "+label+":end { return "+label+"; }","end = 'a'"].join("\n"),{output:"source"});expect(eval(source).parse("a")).to.equal("a")}))},_i=0,nonReserved_1=nonReserved;_i<nonReserved_1.length;_i++){var label=nonReserved_1[_i];_loop_2(label)}})),describe("does not throw an exception on reserved JS words used as a rule name",(function(){for(var _loop_3=function(rule){it(rule,(function(){var source=peg.generate(["start = "+rule,rule+" = 'a'"].join("\n"),{output:"source"});expect(eval(source).parse("a")).to.equal("a")}))},_i=0,_a=peg.RESERVED_WORDS;_i<_a.length;_i++){var rule=_a[_i];_loop_3(rule)}}))})),it("accepts custom options",(function(){peg.generate("start = 'a'",{grammarSource:42})})),describe("generates source map",(function(){function e(e,t,r){for(var a=t instanceof RegExp?e.search(t):e.indexOf(t),n=1,o=0,s=0;s<a;++s)10===e.charCodeAt(s)?(++n,o=0):++o;if(r&&r.offset){var i=r.offset({line:n,column:o,offset:a});return delete i.offset,i}return{line:n,column:o}}var t="GLOBAL\nINITIALIZER",r="PER-PARSE\nINITIALIZER",a="NOT\nBLOCK",n="AND\nBLOCK",o="ACTION\nBLOCK",s="MIN\nBLOCK",i="MAX\nBLOCK",c="EXACT\nBLOCK",u="\n        {{".concat(t,"}}\n        {").concat(r,"}\n        RULE_1 = !{").concat(a,"} 'a' rule:RULE_2 {").concat(o,"};\n        RULE_2 'named' = &{").concat(n,"} @'b' [abc] 'def';\n        RULE_3 = RULE_1 / RULE_2;\n        RULE_4 = RULE_1|{").concat(s,"} .. {").concat(i,"}, RULE_2|{").concat(c,"}| |;\n      ");function l(t,r,a,n){void 0===n&&(n=t);var o=peg.generate(u,{grammarSource:r,output:"source-and-map"}).toStringWithSourceMap(),s=o.code,i=o.map,c=e(u,t,r),l=e(s,n);return delete c.offset,delete l.offset,SourceMapConsumer.fromSourceMap(i).then((function(e){expect(e.originalPositionFor(l)).to.be.deep.equal(Object.assign(c,{source:String(r),name:a}))}))}for(var p=function(e){describe("with source = ".concat(chai.util.inspect(e)),(function(){it("global initializer",(function(){return l(t,e,"$top_level_initializer")})),it("per-parse initializer",(function(){return l(r,e,"$initializer")})),it("action block",(function(){return l(o,e,null)})),it("semantic and predicate",(function(){return l(n,e,null)})),it("semantic not predicate",(function(){return l(a,e,null)})),it("min function boundary",(function(){return l(s,e,null)})),it("max function boundary",(function(){return l(i,e,null)})),it("exact function boundary",(function(){return l(c,e,null)})),it("rule name",(function(){return l("RULE_1",e,"RULE_1","peg$parseRULE_1() {")})),it("labelled rule name",(function(){return l("RULE_2 'named'",e,"RULE_2","peg$parseRULE_2() {")})),it("literal expression",(function(){return l("'a'",e,null,"input.charCodeAt(peg$currPos) === 97")})),it("multichar literal",(function(){return l("'def'",e,null,"input.substr(peg$currPos, 3) === peg$c3")})),it("chars expression",(function(){return l("[abc]",e,null,/s\d = input\.charAt\(peg\$currPos\);\s*if \(peg\$r0\.test\(s\d\)\)/)})),it("rule expression",(function(){return l("RULE_2",e,null,"peg$parseRULE_2();")})),it("choice expression",(function(){return l("RULE_1 / RULE_2",e,null,new RegExp([/peg\$parseRULE_1\(\);\s*/,/if \(s. === peg\$FAILED\) \{\s*/,/s. = peg\$parseRULE_2/].map((function(e){return e.source})).join("")))}))}))},f=0,d=["-",new peg.GrammarLocation("-",{offset:51,line:13,column:7})];f<d.length;f++)p(d[f])}))}))})),pegjsApi_spec}requirePegjsApi_spec();var pluginApi_spec={},hasRequiredPluginApi_spec;function requirePluginApi_spec(){if(hasRequiredPluginApi_spec)return pluginApi_spec;hasRequiredPluginApi_spec=1;var e=require$$0,t=requireSourceMap().SourceNode,r=requirePeg(),a=requireOpcodes(),n=e.expect;return describe("plugin API",(function(){describe("use",(function(){var e="start = 'a'";it("is called for each plugin",(function(){var t=[!1,!1,!1],a=[{use:function(){t[0]=!0}},{use:function(){t[1]=!0}},{use:function(){t[2]=!0}}];r.generate(e,{plugins:a}),n(t).to.deep.equal([!0,!0,!0])})),it("receives configuration",(function(){var t={use:function(e){n(e).to.be.an("object"),n(e.parser).to.be.an("object"),n(e.parser.parse("start = 'a'")).to.be.an("object"),n(e.passes).to.be.an("object"),n(e.passes.check).to.be.an("array"),e.passes.check.forEach((function(e){n(e).to.be.a("function")})),n(e.passes.transform).to.be.an("array"),e.passes.transform.forEach((function(e){n(e).to.be.a("function")})),n(e.passes.generate).to.be.an("array"),e.passes.generate.forEach((function(e){n(e).to.be.a("function")})),n(e.reservedWords).to.be.an("array"),e.reservedWords.forEach((function(e){n(e).to.be.a("string")}))}};r.generate(e,{plugins:[t]})})),it("receives options",(function(){var t={plugins:[{use:function(e,r){n(r).to.equal(t)}}],foo:42};r.generate(e,t)})),it("can replace parser",(function(){var e={use:function(e){var t=r.generate(["start = .* {","  return {","    type: 'grammar',","    imports: [],","    initializer: {","      type: 'initializer',","      code: ['/* included for cover ast2SourceNode in the generate-js pass */'],","    },","    rules: [","      {","        type: 'rule',","        name: 'start',","        expression: { type: 'literal',  value: text(), ignoreCase: false }","      }","    ]","  };","}"].join("\n"));e.parser=t}},t=r.generate("a",{plugins:[e]});n(t.parse("a")).to.equal("a")})),it("can change compiler passes",(function(){var a={use:function(e){e.passes.generate=[function(e){e.code=new t(1,0,"plugin","({ parse: function() { return 42; } })")}]}},o=r.generate(e,{plugins:[a]});n(o.parse("a")).to.equal(42)})),it("can change list of reserved words",(function(){var e={use:function(e){e.reservedWords=[]}};n((function(){r.generate("start = "+r.RESERVED_WORDS[0]+":'a'",{plugins:[e],output:"source"})})).to.not.throw()})),it("can change options",(function(){var e=["a = 'x'","b = 'x'","c = 'x'"].join("\n"),t=r.generate(e,{allowedStartRules:["a"],plugins:[{use:function(e,t){t.allowedStartRules=["b","c"]}}]});n((function(){t.parse("x",{startRule:"a"})})).to.throw(),n(t.parse("x",{startRule:"b"})).to.equal("x"),n(t.parse("x",{startRule:"c"})).to.equal("x")})),it("can use star for start rules",(function(){var e=["a = 'x'","b = 'x'","c = 'x'"].join("\n"),t=r.generate(e,{allowedStartRules:["*"]});n(t.parse("x",{startRule:"a"})).to.equal("x"),n(t.parse("x",{startRule:"b"})).to.equal("x"),n(t.parse("x",{startRule:"c"})).to.equal("x")})),it("can munge the bytecode",(function(){var e={use:function(e){e.passes.generate.splice(1,0,(function(e){n(e.rules.length).to.equal(2);var t=e.rules[0].bytecode;n(t[0]).to.equal(a.MATCH_STRING_IC),t.splice(4,0,a.PUSH_CURR_POS,a.POP),t[2]+=2,t=e.rules[1].bytecode,n(t[0]).to.equal(a.MATCH_STRING),n(t[4]).to.equal(a.ACCEPT_STRING),t[4]=a.ACCEPT_N,t[5]=1}))}},t=r.generate("one = 'abc'i; two = 'a'",{plugins:[e],output:"source"}),o=new RegExp([/if \(input\.substr\(peg\$currPos, 3\)/,/.toLowerCase\(\) === peg\$c0\) \{/,/\s*s0 = peg\$currPos;/,/\s*s0 = input\.substr/].map((function(e){return e.source})).join(""));n(t.search(o)).to.be.greaterThan(0)}))}))})),pluginApi_spec}requirePluginApi_spec();var generatedParserBehavior_spec={},hasRequiredGeneratedParserBehavior_spec;function requireGeneratedParserBehavior_spec(){if(hasRequiredGeneratedParserBehavior_spec)return generatedParserBehavior_spec;hasRequiredGeneratedParserBehavior_spec=1;var e=require$$0,t=requirePeg(),r=e.expect,a=requireUtils().stub;return describe("generated parser behavior",(function(){function n(e){var t={};return Object.keys(e).forEach((function(r){t[r]=e[r]})),t}function o(e){"object"==typeof console&&a(console,"log");try{return e()}finally{"object"==typeof console&&console.log.restore()}}function s(e,t){var r=e.Assertion;r.addMethod("parse",(function(e,r,a){var n=this;a=void 0!==a?a:{};var s=o((function(){return t.flag(n,"object").parse(e,a)}));void 0!==r&&this.assert(t.eql(s,r),"expected #{this} to parse input as #{exp} but got #{act}","expected #{this} to not parse input as #{exp}",r,s,!t.flag(this,"negate"))})),r.addMethod("failToParse",(function(e,a,n){var s=this;n=void 0!==n?n:{};var i=!1,c=void 0;try{c=o((function(){return t.flag(s,"object").parse(e,n)})),i=!0}catch(e){c=e}this.assert(!i,"expected #{this} to fail to parse input but got #{act}","expected #{this} to not fail to parse input but #{act} was thrown",null,c),i||void 0===a||Object.keys(a).forEach((function(e){new r(c).to.have.property(e).that.is.deep.equal(a[e])}))}))}var i;beforeEach((function(){e.use(s)})),i=function(e){describe("initializer",(function(){it("executes the code before parsing starts",(function(){var a=t.generate(["{ var result = 42; }","start = 'a' { return result; }"].join("\n"),e);r(a).to.parse("a",42)})),describe("available variables and functions",(function(){it("|options| contains options",(function(){var a=t.generate(["{ var result = options; }","start = 'a' { return result; }"].join("\n"),e);r(a).to.parse("a",{a:42},{a:42})}))}))})),describe("rule",(function(){e.cache?it("caches rule match results",(function(){var a=t.generate(["{ var n = 0; }","start = (a 'b') / (a 'c') { return n; }","a = 'a' { n++; }"].join("\n"),e);r(a).to.parse("ac",1)})):it("doesn't cache rule match results",(function(){var a=t.generate(["{ var n = 0; }","start = (a 'b') / (a 'c') { return n; }","a = 'a' { n++; }"].join("\n"),e);r(a).to.parse("ac",2)})),describe("when the expression matches",(function(){describe("without display name",(function(){describe("returns its match result",(function(){it("when expression may match",(function(){var a=t.generate("start = 'a'",e);r(a).to.parse("a","a")})),it("when expression always match",(function(){var a=t.generate("start = 'a'*",e);r(a).to.parse("",[])}))}))})),describe("with display name",(function(){describe("returns its match result",(function(){it("when expression may match",(function(){var a=t.generate("start 'start' = 'a'",e);r(a).to.parse("a","a")})),it("when expression always match",(function(){var a=t.generate("start 'start' = 'a'*",e);r(a).to.parse("",[])}))}))}))})),describe("when the expression doesn't match",(function(){describe("without display name",(function(){describe("reports match failure and records an expectation",(function(){it("when expression may match",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("b",{expected:[{type:"literal",text:"a",ignoreCase:!1}]})})),it("when expression never match",(function(){var a=t.generate("start = []",e);r(a).to.failToParse("b",{expected:[{type:"class",parts:[],inverted:!1,ignoreCase:!1}]})}))}))})),describe("with display name",(function(){it('reports match failure and records an expectation of type "other" when expression may match',(function(){var a=t.generate("start 'start' = 'a'",e);r(a).to.failToParse("b",{expected:[{type:"other",description:"start"}]})})),it("reports match failure and doesn't records any expectations when expression never match",(function(){var a=t.generate("start 'start' = []",e);r(a).to.failToParse("b",{expected:[]})})),it("discards any expectations recorded when matching the expression",(function(){var a=t.generate("start 'start' = 'a'",e);r(a).to.failToParse("b",{expected:[{type:"other",description:"start"}]})}))}))}))})),describe("literal",(function(){describe("matching",(function(){it("matches empty literals",(function(){var a=t.generate("start = ''",e);r(a).to.parse("")})),it("matches one-character literals",(function(){var a=t.generate("start = 'a'",e);r(a).to.parse("a"),r(a).to.failToParse("b")})),it("matches multi-character literals",(function(){var a=t.generate("start = 'abcd'",e);r(a).to.parse("abcd"),r(a).to.failToParse("efgh")})),it('is case sensitive without the "i" flag',(function(){var a=t.generate("start = 'a'",e);r(a).to.parse("a"),r(a).to.failToParse("A")})),it('is case insensitive with the "i" flag',(function(){var a=t.generate("start = 'a'i",e);r(a).to.parse("a"),r(a).to.parse("A")}))})),describe("when it matches",(function(){it("returns the matched text",(function(){var a=t.generate("start = 'a'",e);r(a).to.parse("a","a")})),it("consumes the matched text",(function(){var a=t.generate("start = 'a' .",e);r(a).to.parse("ab")}))})),describe("when it doesn't match",(function(){it('reports match failure and records an expectation of type "literal"',(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("b",{expected:[{type:"literal",text:"a",ignoreCase:!1}]})}))}))})),describe("character class",(function(){describe("matching",(function(){it("matches empty classes",(function(){var a=t.generate("start = []",e);r(a).to.failToParse("a")})),it("matches classes with a character list",(function(){var a=t.generate("start = [abc]",e);r(a).to.parse("a"),r(a).to.parse("b"),r(a).to.parse("c"),r(a).to.failToParse("d")})),it("matches classes with a character range",(function(){var a=t.generate("start = [a-c]",e);r(a).to.parse("a"),r(a).to.parse("b"),r(a).to.parse("c"),r(a).to.failToParse("d")})),it("matches inverted classes",(function(){var a=t.generate("start = [^a]",e);r(a).to.failToParse("a"),r(a).to.parse("b")})),it('is case sensitive without the "i" flag',(function(){var a=t.generate("start = [a]",e);r(a).to.parse("a"),r(a).to.failToParse("A")})),it('is case insensitive with the "i" flag',(function(){var a=t.generate("start = [a]i",e);r(a).to.parse("a"),r(a).to.parse("A")}))})),describe("when it matches",(function(){it("returns the matched character",(function(){var a=t.generate("start = [a]",e);r(a).to.parse("a","a")})),it("consumes the matched character",(function(){var a=t.generate("start = [a] .",e);r(a).to.parse("ab")}))})),describe("when it doesn't match",(function(){it('reports match failure and records an expectation of type "class"',(function(){var a=t.generate("start = [a]",e);r(a).to.failToParse("b",{expected:[{type:"class",parts:["a"],inverted:!1,ignoreCase:!1}]})}))}))})),describe("dot",(function(){describe("matching",(function(){it("matches any character",(function(){var a=t.generate("start = .",e);r(a).to.parse("a"),r(a).to.parse("b"),r(a).to.parse("c")}))})),describe("when it matches",(function(){it("returns the matched character",(function(){var a=t.generate("start = .",e);r(a).to.parse("a","a")})),it("consumes the matched character",(function(){var a=t.generate("start = . .",e);r(a).to.parse("ab")}))})),describe("when it doesn't match",(function(){it('reports match failure and records an expectation of type "any"',(function(){var a=t.generate("start = .",e);r(a).to.failToParse("",{expected:[{type:"any"}]})}))}))})),describe("rule reference",(function(){describe("when referenced rule's expression matches",(function(){it("returns its result",(function(){var a=t.generate(["start = a","a = 'a'"].join("\n"),e);r(a).to.parse("a","a")}))})),describe("when referenced rule's expression doesn't match",(function(){it("reports match failure",(function(){var a=t.generate(["start = a","a = 'a'"].join("\n"),e);r(a).to.failToParse("b")}))}))})),describe("positive semantic predicate",(function(){describe("when the code returns a truthy value",(function(){it("returns |undefined|",(function(){var a=t.generate("start = &{ return true; } ''",e);r(a).to.parse("",[void 0,""])}))})),describe("when the code returns a falsey value",(function(){it("reports match failure",(function(){var a=t.generate("start = &{ return false; }",e);r(a).to.failToParse("")}))})),describe("label variables",(function(){describe("in containing sequence",(function(){it("can access variables defined by preceding labeled elements",(function(){var a=t.generate("start = a:'a' &{ return a === 'a'; }",e);r(a).to.parse("a")})),it("cannot access variable defined by labeled predicate element",(function(){var a=t.generate("start = 'a' b:&{ return b === undefined; } 'c'",e);r(a).to.failToParse("ac")})),it("cannot access variables defined by following labeled elements",(function(){var a=t.generate("start = &{ return a === 'a'; } a:'a'",e);r(a).to.failToParse("a")})),it("cannot access variables defined by subexpressions",(function(){[{grammar:"start = (a:'a') &{ return a === 'a'; }",input:"a"},{grammar:"start = (a:'a')? &{ return a === 'a'; }",input:"a"},{grammar:"start = (a:'a')* &{ return a === 'a'; }",input:"a"},{grammar:"start = (a:'a')+ &{ return a === 'a'; }",input:"a"},{grammar:"start = (a:'a')| .. | &{ return a === 'a'; }",input:"a"},{grammar:"start = (a:'a')|0.. | &{ return a === 'a'; }",input:"a"},{grammar:"start = (a:'a')|1.. | &{ return a === 'a'; }",input:"a"},{grammar:"start = (a:'a')|2.. | &{ return a === 'a'; }",input:"aa"},{grammar:"start = (a:'a')| ..1| &{ return a === 'a'; }",input:"a"},{grammar:"start = (a:'a')| ..3| &{ return a === 'a'; }",input:"a"},{grammar:"start = (a:'a')|2..3| &{ return a === 'a'; }",input:"aa"},{grammar:"start = (a:'a')|3| &{ return a === 'a'; }",input:"aaa"},{grammar:"start = $(a:'a') &{ return a === 'a'; }",input:"a"},{grammar:"start = &(a:'a') 'a' &{ return a === 'a'; }",input:"a"},{grammar:"start = !(a:'a') 'b' &{ return a === 'a'; }",input:"b"},{grammar:"start = b:(a:'a') &{ return a === 'a'; }",input:"a"},{grammar:"start = ('a' b:'b' 'c') &{ return b === 'b'; }",input:"abc"},{grammar:"start = (a:'a' { return a; }) &{ return a === 'a'; }",input:"a"},{grammar:"start = ('a' / b:'b' / 'c') &{ return b === 'b'; }",input:"b"}].forEach((function(a){var n=t.generate(a.grammar,e);r(n).to.failToParse(a.input)}))}))})),describe("in outer sequence",(function(){it("can access variables defined by preceding labeled elements",(function(){var a=t.generate("start = a:'a' ('b' &{ return a === 'a'; })",e);r(a).to.parse("ab")})),it("cannot access variable defined by labeled predicate element",(function(){var a=t.generate("start = 'a' b:('b' &{ return b === undefined; }) 'c'",e);r(a).to.failToParse("abc")})),it("cannot access variables defined by following labeled elements",(function(){var a=t.generate("start = ('a' &{ return b === 'b'; }) b:'b'",e);r(a).to.failToParse("ab")}))}))})),describe("initializer variables & functions",(function(){it("can access variables defined in the initializer",(function(){var a=t.generate(["{ var v = 42 }","start = &{ return v === 42; }"].join("\n"),e);r(a).to.parse("")})),it("can access functions defined in the initializer",(function(){var a=t.generate(["{ function f() { return 42; } }","start = &{ return f() === 42; }"].join("\n"),e);r(a).to.parse("")}))})),describe("available variables & functions",(function(){it("|options| contains options",(function(){var a=t.generate(["{ var result; }","start = &{ result = options; return true; } { return result; }"].join("\n"),e);r(a).to.parse("",{a:42},{a:42})})),it("|location| returns current location info",(function(){var a=t.generate(["{ var result; }","start = line (nl+ line)* { return result; }","line = thing (' '+ thing)*","thing = digit / mark","digit = [0-9]","mark = &{ result = location(); return true; } 'x'","nl = '\\r'? '\\n'"].join("\n"),e);r(a).to.parse("1\n2\n\n3\n\n\n4 5 x",{source:void 0,start:{offset:13,line:7,column:5},end:{offset:13,line:7,column:5}}),r(a).to.parse("1\nx",{source:void 0,start:{offset:2,line:2,column:1},end:{offset:2,line:2,column:1}}),r(a).to.parse("1\r\nx",{source:void 0,start:{offset:3,line:2,column:1},end:{offset:3,line:2,column:1}})})),it("|offset| returns current start offset",(function(){var a=t.generate(["start = [0-9]+ @mark","mark = 'xx' { return offset(); }"].join("\n"),e);r(a).to.parse("0123456xx",7)})),it("|range| returns current range",(function(){var a=t.generate(["start = [0-9]+ @mark","mark = 'xx' { return range(); }"].join("\n"),e);r(a).to.parse("0123456xx",{source:void 0,start:7,end:9})}))}))})),describe("negative semantic predicate",(function(){describe("when the code returns a falsey value",(function(){it("returns |undefined|",(function(){var a=t.generate("start = !{ return false; } ''",e);r(a).to.parse("",[void 0,""])}))})),describe("when the code returns a truthy value",(function(){it("reports match failure",(function(){var a=t.generate("start = !{ return true; }",e);r(a).to.failToParse("")}))})),describe("label variables",(function(){describe("in containing sequence",(function(){it("can access variables defined by preceding labeled elements",(function(){var a=t.generate("start = a:'a' !{ return a !== 'a'; }",e);r(a).to.parse("a")})),it("cannot access variable defined by labeled predicate element",(function(){var a=t.generate("start = 'a' b:!{ return b !== undefined; } 'c'",e);r(a).to.failToParse("ac")})),it("cannot access variables defined by following labeled elements",(function(){var a=t.generate("start = !{ return a !== 'a'; } a:'a'",e);r(a).to.failToParse("a")})),it("cannot access variables defined by subexpressions",(function(){[{grammar:"start = (a:'a') !{ return a !== 'a'; }",input:"a"},{grammar:"start = (a:'a')? !{ return a !== 'a'; }",input:"a"},{grammar:"start = (a:'a')* !{ return a !== 'a'; }",input:"a"},{grammar:"start = (a:'a')+ !{ return a !== 'a'; }",input:"a"},{grammar:"start = (a:'a')| .. | !{ return a !== 'a'; }",input:"a"},{grammar:"start = (a:'a')|0.. | !{ return a !== 'a'; }",input:"a"},{grammar:"start = (a:'a')|1.. | !{ return a !== 'a'; }",input:"a"},{grammar:"start = (a:'a')|2.. | !{ return a !== 'a'; }",input:"aa"},{grammar:"start = (a:'a')| ..1| !{ return a !== 'a'; }",input:"a"},{grammar:"start = (a:'a')| ..3| !{ return a !== 'a'; }",input:"a"},{grammar:"start = (a:'a')|2..3| !{ return a !== 'a'; }",input:"aa"},{grammar:"start = (a:'a')|3| !{ return a !== 'a'; }",input:"aaa"},{grammar:"start = $(a:'a') !{ return a !== 'a'; }",input:"a"},{grammar:"start = &(a:'a') 'a' !{ return a !== 'a'; }",input:"a"},{grammar:"start = !(a:'a') 'b' !{ return a !== 'a'; }",input:"b"},{grammar:"start = b:(a:'a') !{ return a !== 'a'; }",input:"a"},{grammar:"start = ('a' b:'b' 'c') !{ return b !== 'b'; }",input:"abc"},{grammar:"start = (a:'a' { return a; }) !{ return a !== 'a'; }",input:"a"},{grammar:"start = ('a' / b:'b' / 'c') !{ return b !== 'b'; }",input:"b"}].forEach((function(a){var n=t.generate(a.grammar,e);r(n).to.failToParse(a.input)}))}))})),describe("in outer sequence",(function(){it("can access variables defined by preceding labeled elements",(function(){var a=t.generate("start = a:'a' ('b' !{ return a !== 'a'; })",e);r(a).to.parse("ab")})),it("cannot access variable defined by labeled predicate element",(function(){var a=t.generate("start = 'a' b:('b' !{ return b !== undefined; }) 'c'",e);r(a).to.failToParse("abc")})),it("cannot access variables defined by following labeled elements",(function(){var a=t.generate("start = ('a' !{ return b !== 'b'; }) b:'b'",e);r(a).to.failToParse("ab")}))}))})),describe("initializer variables & functions",(function(){it("can access variables defined in the initializer",(function(){var a=t.generate(["{ var v = 42 }","start = !{ return v !== 42; }"].join("\n"),e);r(a).to.parse("")})),it("can access functions defined in the initializer",(function(){var a=t.generate(["{ function f() { return 42; } }","start = !{ return f() !== 42; }"].join("\n"),e);r(a).to.parse("")}))})),describe("available variables & functions",(function(){it("|options| contains options",(function(){var a=t.generate(["{ var result; }","start = !{ result = options; return false; } { return result; }"].join("\n"),e);r(a).to.parse("",{a:42},{a:42})})),it("|location| returns current location info",(function(){var a=t.generate(["{ var result; }","start = line (nl+ line)* { return result; }","line = thing (' '+ thing)*","thing = digit / mark","digit = [0-9]","mark = !{ result = location(); return false; } 'x'","nl = '\\r'? '\\n'"].join("\n"),e);r(a).to.parse("1\n2\n\n3\n\n\n4 5 x",{source:void 0,start:{offset:13,line:7,column:5},end:{offset:13,line:7,column:5}}),r(a).to.parse("1\nx",{source:void 0,start:{offset:2,line:2,column:1},end:{offset:2,line:2,column:1}}),r(a).to.parse("1\r\nx",{source:void 0,start:{offset:3,line:2,column:1},end:{offset:3,line:2,column:1}})}))}))})),describe("group",(function(){describe("when the expression matches",(function(){it("returns its match result",(function(){var a=t.generate("start = ('a')",e);r(a).to.parse("a","a")}))})),describe("when the expression doesn't match",(function(){it("reports match failure",(function(){var a=t.generate("start = ('a')",e);r(a).to.failToParse("b")}))}))})),describe("optional",(function(){describe("when the expression matches",(function(){it("returns its match result",(function(){var a=t.generate("start = 'a'?",e);r(a).to.parse("a","a")}))})),describe("when the expression doesn't match",(function(){it("returns |null|",(function(){var a=t.generate("start = 'a'?",e);r(a).to.parse("",null)}))}))})),describe("zero or more",(function(){describe("when the expression matches zero or more times",(function(){it("returns an array of its match results",(function(){var a=t.generate("start = 'a'*",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("aaa",["a","a","a"])}))}))})),describe("one or more",(function(){describe("when the expression matches one or more times",(function(){it("returns an array of its match results",(function(){var a=t.generate("start = 'a'+",e);r(a).to.parse("a",["a"]),r(a).to.parse("aaa",["a","a","a"])}))})),describe("when the expression doesn't match",(function(){it("reports match failure",(function(){var a=t.generate("start = 'a'+",e);r(a).to.failToParse("")}))}))})),describe("repeated",(function(){function a(r){for(var a=[],o=1;o<=4;++o)for(var s=1;s<=4;++s)a[a.length]="start"+String(o)+s;var i=n(e);return i.allowedStartRules=a,t.generate(["start11 =         val:n1      x|"+r+"|      $.*","start12 =         val:n1 data:x|"+r+"|      $.*","start13 =         val:n1      x|"+r+"| rest:$.*","start14 =         val:n1 data:x|"+r+"| rest:$.*","start21 = .       val:n1      x|"+r+"|      $.*","start22 = .       val:n1 data:x|"+r+"|      $.*","start23 = .       val:n1      x|"+r+"| rest:$.*","start24 = .       val:n1 data:x|"+r+"| rest:$.*","start31 = a:.     val:n1      x|"+r+"|      $.*","start32 = a:.     val:n1 data:x|"+r+"|      $.*","start33 = a:.     val:n1      x|"+r+"| rest:$.*","start34 = a:.     val:n1 data:x|"+r+"| rest:$.*","start41 = a:. b:. val:n1      x|"+r+"|      $.*","start42 = a:. b:. val:n1 data:x|"+r+"|      $.*","start43 = a:. b:. val:n1      x|"+r+"| rest:$.*","start44 = a:. b:. val:n1 data:x|"+r+"| rest:$.*","n1 = n:$[0-9] { return parseInt(n, 10); }","x = '='"].join(";\n"),i)}describe("without delimiter",(function(){describe("with constant boundaries",(function(){it("| .. | matches correctly",(function(){var a=t.generate("start = 'a'|..|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("aa",["a","a"]),r(a).to.parse("aaa",["a","a","a"])})),it("|0.. | matches correctly",(function(){var a=t.generate("start = 'a'|0..|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("aa",["a","a"]),r(a).to.parse("aaa",["a","a","a"])})),it("|1.. | matches correctly",(function(){var a=t.generate("start = 'a'|1..|",e);r(a).to.failToParse(""),r(a).to.parse("a",["a"]),r(a).to.parse("aa",["a","a"]),r(a).to.parse("aaa",["a","a","a"])})),it("|2.. | matches correctly",(function(){var a=t.generate("start = 'a'|2..|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("aa",["a","a"]),r(a).to.parse("aaa",["a","a","a"])})),it("| ..1| matches correctly",(function(){var a=t.generate("start = 'a'|..1|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.failToParse("aa"),r(a).to.failToParse("aaa")})),it("| ..2| matches correctly",(function(){var a=t.generate("start = 'a'|..2|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("aa",["a","a"]),r(a).to.failToParse("aaa")})),it("|2..3| matches correctly",(function(){var a=t.generate("start = 'a'|2..3|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("aa",["a","a"]),r(a).to.parse("aaa",["a","a","a"]),r(a).to.failToParse("aaaa")})),it("|2..2| matches correctly",(function(){var a=t.generate("start = 'a'|2..2|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("aa",["a","a"]),r(a).to.failToParse("aaa")})),it("| 2  | matches correctly",(function(){var a=t.generate("start = 'a'|2|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("aa",["a","a"]),r(a).to.failToParse("aaa")})),it("|3..2| matches correctly",(function(){var a=t.generate("start = 'a'|3..2|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.failToParse("aa"),r(a).to.failToParse("aaa")})),it("does not consume input on failure",(function(){var a=t.generate("start = 'a'|3| / 'a'|2| { return 42; }",e);r(a).to.parse("aa",42)})),it("correctly pass external references to labels to repeated expression",(function(){var a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|..|",e);r(a).to.parse("abb",["a",[["b",void 0],["b",void 0]]]),a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|2..|",e),r(a).to.parse("abb",["a",[["b",void 0],["b",void 0]]]),a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|..3|",e),r(a).to.parse("abb",["a",[["b",void 0],["b",void 0]]]),a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|2..3|",e),r(a).to.parse("abb",["a",[["b",void 0],["b",void 0]]]),a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|2|",e),r(a).to.parse("abb",["a",[["b",void 0],["b",void 0]]])}))})),describe("with variable boundaries",(function(){it("|min..   | matches correctly",(function(){for(var e=a("val.."),t=1;t<=4;++t){var n={startRule:"start1"+t};r(e).to.failToParse("",void 0,n),r(e).to.parse("0",[0,[],""],n),r(e).to.parse("0==",[0,["=","="],""],n),r(e).to.failToParse("1",void 0,n),r(e).to.failToParse("2=",void 0,n),r(e).to.parse("2==",[2,["=","="],""],n),r(e).to.parse("2=====",[2,["=","=","=","=","="],""],n)}for(t=1;t<=4;++t)n={startRule:"start2"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,["=","="],""],n),r(e).to.failToParse("-1",void 0,n),r(e).to.failToParse("-2=",void 0,n),r(e).to.parse("-2==",["-",2,["=","="],""],n),r(e).to.parse("-2=====",["-",2,["=","=","=","=","="],""],n);for(t=1;t<=4;++t)n={startRule:"start3"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,["=","="],""],n),r(e).to.failToParse("-1",void 0,n),r(e).to.failToParse("-2=",void 0,n),r(e).to.parse("-2==",["-",2,["=","="],""],n),r(e).to.parse("-2=====",["-",2,["=","=","=","=","="],""],n);for(t=1;t<=4;++t)n={startRule:"start4"+t},r(e).to.failToParse("--",void 0,n),r(e).to.parse("--0",["-","-",0,[],""],n),r(e).to.parse("--0==",["-","-",0,["=","="],""],n),r(e).to.failToParse("--1",void 0,n),r(e).to.failToParse("--2=",void 0,n),r(e).to.parse("--2==",["-","-",2,["=","="],""],n),r(e).to.parse("--2=====",["-","-",2,["=","=","=","=","="],""],n)})),it("|   ..max| matches correctly",(function(){for(var e=a("..val"),t=1;t<=4;++t){var n={startRule:"start1"+t};r(e).to.failToParse("",void 0,n),r(e).to.parse("0",[0,[],""],n),r(e).to.parse("0==",[0,[],"=="],n),r(e).to.parse("3",[3,[],""],n),r(e).to.parse("3=",[3,["="],""],n),r(e).to.parse("3===",[3,["=","=","="],""],n),r(e).to.parse("3=====",[3,["=","=","="],"=="],n)}for(t=1;t<=4;++t)n={startRule:"start2"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.parse("-3",["-",3,[],""],n),r(e).to.parse("-3=",["-",3,["="],""],n),r(e).to.parse("-3===",["-",3,["=","=","="],""],n),r(e).to.parse("-3=====",["-",3,["=","=","="],"=="],n);for(t=1;t<=4;++t)n={startRule:"start3"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.parse("-3",["-",3,[],""],n),r(e).to.parse("-3=",["-",3,["="],""],n),r(e).to.parse("-3===",["-",3,["=","=","="],""],n),r(e).to.parse("-3=====",["-",3,["=","=","="],"=="],n);for(t=1;t<=4;++t)n={startRule:"start4"+t},r(e).to.failToParse("--",void 0,n),r(e).to.parse("--0",["-","-",0,[],""],n),r(e).to.parse("--0==",["-","-",0,[],"=="],n),r(e).to.parse("--3",["-","-",3,[],""],n),r(e).to.parse("--3=",["-","-",3,["="],""],n),r(e).to.parse("--3===",["-","-",3,["=","=","="],""],n),r(e).to.parse("--3=====",["-","-",3,["=","=","="],"=="],n)})),it("|min..max| matches correctly",(function(){for(var a=function(){for(var r=[],a=1;a<=4;++a)for(var o=1;o<=4;++o)r[r.length]="start"+String(a)+o;var s=n(e);return s.allowedStartRules=r,t.generate(["start11 =         min:n1 max:n1      .|min..max|      $.*","start12 =         min:n1 max:n1 data:.|min..max|      $.*","start13 =         min:n1 max:n1      .|min..max| rest:$.*","start14 =         min:n1 max:n1 data:.|min..max| rest:$.*","start21 = .       min:n1 max:n1      .|min..max|      $.*","start22 = .       min:n1 max:n1 data:.|min..max|      $.*","start23 = .       min:n1 max:n1      .|min..max| rest:$.*","start24 = .       min:n1 max:n1 data:.|min..max| rest:$.*","start31 = a:.     min:n1 max:n1      .|min..max|      $.*","start32 = a:.     min:n1 max:n1 data:.|min..max|      $.*","start33 = a:.     min:n1 max:n1      .|min..max| rest:$.*","start34 = a:.     min:n1 max:n1 data:.|min..max| rest:$.*","start41 = a:. b:. min:n1 max:n1      .|min..max|      $.*","start42 = a:. b:. min:n1 max:n1 data:.|min..max|      $.*","start43 = a:. b:. min:n1 max:n1      .|min..max| rest:$.*","start44 = a:. b:. min:n1 max:n1 data:.|min..max| rest:$.*","n1 = n:$[0-9] { return parseInt(n, 10); }"].join(";\n"),s)}(),o=1;o<=4;++o){var s={startRule:"start1"+o};r(a).to.failToParse("",void 0,s),r(a).to.parse("00",[0,0,[],""],s),r(a).to.parse("00==",[0,0,[],"=="],s),r(a).to.failToParse("23",void 0,s),r(a).to.failToParse("23=",void 0,s),r(a).to.parse("23==",[2,3,["=","="],""],s),r(a).to.parse("23===",[2,3,["=","=","="],""],s),r(a).to.parse("23=====",[2,3,["=","=","="],"=="],s)}for(o=1;o<=4;++o)s={startRule:"start2"+o},r(a).to.failToParse("-",void 0,s),r(a).to.parse("-00",["-",0,0,[],""],s),r(a).to.parse("-00==",["-",0,0,[],"=="],s),r(a).to.failToParse("-23",void 0,s),r(a).to.failToParse("-23=",void 0,s),r(a).to.parse("-23==",["-",2,3,["=","="],""],s),r(a).to.parse("-23===",["-",2,3,["=","=","="],""],s),r(a).to.parse("-23=====",["-",2,3,["=","=","="],"=="],s);for(o=1;o<=4;++o)s={startRule:"start3"+o},r(a).to.failToParse("-",void 0,s),r(a).to.parse("-00",["-",0,0,[],""],s),r(a).to.parse("-00==",["-",0,0,[],"=="],s),r(a).to.failToParse("-23",void 0,s),r(a).to.failToParse("-23=",void 0,s),r(a).to.parse("-23==",["-",2,3,["=","="],""],s),r(a).to.parse("-23===",["-",2,3,["=","=","="],""],s),r(a).to.parse("-23=====",["-",2,3,["=","=","="],"=="],s);for(o=1;o<=4;++o)s={startRule:"start4"+o},r(a).to.failToParse("--",void 0,s),r(a).to.parse("--00",["-","-",0,0,[],""],s),r(a).to.parse("--00==",["-","-",0,0,[],"=="],s),r(a).to.failToParse("--23",void 0,s),r(a).to.failToParse("--23=",void 0,s),r(a).to.parse("--23==",["-","-",2,3,["=","="],""],s),r(a).to.parse("--23===",["-","-",2,3,["=","=","="],""],s),r(a).to.parse("--23=====",["-","-",2,3,["=","=","="],"=="],s)})),it("|val..val| matches correctly",(function(){for(var e=a("val"),t=1;t<=4;++t){var n={startRule:"start1"+t};r(e).to.failToParse("",void 0,n),r(e).to.parse("0",[0,[],""],n),r(e).to.parse("0==",[0,[],"=="],n),r(e).to.failToParse("3",void 0,n),r(e).to.failToParse("3=",void 0,n),r(e).to.parse("3===",[3,["=","=","="],""],n),r(e).to.parse("3=====",[3,["=","=","="],"=="],n)}for(t=1;t<=4;++t)n={startRule:"start2"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.failToParse("-3",void 0,n),r(e).to.failToParse("-3=",void 0,n),r(e).to.parse("-3===",["-",3,["=","=","="],""],n),r(e).to.parse("-3=====",["-",3,["=","=","="],"=="],n);for(t=1;t<=4;++t)n={startRule:"start3"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.failToParse("-3",void 0,n),r(e).to.failToParse("-3=",void 0,n),r(e).to.parse("-3===",["-",3,["=","=","="],""],n),r(e).to.parse("-3=====",["-",3,["=","=","="],"=="],n);for(t=1;t<=4;++t)n={startRule:"start4"+t},r(e).to.failToParse("--",void 0,n),r(e).to.parse("--0",["-","-",0,[],""],n),r(e).to.parse("--0==",["-","-",0,[],"=="],n),r(e).to.failToParse("--3",void 0,n),r(e).to.failToParse("--3=",void 0,n),r(e).to.parse("--3===",["-","-",3,["=","=","="],""],n),r(e).to.parse("--3=====",["-","-",3,["=","=","="],"=="],n)})),it("| exact  | matches correctly",(function(){for(var e=a("val"),t=1;t<=4;++t){var n={startRule:"start1"+t};r(e).to.failToParse("",void 0,n),r(e).to.parse("0",[0,[],""],n),r(e).to.parse("0==",[0,[],"=="],n),r(e).to.failToParse("3",void 0,n),r(e).to.failToParse("3=",void 0,n),r(e).to.parse("3===",[3,["=","=","="],""],n),r(e).to.parse("3=====",[3,["=","=","="],"=="],n)}for(t=1;t<=4;++t)n={startRule:"start2"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.failToParse("-3",void 0,n),r(e).to.failToParse("-3=",void 0,n),r(e).to.parse("-3===",["-",3,["=","=","="],""],n),r(e).to.parse("-3=====",["-",3,["=","=","="],"=="],n);for(t=1;t<=4;++t)n={startRule:"start3"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.failToParse("-3",void 0,n),r(e).to.failToParse("-3=",void 0,n),r(e).to.parse("-3===",["-",3,["=","=","="],""],n),r(e).to.parse("-3=====",["-",3,["=","=","="],"=="],n);for(t=1;t<=4;++t)n={startRule:"start4"+t},r(e).to.failToParse("--",void 0,n),r(e).to.parse("--0",["-","-",0,[],""],n),r(e).to.parse("--0==",["-","-",0,[],"=="],n),r(e).to.failToParse("--3",void 0,n),r(e).to.failToParse("--3=",void 0,n),r(e).to.parse("--3===",["-","-",3,["=","=","="],""],n),r(e).to.parse("--3=====",["-","-",3,["=","=","="],"=="],n)}))})),describe("with function boundaries",(function(){it("|{min}..     | matches correctly",(function(){var a=t.generate("start = 'a'|{ return 2; }..|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("aa",["a","a"]),r(a).to.parse("aaa",["a","a","a"])})),it("|     ..{max}| matches correctly",(function(){var a=t.generate("start = 'a'|..{ return 2; }|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("aa",["a","a"]),r(a).to.failToParse("aaa")})),it("|{min}..{max}| matches correctly",(function(){var a=t.generate("start = 'a'|{ return 2; }..{ return 3; }|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("aa",["a","a"]),r(a).to.parse("aaa",["a","a","a"]),r(a).to.failToParse("aaaa")})),it("|{val}..{val}| matches correctly",(function(){var a=t.generate("start = 'a'|{ return 2; }..{ return 2; }|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("aa",["a","a"]),r(a).to.failToParse("aaa")})),it("|  {exact}   | matches correctly",(function(){var a=t.generate("start = 'a'|{ return 2; }|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("aa",["a","a"]),r(a).to.failToParse("aaa")})),describe("function called only once",(function(){it("in |{min}..     |",(function(){var a=t.generate("\n                { let min = 0; }\n                start = 'a'|{ ++min; return 2; }..| { return min; }\n              ",e);r(a).to.parse("aa",1),r(a).to.parse("aaa",1)})),it("in |     ..{max}|",(function(){var a=t.generate("\n                { let max = 0; }\n                start = 'a'|..{ ++max; return 3; }| { return max; }\n              ",e);r(a).to.parse("aa",1),r(a).to.parse("aaa",1)})),it("in |{min}..{max}|",(function(){var a=t.generate("\n                {\n                  let min = 0;\n                  let max = 0;\n                }\n                start = 'a'|\n                  { ++min; return 0; }\n                  ..\n                  { ++max; return 3; }\n                | { return [min, max]; }\n              ",e);r(a).to.parse("",[1,1]),r(a).to.parse("a",[1,1]),r(a).to.parse("aa",[1,1]),r(a).to.parse("aaa",[1,1])})),it("in |  {exact}   |",(function(){var a=t.generate("\n                { let count = 0; }\n                start = 'a'|{ ++count; return options.exact; }| { return count; }\n              ",e);r(a).to.parse("",1,{exact:0}),r(a).to.parse("aa",1,{exact:2})}))})),it("correctly pass external references to labels to boundary expression",(function(){var a=t.generate("start = ref:'a' 'b'|{ return ref === 'a' ? 2 : 0; }..|",e);r(a).to.parse("abb",["a",["b","b"]]),a=t.generate("start = ref:'a' 'b'|..{ return ref === 'a' ? 3 : 0; }|",e),r(a).to.parse("abb",["a",["b","b"]]),a=t.generate("start = ref:'a' 'b'|{ return ref === 'a' ? 2 : 0; }..{ return ref === 'a' ? 3 : 0; }|",e),r(a).to.parse("abb",["a",["b","b"]]),a=t.generate("start = ref:'a' 'b'|{ return ref === 'a' ? 2 : 0; }|",e),r(a).to.parse("abb",["a",["b","b"]])}))})),it("with functions returning non-integers",(function(){var a=t.generate("start = 'a'|{ return 'a' }|",e);r(a).to.parse("",[]),r(a).to.failToParse("aaa",{expected:[{type:"end"}]}),a=t.generate("start = 'a'|{ return 'a' }..2|",e),r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("aa",["a","a"]),r(a).to.failToParse("aaa",{expected:[{type:"end"}]}),a=t.generate("start = 'a'|..{ return 'a' }|",e),r(a).to.parse("",[]),r(a).to.failToParse("a",{expected:[{type:"end"}]}),a=t.generate("start = 'a'|{return '1.8e0' }..{ return 2.8 }|",e),r(a).to.parse("a",["a"]),r(a).to.parse("aa",["a","a"]),r(a).to.failToParse("aaa",{expected:[{type:"end"}]})}))})),describe("with delimiter",(function(){describe("with constant boundaries",(function(){it("| .. , delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|.., '~'|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("a~a",["a","a"]),r(a).to.parse("a~a~a",["a","a","a"])})),it("|0.. , delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|0.., '~'|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("a~a",["a","a"]),r(a).to.parse("a~a~a",["a","a","a"])})),it("|1.. , delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|1.., '~'|",e);r(a).to.failToParse(""),r(a).to.parse("a",["a"]),r(a).to.parse("a~a",["a","a"]),r(a).to.parse("a~a~a",["a","a","a"])})),it("|2.. , delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|2.., '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("a~a",["a","a"]),r(a).to.parse("a~a~a",["a","a","a"])})),it("| ..1, delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|..1, '~'|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.failToParse("a~a"),r(a).to.failToParse("a~a~a")})),it("| ..2, delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|..2, '~'|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("a~a",["a","a"]),r(a).to.failToParse("a~a~a")})),it("|2..3, delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|2..3, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("a~a",["a","a"]),r(a).to.parse("a~a~a",["a","a","a"]),r(a).to.failToParse("a~a~a~a")})),it("|2..2, delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|2..2, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("a~a",["a","a"]),r(a).to.failToParse("a~a~a")})),it("|2   , delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|2, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("a~a",["a","a"]),r(a).to.failToParse("a~a~a")})),it("|3..2, delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|3..2, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.failToParse("a~a"),r(a).to.failToParse("a~a~a")})),it("correctly pass external references to labels to repeated expression",(function(){var a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|.., ' '|",e);r(a).to.parse("ab b",["a",[["b",void 0],["b",void 0]]]),a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|2.., ' '|",e),r(a).to.parse("ab b",["a",[["b",void 0],["b",void 0]]]),a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|..3, ' '|",e),r(a).to.parse("ab b",["a",[["b",void 0],["b",void 0]]]),a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|2..3, ' '|",e),r(a).to.parse("ab b",["a",[["b",void 0],["b",void 0]]]),a=t.generate("start = ref:'a' ('b' &{ return ref === 'a'; })|2, ' '|",e),r(a).to.parse("ab b",["a",[["b",void 0],["b",void 0]]]),a=t.generate("start = ref:'a' 'b'|{ return ref === 'a' ? 2 : 0; }, ' '|",e),r(a).to.parse("ab b",["a",["b","b"]])}))})),describe("with variable boundaries",(function(){it("|min..   , delimiter| matches correctly",(function(){for(var e=a("val.., '~'"),t=1;t<=4;++t){var n={startRule:"start1"+t};r(e).to.failToParse("",void 0,n),r(e).to.parse("0",[0,[],""],n),r(e).to.parse("0==",[0,["="],"="],n),r(e).to.parse("0=~=",[0,["=","="],""],n),r(e).to.failToParse("1",void 0,n),r(e).to.failToParse("1~",void 0,n),r(e).to.failToParse("2=",void 0,n),r(e).to.failToParse("2=~",void 0,n),r(e).to.failToParse("2==",void 0,n),r(e).to.parse("2=~=",[2,["=","="],""],n),r(e).to.parse("2=~=~",[2,["=","="],"~"],n),r(e).to.parse("2=~=~=~=~=",[2,["=","=","=","=","="],""],n)}for(t=1;t<=4;++t)n={startRule:"start2"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,["="],"="],n),r(e).to.parse("-0=~=",["-",0,["=","="],""],n),r(e).to.failToParse("-1",void 0,n),r(e).to.failToParse("-1~",void 0,n),r(e).to.failToParse("-2=",void 0,n),r(e).to.failToParse("-2=~",void 0,n),r(e).to.failToParse("-2==",void 0,n),r(e).to.parse("-2=~=",["-",2,["=","="],""],n),r(e).to.parse("-2=~=~",["-",2,["=","="],"~"],n),r(e).to.parse("-2=~=~=~=~=",["-",2,["=","=","=","=","="],""],n);for(t=1;t<=4;++t)n={startRule:"start3"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,["="],"="],n),r(e).to.parse("-0=~=",["-",0,["=","="],""],n),r(e).to.failToParse("-1",void 0,n),r(e).to.failToParse("-1~",void 0,n),r(e).to.failToParse("-2=",void 0,n),r(e).to.failToParse("-2=~",void 0,n),r(e).to.failToParse("-2==",void 0,n),r(e).to.parse("-2=~=",["-",2,["=","="],""],n),r(e).to.parse("-2=~=~",["-",2,["=","="],"~"],n),r(e).to.parse("-2=~=~=~=~=",["-",2,["=","=","=","=","="],""],n);for(t=1;t<=4;++t)n={startRule:"start4"+t},r(e).to.failToParse("--",void 0,n),r(e).to.parse("--0",["-","-",0,[],""],n),r(e).to.parse("--0==",["-","-",0,["="],"="],n),r(e).to.parse("--0=~=",["-","-",0,["=","="],""],n),r(e).to.failToParse("--1",void 0,n),r(e).to.failToParse("--1~",void 0,n),r(e).to.failToParse("--2=",void 0,n),r(e).to.failToParse("--2=~",void 0,n),r(e).to.failToParse("--2==",void 0,n),r(e).to.parse("--2=~=",["-","-",2,["=","="],""],n),r(e).to.parse("--2=~=~",["-","-",2,["=","="],"~"],n),r(e).to.parse("--2=~=~=~=~=",["-","-",2,["=","=","=","=","="],""],n)})),it("|   ..max, delimiter| matches correctly",(function(){for(var e=a("..val, '~'"),t=1;t<=4;++t){var n={startRule:"start1"+t};r(e).to.failToParse("",void 0,n),r(e).to.parse("0",[0,[],""],n),r(e).to.parse("0==",[0,[],"=="],n),r(e).to.parse("0=~=",[0,[],"=~="],n),r(e).to.parse("3",[3,[],""],n),r(e).to.parse("3=",[3,["="],""],n),r(e).to.parse("3===",[3,["="],"=="],n),r(e).to.parse("3=~=~",[3,["=","="],"~"],n),r(e).to.parse("3=~=~=",[3,["=","=","="],""],n),r(e).to.parse("3=~=~=~=~=",[3,["=","=","="],"~=~="],n)}for(t=1;t<=4;++t)n={startRule:"start2"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.parse("-0=~=",["-",0,[],"=~="],n),r(e).to.parse("-3",["-",3,[],""],n),r(e).to.parse("-3=",["-",3,["="],""],n),r(e).to.parse("-3===",["-",3,["="],"=="],n),r(e).to.parse("-3=~=~",["-",3,["=","="],"~"],n),r(e).to.parse("-3=~=~=",["-",3,["=","=","="],""],n),r(e).to.parse("-3=~=~=~=~=",["-",3,["=","=","="],"~=~="],n);for(t=1;t<=4;++t)n={startRule:"start3"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.parse("-0=~=",["-",0,[],"=~="],n),r(e).to.parse("-3",["-",3,[],""],n),r(e).to.parse("-3=",["-",3,["="],""],n),r(e).to.parse("-3===",["-",3,["="],"=="],n),r(e).to.parse("-3=~=~",["-",3,["=","="],"~"],n),r(e).to.parse("-3=~=~=",["-",3,["=","=","="],""],n),r(e).to.parse("-3=~=~=~=~=",["-",3,["=","=","="],"~=~="],n);for(t=1;t<=4;++t)n={startRule:"start4"+t},r(e).to.failToParse("--",void 0,n),r(e).to.parse("--0",["-","-",0,[],""],n),r(e).to.parse("--0==",["-","-",0,[],"=="],n),r(e).to.parse("--0=~=",["-","-",0,[],"=~="],n),r(e).to.parse("--3",["-","-",3,[],""],n),r(e).to.parse("--3=",["-","-",3,["="],""],n),r(e).to.parse("--3===",["-","-",3,["="],"=="],n),r(e).to.parse("--3=~=~",["-","-",3,["=","="],"~"],n),r(e).to.parse("--3=~=~=",["-","-",3,["=","=","="],""],n),r(e).to.parse("--3=~=~=~=~=",["-","-",3,["=","=","="],"~=~="],n)})),it("|min..max, delimiter| matches correctly",(function(){for(var a=function(){for(var r=[],a=1;a<=4;++a)for(var o=1;o<=4;++o)r[r.length]="start"+String(a)+o;var s=n(e);return s.allowedStartRules=r,t.generate(["start11 =         min:n1 max:n1      .|min..max, '~'|      $.*","start12 =         min:n1 max:n1 data:.|min..max, '~'|      $.*","start13 =         min:n1 max:n1      .|min..max, '~'| rest:$.*","start14 =         min:n1 max:n1 data:.|min..max, '~'| rest:$.*","start21 = .       min:n1 max:n1      .|min..max, '~'|      $.*","start22 = .       min:n1 max:n1 data:.|min..max, '~'|      $.*","start23 = .       min:n1 max:n1      .|min..max, '~'| rest:$.*","start24 = .       min:n1 max:n1 data:.|min..max, '~'| rest:$.*","start31 = a:.     min:n1 max:n1      .|min..max, '~'|      $.*","start32 = a:.     min:n1 max:n1 data:.|min..max, '~'|      $.*","start33 = a:.     min:n1 max:n1      .|min..max, '~'| rest:$.*","start34 = a:.     min:n1 max:n1 data:.|min..max, '~'| rest:$.*","start41 = a:. b:. min:n1 max:n1      .|min..max, '~'|      $.*","start42 = a:. b:. min:n1 max:n1 data:.|min..max, '~'|      $.*","start43 = a:. b:. min:n1 max:n1      .|min..max, '~'| rest:$.*","start44 = a:. b:. min:n1 max:n1 data:.|min..max, '~'| rest:$.*","n1 = n:$[0-9] { return parseInt(n, 10); }"].join(";\n"),s)}(),o=1;o<=4;++o){var s={startRule:"start1"+o};r(a).to.failToParse("",void 0,s),r(a).to.parse("00",[0,0,[],""],s),r(a).to.parse("00==",[0,0,[],"=="],s),r(a).to.parse("00=~=",[0,0,[],"=~="],s),r(a).to.failToParse("23",void 0,s),r(a).to.failToParse("23=",void 0,s),r(a).to.failToParse("23=~",void 0,s),r(a).to.failToParse("23==",void 0,s),r(a).to.parse("23=~=",[2,3,["=","="],""],s),r(a).to.parse("23=~=~",[2,3,["=","="],"~"],s),r(a).to.parse("23=~=~=",[2,3,["=","=","="],""],s),r(a).to.parse("23=~=~=~=~=",[2,3,["=","=","="],"~=~="],s)}for(o=1;o<=4;++o)s={startRule:"start2"+o},r(a).to.failToParse("-",void 0,s),r(a).to.parse("-00",["-",0,0,[],""],s),r(a).to.parse("-00==",["-",0,0,[],"=="],s),r(a).to.parse("-00=~=",["-",0,0,[],"=~="],s),r(a).to.failToParse("-23",void 0,s),r(a).to.failToParse("-23=",void 0,s),r(a).to.failToParse("-23=~",void 0,s),r(a).to.failToParse("-23==",void 0,s),r(a).to.parse("-23=~=",["-",2,3,["=","="],""],s),r(a).to.parse("-23=~=~",["-",2,3,["=","="],"~"],s),r(a).to.parse("-23=~=~=",["-",2,3,["=","=","="],""],s),r(a).to.parse("-23=~=~=~=~=",["-",2,3,["=","=","="],"~=~="],s);for(o=1;o<=4;++o)s={startRule:"start3"+o},r(a).to.failToParse("-",void 0,s),r(a).to.parse("-00",["-",0,0,[],""],s),r(a).to.parse("-00==",["-",0,0,[],"=="],s),r(a).to.parse("-00=~=",["-",0,0,[],"=~="],s),r(a).to.failToParse("-23",void 0,s),r(a).to.failToParse("-23=",void 0,s),r(a).to.failToParse("-23=~",void 0,s),r(a).to.failToParse("-23==",void 0,s),r(a).to.parse("-23=~=",["-",2,3,["=","="],""],s),r(a).to.parse("-23=~=~",["-",2,3,["=","="],"~"],s),r(a).to.parse("-23=~=~=",["-",2,3,["=","=","="],""],s),r(a).to.parse("-23=~=~=~=~=",["-",2,3,["=","=","="],"~=~="],s);for(o=1;o<=4;++o)s={startRule:"start4"+o},r(a).to.failToParse("--",void 0,s),r(a).to.parse("--00",["-","-",0,0,[],""],s),r(a).to.parse("--00==",["-","-",0,0,[],"=="],s),r(a).to.parse("--00=~=",["-","-",0,0,[],"=~="],s),r(a).to.failToParse("--23",void 0,s),r(a).to.failToParse("--23=",void 0,s),r(a).to.failToParse("--23=~",void 0,s),r(a).to.failToParse("--23==",void 0,s),r(a).to.parse("--23=~=",["-","-",2,3,["=","="],""],s),r(a).to.parse("--23=~=~",["-","-",2,3,["=","="],"~"],s),r(a).to.parse("--23=~=~=",["-","-",2,3,["=","=","="],""],s),r(a).to.parse("--23=~=~=~=~=",["-","-",2,3,["=","=","="],"~=~="],s)})),it("|val..val, delimiter| matches correctly",(function(){for(var e=a("val, '~'"),t=1;t<=4;++t){var n={startRule:"start1"+t};r(e).to.failToParse("",void 0,n),r(e).to.parse("0",[0,[],""],n),r(e).to.parse("0==",[0,[],"=="],n),r(e).to.parse("0=~=",[0,[],"=~="],n),r(e).to.failToParse("3",void 0,n),r(e).to.failToParse("3=",void 0,n),r(e).to.failToParse("3=~",void 0,n),r(e).to.parse("3=~=~=",[3,["=","=","="],""],n),r(e).to.parse("3=~=~=~",[3,["=","=","="],"~"],n),r(e).to.parse("3=~=~=~=~=",[3,["=","=","="],"~=~="],n)}for(t=1;t<=4;++t)n={startRule:"start2"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.parse("-0=~=",["-",0,[],"=~="],n),r(e).to.failToParse("-3",void 0,n),r(e).to.failToParse("-3=",void 0,n),r(e).to.failToParse("-3=~",void 0,n),r(e).to.parse("-3=~=~=",["-",3,["=","=","="],""],n),r(e).to.parse("-3=~=~=~",["-",3,["=","=","="],"~"],n),r(e).to.parse("-3=~=~=~=~=",["-",3,["=","=","="],"~=~="],n);for(t=1;t<=4;++t)n={startRule:"start3"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.parse("-0=~=",["-",0,[],"=~="],n),r(e).to.failToParse("-3",void 0,n),r(e).to.failToParse("-3=",void 0,n),r(e).to.failToParse("-3=~",void 0,n),r(e).to.parse("-3=~=~=",["-",3,["=","=","="],""],n),r(e).to.parse("-3=~=~=~",["-",3,["=","=","="],"~"],n),r(e).to.parse("-3=~=~=~=~=",["-",3,["=","=","="],"~=~="],n);for(t=1;t<=4;++t)n={startRule:"start4"+t},r(e).to.failToParse("--",void 0,n),r(e).to.parse("--0",["-","-",0,[],""],n),r(e).to.parse("--0==",["-","-",0,[],"=="],n),r(e).to.parse("--0=~=",["-","-",0,[],"=~="],n),r(e).to.failToParse("--3",void 0,n),r(e).to.failToParse("--3=",void 0,n),r(e).to.failToParse("--3=~",void 0,n),r(e).to.parse("--3=~=~=",["-","-",3,["=","=","="],""],n),r(e).to.parse("--3=~=~=~",["-","-",3,["=","=","="],"~"],n),r(e).to.parse("--3=~=~=~=~=",["-","-",3,["=","=","="],"~=~="],n)})),it("| exact  , delimiter| matches correctly",(function(){for(var e=a("val, '~'"),t=1;t<=4;++t){var n={startRule:"start1"+t};r(e).to.failToParse("",void 0,n),r(e).to.parse("0",[0,[],""],n),r(e).to.parse("0==",[0,[],"=="],n),r(e).to.parse("0=~=",[0,[],"=~="],n),r(e).to.failToParse("3",void 0,n),r(e).to.failToParse("3=",void 0,n),r(e).to.failToParse("3=~",void 0,n),r(e).to.parse("3=~=~=",[3,["=","=","="],""],n),r(e).to.parse("3=~=~=~",[3,["=","=","="],"~"],n),r(e).to.parse("3=~=~=~=~=",[3,["=","=","="],"~=~="],n)}for(t=1;t<=4;++t)n={startRule:"start2"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.parse("-0=~=",["-",0,[],"=~="],n),r(e).to.failToParse("-3",void 0,n),r(e).to.failToParse("-3=",void 0,n),r(e).to.failToParse("-3=~",void 0,n),r(e).to.parse("-3=~=~=",["-",3,["=","=","="],""],n),r(e).to.parse("-3=~=~=~",["-",3,["=","=","="],"~"],n),r(e).to.parse("-3=~=~=~=~=",["-",3,["=","=","="],"~=~="],n);for(t=1;t<=4;++t)n={startRule:"start3"+t},r(e).to.failToParse("-",void 0,n),r(e).to.parse("-0",["-",0,[],""],n),r(e).to.parse("-0==",["-",0,[],"=="],n),r(e).to.parse("-0=~=",["-",0,[],"=~="],n),r(e).to.failToParse("-3",void 0,n),r(e).to.failToParse("-3=",void 0,n),r(e).to.failToParse("-3=~",void 0,n),r(e).to.parse("-3=~=~=",["-",3,["=","=","="],""],n),r(e).to.parse("-3=~=~=~",["-",3,["=","=","="],"~"],n),r(e).to.parse("-3=~=~=~=~=",["-",3,["=","=","="],"~=~="],n);for(t=1;t<=4;++t)n={startRule:"start4"+t},r(e).to.failToParse("--",void 0,n),r(e).to.parse("--0",["-","-",0,[],""],n),r(e).to.parse("--0==",["-","-",0,[],"=="],n),r(e).to.parse("--0=~=",["-","-",0,[],"=~="],n),r(e).to.failToParse("--3",void 0,n),r(e).to.failToParse("--3=",void 0,n),r(e).to.failToParse("--3=~",void 0,n),r(e).to.parse("--3=~=~=",["-","-",3,["=","=","="],""],n),r(e).to.parse("--3=~=~=~",["-","-",3,["=","=","="],"~"],n),r(e).to.parse("--3=~=~=~=~=",["-","-",3,["=","=","="],"~=~="],n)}))})),describe("with function boundaries",(function(){it("|{2}..   , delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|{ return 2; }.., '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("a~a",["a","a"]),r(a).to.parse("a~a~a",["a","a","a"])})),it("|   ..{2}, delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|..{ return 2; }, '~'|",e);r(a).to.parse("",[]),r(a).to.parse("a",["a"]),r(a).to.parse("a~a",["a","a"]),r(a).to.failToParse("a~a~a")})),it("|{2}..{3}, delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|{ return 2; }..{ return 3; }, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("a~a",["a","a"]),r(a).to.parse("a~a~a",["a","a","a"]),r(a).to.failToParse("a~a~a~a")})),it("|{2}..{2}, delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|{ return 2; }..{ return 2; }, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("a~a",["a","a"]),r(a).to.failToParse("a~a~a")})),it("|{2}     , delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|{ return 2; }, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.parse("a~a",["a","a"]),r(a).to.failToParse("a~a~a")})),it("|{3}..{2}, delimiter| matches correctly",(function(){var a=t.generate("start = 'a'|{ return 3; }..{ return 2; }, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.failToParse("a~a"),r(a).to.failToParse("a~a~a")})),it("correctly pass external references to labels to boundary expression",(function(){var a=t.generate("start = ref:'a' 'b'|{ return ref === 'a' ? 2 : 0; }.., ' '|",e);r(a).to.parse("ab b",["a",["b","b"]]),a=t.generate("start = ref:'a' 'b'|..{ return ref === 'a' ? 3 : 0; }, ' '|",e),r(a).to.parse("ab b",["a",["b","b"]]),a=t.generate("start = ref:'a' 'b'|{ return ref === 'a' ? 2 : 0; }..{ return ref === 'a' ? 3 : 0; }, ' '|",e),r(a).to.parse("ab b",["a",["b","b"]]),a=t.generate("start = ref:'a' 'b'|{ return ref === 'a' ? 2 : 0; }, ' '|",e),r(a).to.parse("ab b",["a",["b","b"]])}))}))})),describe("handle delimiter correctly",(function(){it("with constant boundaries",(function(){var a=t.generate("start = 'a'|2..3, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.failToParse("aa"),r(a).to.failToParse("a~"),r(a).to.parse("a~a",["a","a"]),r(a).to.failToParse("a~a~"),r(a).to.parse("a~a~a",["a","a","a"]),r(a).to.failToParse("a~a~a~"),r(a).to.failToParse("a~a~a~a")})),it("with variable boundaries",(function(){var a=t.generate(["start = min:n1 max:n1 'a'|min..max, '~'|","n1 = n:$[0-9] { return parseInt(n, 10); }"].join(";\n"),e);r(a).to.failToParse("23"),r(a).to.failToParse("23a"),r(a).to.failToParse("23aa"),r(a).to.failToParse("23a~"),r(a).to.parse("23a~a",[2,3,["a","a"]]),r(a).to.failToParse("23a~a~"),r(a).to.parse("23a~a~a",[2,3,["a","a","a"]]),r(a).to.failToParse("23a~a~a~"),r(a).to.failToParse("23a~a~a~a")})),it("with variable boundaries in delimiter",(function(){var a=t.generate(["start = min:n1 max:n1 'a'|2, '~'|min..max||","n1 = n:$[0-9] { return parseInt(n, 10); }"].join(";\n"),e);r(a).to.failToParse("23"),r(a).to.failToParse("23a"),r(a).to.failToParse("23aa"),r(a).to.failToParse("23a~"),r(a).to.failToParse("23a~a"),r(a).to.failToParse("23a~~"),r(a).to.parse("23a~~a",[2,3,["a","a"]]),r(a).to.parse("23a~~~a",[2,3,["a","a"]]),r(a).to.failToParse("23a~~~~a"),r(a).to.failToParse("23a~~a~~a")})),it("with function boundaries",(function(){var a=t.generate("start = 'a'|{ return 2; }..{ return 3; }, '~'|",e);r(a).to.failToParse(""),r(a).to.failToParse("a"),r(a).to.failToParse("aa"),r(a).to.failToParse("a~"),r(a).to.parse("a~a",["a","a"]),r(a).to.failToParse("a~a~"),r(a).to.parse("a~a~a",["a","a","a"]),r(a).to.failToParse("a~a~a~"),r(a).to.failToParse("a~a~a~a")}))}))})),describe("text",(function(){describe("when the expression matches",(function(){it("returns the matched text",(function(){var a=t.generate("start = $('a' 'b' 'c')",e);r(a).to.parse("abc","abc")}))})),describe("when the expression doesn't match",(function(){it("reports match failure",(function(){var a=t.generate("start = $('a')",e);r(a).to.failToParse("b")}))}))})),describe("positive simple predicate",(function(){describe("when the expression matches",(function(){it("returns |undefined|",(function(){var a=t.generate("start = &'a' 'a'",e);r(a).to.parse("a",[void 0,"a"])})),it("resets parse position",(function(){var a=t.generate("start = &'a' 'a'",e);r(a).to.parse("a")}))})),describe("when the expression doesn't match",(function(){it("reports match failure",(function(){var a=t.generate("start = &'a'",e);r(a).to.failToParse("b")})),it("discards any expectations recorded when matching the expression",(function(){var a=t.generate("start = 'a' / &'b' / 'c'",e);r(a).to.failToParse("d",{expected:[{type:"literal",text:"a",ignoreCase:!1},{type:"literal",text:"c",ignoreCase:!1}]})}))}))})),describe("negative simple predicate",(function(){describe("when the expression matches",(function(){it("reports match failure",(function(){var a=t.generate("start = !'a'",e);r(a).to.failToParse("a")}))})),describe("when the expression doesn't match",(function(){it("returns |undefined|",(function(){var a=t.generate("start = !'a' 'b'",e);r(a).to.parse("b",[void 0,"b"])})),it("resets parse position",(function(){var a=t.generate("start = !'a' 'b'",e);r(a).to.parse("b")})),it("discards any expectations recorded when matching the expression",(function(){var a=t.generate("start = 'a' / !'b' / 'c'",e);r(a).to.failToParse("b",{expected:[{type:"literal",text:"a",ignoreCase:!1},{type:"literal",text:"c",ignoreCase:!1}]})}))}))})),describe("label",(function(){describe("when the expression matches",(function(){it("returns its match result",(function(){var a=t.generate("start = a:'a'",e);r(a).to.parse("a","a")}))})),describe("when the expression doesn't match",(function(){it("reports match failure",(function(){var a=t.generate("start = a:'a'",e);r(a).to.failToParse("b")}))}))})),describe("sequence",(function(){describe("when all expressions match",(function(){it("returns an array of their match results",(function(){var a=t.generate("start = 'a' 'b' 'c'",e);r(a).to.parse("abc",["a","b","c"])})),it("plucks a single value",(function(){var a=t.generate("start = @'a'",e);r(a).to.parse("a","a"),a=t.generate("start = @'a' / @'b'",e),r(a).to.parse("a","a"),r(a).to.parse("b","b"),a=t.generate("start = 'a' @'b' 'c'",e),r(a).to.parse("abc","b"),a=t.generate("start = 'a' ( @'b' 'c' )",e),r(a).to.parse("abc",["a","b"]),a=t.generate("start = 'a' @( 'b' @'c' 'd' )",e),r(a).to.parse("abcd","c"),a=t.generate("start = 'a' ( @'b' 'c' ) @'d'",e),r(a).to.parse("abcd","d"),a=t.generate("start = 'a' @'b' 'c' / 'd' 'e' @'f'",e),r(a).to.parse("def","f")})),it("plucks a multiple values",(function(){var a=t.generate("start = 'a' @'b' @'c'",e);r(a).to.parse("abc",["b","c"]),a=t.generate("start = 'a' ( @'b' @'c' )",e),r(a).to.parse("abc",["a",["b","c"]]),a=t.generate("start = 'a' @( 'b' @'c' @'d' )",e),r(a).to.parse("abcd",["c","d"]),a=t.generate("start = 'a' @( @'b' 'c' ) @'d' 'e'",e),r(a).to.parse("abcde",["b","d"]),a=t.generate("start = 'a' @'b' 'c' / @'d' 'e' @'f'",e),r(a).to.parse("def",["d","f"])})),it('prevents "@" on a semantic predicate',(function(){r((function(){return t.generate("start1 = 'a' @&{ /* semantic_and */ } 'c'")}),e).to.throw(),r((function(){return t.generate("start2 = 'a' @!{ /* semantic_not */ } 'c'")}),e).to.throw()}))})),describe("when any expression doesn't match",(function(){it("reports match failure",(function(){var a=t.generate("start = 'a' 'b' 'c'",e);r(a).to.failToParse("dbc"),r(a).to.failToParse("adc"),r(a).to.failToParse("abd")})),it("resets parse position",(function(){var a=t.generate("start = 'a' 'b' / 'a'",e);r(a).to.parse("a","a")}))}))})),describe("action",(function(){describe("when the expression matches",(function(){it("returns the value returned by the code",(function(){var a=t.generate("start = 'a' { return 42; }",e);r(a).to.parse("a",42)})),describe("label variables",(function(){describe("in the expression",(function(){it("can access variable defined by labeled expression",(function(){var a=t.generate("start = a:'a' { return a; }",e);r(a).to.parse("a","a")})),it("can access variables defined by labeled sequence elements",(function(){var a=t.generate("start = a:'a' b:'b' c:'c' { return [a, b, c]; }",e);r(a).to.parse("abc",["a","b","c"])})),it("cannot access variables defined by subexpressions",(function(){[{grammar:"start = (a:'a') { return a; }",input:"a"},{grammar:"start = (a:'a')? { return a; }",input:"a"},{grammar:"start = (a:'a')* { return a; }",input:"a"},{grammar:"start = (a:'a')+ { return a; }",input:"a"},{grammar:"start = (a:'a')| .. | { return a; }",input:"a"},{grammar:"start = (a:'a')|0.. | { return a; }",input:"a"},{grammar:"start = (a:'a')|1.. | { return a; }",input:"a"},{grammar:"start = (a:'a')|2.. | { return a; }",input:"aa"},{grammar:"start = (a:'a')| ..1| { return a; }",input:"a"},{grammar:"start = (a:'a')| ..3| { return a; }",input:"a"},{grammar:"start = (a:'a')|2..3| { return a; }",input:"aa"},{grammar:"start = (a:'a')|3| { return a; }",input:"aaa"},{grammar:"start = $(a:'a') { return a; }",input:"a"},{grammar:"start = &(a:'a') 'a' { return a; }",input:"a"},{grammar:"start = !(a:'a') 'b' { return a; }",input:"b"},{grammar:"start = b:(a:'a') { return a; }",input:"a"},{grammar:"start = ('a' b:'b' 'c') { return b; }",input:"abc"},{grammar:"start = (a:'a' { return a; }) { return a; }",input:"a"},{grammar:"start = ('a' / b:'b' / 'c') { return b; }",input:"b"}].forEach((function(a){var n=t.generate(a.grammar,e);r(n).to.failToParse(a.input)}))}))})),describe("in outer sequence",(function(){it("can access variables defined by preceding labeled elements",(function(){var a=t.generate("start = a:'a' ('b' { return a; })",e);r(a).to.parse("ab",["a","a"])})),it("cannot access variable defined by labeled action element",(function(){var a=t.generate("start = 'a' b:('b' { return b; }) c:'c'",e);r(a).to.failToParse("abc")})),it("cannot access variables defined by following labeled elements",(function(){var a=t.generate("start = ('a' { return b; }) b:'b'",e);r(a).to.failToParse("ab")}))}))})),describe("initializer variables & functions",(function(){it("can access variables defined in the initializer",(function(){var a=t.generate(["{ var v = 42 }","start = 'a' { return v; }"].join("\n"),e);r(a).to.parse("a",42)})),it("can access functions defined in the initializer",(function(){var a=t.generate(["{ function f() { return 42; } }","start = 'a' { return f(); }"].join("\n"),e);r(a).to.parse("a",42)}))})),describe("available variables & functions",(function(){it("|options| contains options",(function(){var a=t.generate("start = 'a' { return options; }",e);r(a).to.parse("a",{a:42},{a:42})})),it("|text| returns text matched by the expression",(function(){var a=t.generate("start = 'a' { return text(); }",e);r(a).to.parse("a","a")})),it("|location| returns location info of the expression",(function(){var a=t.generate(["{ var result; }","start = line (nl+ line)* { return result; }","line = thing (' '+ thing)*","thing = digit / mark","digit = [0-9]","mark = 'x' { result = location(); }","nl = '\\r'? '\\n'"].join("\n"),e);r(a).to.parse("1\n2\n\n3\n\n\n4 5 x",{source:void 0,start:{offset:13,line:7,column:5},end:{offset:14,line:7,column:6}}),r(a).to.parse("1\nx",{source:void 0,start:{offset:2,line:2,column:1},end:{offset:3,line:2,column:2}}),r(a).to.parse("1\r\nx",{source:void 0,start:{offset:3,line:2,column:1},end:{offset:4,line:2,column:2}})})),describe("|expected|",(function(){it("terminates parsing and throws an exception",(function(){var a=t.generate("start = 'a' { expected('a'); }",e);r(a).to.failToParse("a",{message:'Expected a but "a" found.',expected:[{type:"other",description:"a"}],found:"a",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:1,line:1,column:2}}})})),it("allows to set custom location info",(function(){var a=t.generate(["start = 'a' {","  expected('a', {","    start: { offset: 1, line: 1, column: 2 },","    end: { offset: 2, line: 1, column: 3 }","  });","}"].join("\n"),e);r(a).to.failToParse("a",{message:'Expected a but "a" found.',expected:[{type:"other",description:"a"}],found:"a",location:{start:{offset:1,line:1,column:2},end:{offset:2,line:1,column:3}}})}))})),describe("|error|",(function(){it("terminates parsing and throws an exception",(function(){var a=t.generate("start = 'a' { error('a'); }",e);r(a).to.failToParse("a",{message:"a",found:null,expected:null,location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:1,line:1,column:2}}})})),it("allows to set custom location info",(function(){var a=t.generate(["start = 'a' {","  error('a', {","    start: { offset: 1, line: 1, column: 2 },","    end: { offset: 2, line: 1, column: 3 }","  });","}"].join("\n"),e);r(a).to.failToParse("a",{message:"a",expected:null,found:null,location:{start:{offset:1,line:1,column:2},end:{offset:2,line:1,column:3}}})}))}))}))})),describe("when the expression doesn't match",(function(){it("reports match failure",(function(){var a=t.generate("start = 'a' { return 42; }",e);r(a).to.failToParse("b")})),it("doesn't execute the code",(function(){var a=t.generate("start = 'a' { throw 'Boom!'; } / 'b'",e);r(a).to.parse("b")}))}))})),describe("choice",(function(){describe("when any expression matches",(function(){it("returns its match result",(function(){var a=t.generate("start = 'a' / 'b' / 'c'",e);r(a).to.parse("a","a"),r(a).to.parse("b","b"),r(a).to.parse("c","c")}))})),describe("when all expressions don't match",(function(){it("reports match failure",(function(){var a=t.generate("start = 'a' / 'b' / 'c'",e);r(a).to.failToParse("d")}))}))})),describe("error reporting",(function(){describe("behavior",(function(){it("reports only the rightmost error",(function(){var a=t.generate("start = 'a' 'b' / 'a' 'c' 'd'",e);r(a).to.failToParse("ace",{expected:[{type:"literal",text:"d",ignoreCase:!1}]})}))})),describe("expectations reporting",(function(){it("reports expectations correctly with no alternative",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("ab",{expected:[{type:"end"}]})})),it("reports expectations correctly with one alternative",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("b",{expected:[{type:"literal",text:"a",ignoreCase:!1}]})})),it("reports expectations correctly with multiple alternatives",(function(){var a=t.generate("start = 'aa' / 'bb' / 'cc'",e);r(a).to.failToParse("dd",{expected:[{type:"literal",text:"aa",ignoreCase:!1},{type:"literal",text:"bb",ignoreCase:!1},{type:"literal",text:"cc",ignoreCase:!1}]})}))})),describe("found string reporting",(function(){it("reports found string correctly at the end of input",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("",{found:null})})),it("reports found string correctly in the middle of input",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("b",{found:"b"})}))})),describe("message building",(function(){it("builds message correctly with no alternative",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("ab",{message:'Expected end of input but "b" found.'})})),it("builds message correctly with one alternative",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("b",{message:'Expected "a" but "b" found.'})})),it("builds message correctly with multiple alternatives",(function(){var a=t.generate("start = 'aa' / 'bb' / 'cc'",e);r(a).to.failToParse("dd",{message:'Expected "aa", "bb", or "cc" but "d" found.'})})),it("builds message correctly at the end of input",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("",{message:'Expected "a" but end of input found.'})})),it("builds message correctly in the middle of input",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("b",{message:'Expected "a" but "b" found.'})})),it("removes duplicates from expectations",(function(){var a=t.generate("start = 'a' / 'a'",e);r(a).to.failToParse("b",{message:'Expected "a" but "b" found.'})})),it("sorts expectations",(function(){var a=t.generate("start = 'cc' / 'bb' / 'aa'",e);r(a).to.failToParse("d",{message:'Expected "aa", "bb", or "cc" but "d" found.'})}))})),describe("position reporting",(function(){it("reports position correctly at the end of input",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("",{location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:0,line:1,column:1}}})})),it("reports position correctly in the middle of input",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("b",{location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:1,line:1,column:2}}})})),it("reports position correctly with trailing input",(function(){var a=t.generate("start = 'a'",e);r(a).to.failToParse("aa",{location:{source:void 0,start:{offset:1,line:1,column:2},end:{offset:2,line:1,column:3}}})})),it("reports position correctly in complex cases",(function(){var a=t.generate(["start = line (nl+ line)*","line = digit (' '+ digit)*","digit = [0-9]","nl = '\\r'? '\\n'"].join("\n"),e);r(a).to.failToParse("1\n2\n\n3\n\n\n4 5 x",{location:{source:void 0,start:{offset:13,line:7,column:5},end:{offset:14,line:7,column:6}}}),r(a).to.failToParse("1\nx",{location:{source:void 0,start:{offset:2,line:2,column:1},end:{offset:3,line:2,column:2}}}),r(a).to.failToParse("1\r\nx",{location:{source:void 0,start:{offset:3,line:2,column:1},end:{offset:4,line:2,column:2}}})})),it("reports location source correctly",(function(){var a={source:"object"},n=t.generate(["start = line (nl+ line)*","line = digit (' '+ digit)*","digit = [0-9]","nl = '\\r'? '\\n'"].join("\n"),e);r(n).to.failToParse("1\n2\n\n3\n\n\n4 5 x",{location:{source:a,start:{offset:13,line:7,column:5},end:{offset:14,line:7,column:6}}},{grammarSource:a})}))}))})),describe("complex examples",(function(){it("handles arithmetics example correctly",(function(){var a=t.generate(["Expr = Sum","Sum = head:Product tail:(('+' / '-') Product)* {","        return tail.reduce(function(result, element) {","          if (element[0] === '+') { return result + element[1]; }","          if (element[0] === '-') { return result - element[1]; }","        }, head);","      }","Product = head:Value tail:(('*' / '/') Value)* {","            return tail.reduce(function(result, element) {","              if (element[0] === '*') { return result * element[1]; }","              if (element[0] === '/') { return result / element[1]; }","            }, head);","          }","Value = digits:[0-9]+     { return parseInt(digits.join(''), 10); }","      / '(' expr:Expr ')' { return expr; }"].join("\n"),e);r(a).to.parse("0",0),r(a).to.parse("123",123),r(a).to.parse("(42+43)",85),r(a).to.parse("42",42),r(a).to.parse("42*43",1806),r(a).to.parse("42*43*44*45",3575880),r(a).to.parse("42/43",42/43),r(a).to.parse("42/43/44/45",42/43/44/45),r(a).to.parse("42*43",1806),r(a).to.parse("42*43+44*45",3786),r(a).to.parse("42*43+44*45+46*47+48*49",8300),r(a).to.parse("42*43-44*45",-174),r(a).to.parse("42*43-44*45-46*47-48*49",-4688),r(a).to.parse("42+43",85),r(a).to.parse("(1+2)*(3+4)",21)})),it("handles non-context-free language correctly",(function(){var a=t.generate(["S = &(A 'c') a:'a'+ B:B !('a' / 'b' / 'c') { return a.join('') + B; }","A = a:'a' A:A? b:'b' { return [a, A, b].join(''); }","B = b:'b' B:B? c:'c' { return [b, B, c].join(''); }"].join("\n"),e);r(a).to.parse("abc","abc"),r(a).to.parse("aaabbbccc","aaabbbccc"),r(a).to.failToParse("aabbbccc"),r(a).to.failToParse("aaaabbbccc"),r(a).to.failToParse("aaabbccc"),r(a).to.failToParse("aaabbbbccc"),r(a).to.failToParse("aaabbbcc"),r(a).to.failToParse("aaabbbcccc")})),it("handles nested comments example correctly",(function(){var a=t.generate(["C = begin:Begin ns:N* end:End { return begin + ns.join('') + end; }","N = C","  / !Begin !End z:Z { return z; }","Z = .","Begin = '(*'","End = '*)'"].join("\n"),e);r(a).to.parse("(**)","(**)"),r(a).to.parse("(*abc*)","(*abc*)"),r(a).to.parse("(*(**)*)","(*(**)*)"),r(a).to.parse("(*abc(*def*)ghi(*(*(*jkl*)*)*)mno*)","(*abc(*def*)ghi(*(*(*jkl*)*)*)mno*)")}))})),describe("run side-effects in non-matching",(function(){it("positive semantic predicate",(function(){var a=t.generate("\n        { let i = 0; }\n        start = (neverMatched / .) { return i; };\n        neverMatched = &{ i = 1; return true; } [];\n        ",e);r(a).to.parse("b",1),a=t.generate('\n        { let i = 0; }\n        start = ("a" / neverMatched / .) { return i; };\n        neverMatched = &{ i = 1; return true; } [];\n        ',e),r(a).to.parse("b",1)})),it("negative semantic predicate",(function(){var a=t.generate("\n        { let i = 0; }\n        start = (neverMatched / .) { return i; };\n        neverMatched = !{ i = 1; return false; } [];\n        ",e);r(a).to.parse("b",1),a=t.generate('\n        { let i = 0; }\n        start = ("a" / neverMatched / .) { return i; };\n        neverMatched = !{ i = 1; return false; } [];\n        ',e),r(a).to.parse("b",1)})),it("action",(function(){var a=t.generate("\n        { let i = 0; }\n        start = (neverMatched / .) { return i; };\n        neverMatched = (. { i = 1; }) [];\n        ",e);r(a).to.parse("b",1),a=t.generate('\n        { let i = 0; }\n        start = ("a" / neverMatched / .) { return i; };\n        neverMatched = (. { i = 1; }) [];\n        ',e),r(a).to.parse("b",1)}))}))},[{cache:!1,trace:!1},{cache:!1,trace:!0},{cache:!0,trace:!1},{cache:!0,trace:!0}].forEach((function(t){describe("with options "+e.util.inspect(t),(function(){i(n(t))}))})),describe("syntax errors",(function(){it("formats",(function(){var e={source:"stdin",text:"==="};try{t.generate(e.text,{grammarSource:e.source})}catch(a){r(a).to.be.an.instanceof(t.parser.SyntaxError),r(a.format([e])).to.equal('Error: Expected "import", "{", code block, comment, end of line, identifier, or whitespace but "=" found.\n --\x3e stdin:1:1\n  |\n1 | ===\n  | ^')}try{t.generate("===",{grammarSource:"stdin"})}catch(e){r(e).to.be.an.instanceof(t.parser.SyntaxError),r(e.format([])).to.equal('Error: Expected "import", "{", code block, comment, end of line, identifier, or whitespace but "=" found.\n at stdin:1:1')}})),it("detects infinite loops before other errors",(function(){try{t.generate('\n          start = start\n          dup = label:"foo" label:"bar"\n        ')}catch(t){r(t).with.property("stage","prepare"),r(t).with.property("problems").to.be.an("array");var e=t.problems.filter((function(e){return"error"===e[0]})).map((function(e){return e[1]}));r(e).to.deep.equal(["Possible infinite loop when parsing (left recursion: start -> start)"])}})),it("reports multiple errors in each compilation stage",(function(){try{t.generate('\n          start = leftRecursion\n          leftRecursion = duplicatedLabel:duplicatedRule duplicatedLabel:missingRule\n          duplicatedRule = missingRule\n          duplicatedRule = "nothing"\n        ')}catch(t){r(t).with.property("stage","check"),r(t).with.property("problems").to.be.an("array"),t.problems.forEach((function(e){r(e).to.be.an("array").lengthOf.gte(2),r(e[0]).to.be.oneOf(["error","warning","info"])}));var e=t.problems.filter((function(e){return"error"===e[0]})).map((function(e){return e[1]}));r(e).to.include.members(['Rule "missingRule" is not defined','Rule "duplicatedRule" is already defined','Label "duplicatedLabel" is already defined'])}}))}))})),generatedParserBehavior_spec}requireGeneratedParserBehavior_spec();var compiler_spec={},hasRequiredCompiler_spec;function requireCompiler_spec(){if(hasRequiredCompiler_spec)return compiler_spec;hasRequiredCompiler_spec=1;var e=require$$0,t=requireParser(),r=requireCompiler(),a=e.expect;return describe("Peggy compiler",(function(){it("checks start rules",(function(){var e=t.parse("foo='1'");a(r.compile(e,r.passes)).to.be.an("object"),a(r.compile(e,r.passes,{allowedStartRules:null})).to.be.an("object"),a(r.compile(e,r.passes,{allowedStartRules:void 0})).to.be.an("object"),a(r.compile(e,r.passes,{allowedStartRules:[]})).to.be.an("object"),a((function(){return r.compile(e,r.passes,{allowedStartRules:{}})})).to.throw("allowedStartRules must be an array"),a((function(){return r.compile(e,r.passes,{allowedStartRules:["bar"]})})).to.throw('Unknown start rule "bar"')})),it("checks output type",(function(){var e=t.parse("foo='1'");a(r.compile(e,r.passes,{output:"source"})).to.be.a("string"),a((function(){return r.compile(e,r.passes,{output:"INVALID OUTPUT TYPE"})})).to.throw("Invalid output format: INVALID OUTPUT TYPE.")})),it("generates inline sourceMappingURL",(function(){var e=t.parse("foo='1'");if(a(e).to.be.an("object"),"function"==typeof TextEncoder&&(a(r.compile(e,r.passes,{output:"source-with-inline-map",grammarSource:"src.peggy"})).to.match(/^\/\/# sourceMappingURL=data:application\/json;charset=utf-8;base64,/m),"object"==typeof globalThis)){var n=globalThis.TextEncoder;delete globalThis.TextEncoder,a((function(){return r.compile(e,r.passes,{output:"source-with-inline-map",grammarSource:"src.peggy"})})).to.throw("TextEncoder is not supported by this platform"),globalThis.TextEncoder=n}})),it("requires grammarSource with source-map",(function(){var e=t.parse("foo='1'");a(e).to.be.an("object"),a((function(){return r.compile(e,r.passes,{output:"source-and-map"})})).to.throw("Must provide grammarSource (as a string or GrammarLocation) in order to generate source maps"),a((function(){return r.compile(e,r.passes,{output:"source-and-map",grammarSource:""})})).to.throw("Must provide grammarSource (as a string or GrammarLocation) in order to generate source maps"),"function"==typeof TextEncoder&&a((function(){return r.compile(e,r.passes,{output:"source-with-inline-map",grammarSource:{toString:function(){return""}}})})).to.throw("Must provide grammarSource (as a string or GrammarLocation) in order to generate source maps")}))})),compiler_spec}requireCompiler_spec();var intern_spec={},hasRequiredIntern_spec;function requireIntern_spec(){if(hasRequiredIntern_spec)return intern_spec;hasRequiredIntern_spec=1;var e=require$$0,t=requireIntern(),r=e.expect;return describe("utility class Intern",(function(){it("handles strings",(function(){var e=new t;r(e.add("one")).to.equal(0),r(e.add("one")).to.equal(0),r(e.add("two")).to.equal(1),r(e.add("one")).to.equal(0),r(e.add("two")).to.equal(1),r(e.add(void 0)).to.equal(-1),r(e.add(null)).to.equal(-1),r(e.items.length).to.equal(2),r(e.items).to.deep.equal(["one","two"]),r(e.get(0)).to.equal("one"),r(e.get(1)).to.equal("two"),r(e.get(-1)).to.equal(void 0),r(e.get(10)).to.equal(void 0);var a=e.map((function(e,t){return[e,t]}));r(a).to.deep.equal([["one",0],["two",1]])})),it("does conversions",(function(){var e=new t({convert:function(e){return Array.from(e).map((function(e){return e.codePointAt(0)}))}});r(e.add("abc")).to.equal(0),r(e.add("abc")).to.equal(0),r(e.add("abd")).to.equal(1),r(e.get(0)).to.deep.equal([97,98,99]),r(e.get(1)).to.deep.equal([97,98,100])})),it("stringifies",(function(){var e=new t({stringify:function(){return"same"}});r(e.add("abc")).to.equal(0),r(e.add("def")).to.equal(0)}))})),intern_spec}requireIntern_spec();var addImportedRules_spec={},helpers,hasRequiredHelpers,hasRequiredAddImportedRules_spec;function requireHelpers(){if(hasRequiredHelpers)return helpers;hasRequiredHelpers=1;var e=helpers&&helpers.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},t=requirePeg().GrammarError,r=requireParser(),a=requireSession();return helpers=function(n,o){var s=n.Assertion;n.use(requireChaiLike()),s.addMethod("changeAST",(function(n,i,c){c=void 0!==c?c:{};var u=r.parse(n,c);o.flag(this,"object")(u,c,new a({error:function(r){for(var a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];throw new(t.bind.apply(t,e([void 0],a,!1)))}})),new s(u).like(i)})),s.addMethod("reportError",(function(n,i){var c=r.parse(n),u=!1,l=void 0;try{o.flag(this,"object")(c,{},new a({error:function(r){for(var a=[],n=1;n<arguments.length;n++)a[n-1]=arguments[n];throw new(t.bind.apply(t,e([void 0],a,!1)))}})),u=!0}catch(e){l=e}this.assert(!u,"expected #{this} to report an error but it didn't","expected #{this} to not report an error but #{act} was reported",null,l),u||void 0===i||Object.keys(i).forEach((function(e){new s(l).to.have.property(e).that.is.deep.equal(i[e])}))}))},helpers}function requireAddImportedRules_spec(){if(hasRequiredAddImportedRules_spec)return addImportedRules_spec;hasRequiredAddImportedRules_spec=1;var e=require$$0,t=requireHelpers(),r=requireAddImportedRules();e.use(t);var a=e.expect;return describe("compiler pass |addImportedRules|",(function(){it("creates default rules with undefined startRule",(function(){a(r).to.changeAST("\nimport foo from './foo.js'\nimport bar from './bar.js'\n\na = foo / bar\n",{rules:[{type:"rule",name:"a",expression:{type:"choice",alternatives:[{name:"foo",type:"rule_ref"},{name:"bar",type:"rule_ref"}]}},{type:"rule",name:"foo",expression:{type:"library_ref",name:void 0,library:"./foo.js",libraryNumber:0}},{type:"rule",name:"bar",expression:{type:"library_ref",name:void 0,library:"./bar.js",libraryNumber:1}}]})})),it("creates bound rules with named startRule",(function(){a(r).to.changeAST("\nimport {foo} from './foo.js'\nimport {bar} from './bar.js'\n\na = foo / bar\n",{rules:[{type:"rule",name:"a",expression:{type:"choice",alternatives:[{name:"foo",type:"rule_ref"},{name:"bar",type:"rule_ref"}]}},{type:"rule",name:"foo",expression:{type:"library_ref",name:"foo",library:"./foo.js",libraryNumber:0}},{type:"rule",name:"bar",expression:{type:"library_ref",name:"bar",library:"./bar.js",libraryNumber:1}}]})})),it("creates bound rules with renamed startRule",(function(){a(r).to.changeAST("\nimport {foo as foo1} from './foo.js'\nimport {bar as bar2} from './bar.js'\n\na = foo1 / bar2\n",{rules:[{type:"rule",name:"a",expression:{type:"choice",alternatives:[{name:"foo1",type:"rule_ref"},{name:"bar2",type:"rule_ref"}]}},{type:"rule",name:"foo1",expression:{type:"library_ref",name:"foo",library:"./foo.js",libraryNumber:0}},{type:"rule",name:"bar2",expression:{type:"library_ref",name:"bar",library:"./bar.js",libraryNumber:1}}]})})),it("skips import as",(function(){a(r).to.changeAST("\nimport * as foo from './foo.js'\n\na = foo.one / foo.two\n",{rules:[{type:"rule",name:"a",expression:{type:"choice",alternatives:[{type:"library_ref",name:"one",library:"foo",libraryNumber:-1},{type:"library_ref",name:"two",library:"foo",libraryNumber:-1}]}}]})})),it("errors on bad types",(function(){a((function(){r({imports:[{what:[{type:"unknown"}],from:{module:"foo.js"}}]})})).to.throw(TypeError)}))})),addImportedRules_spec}requireAddImportedRules_spec();var fixLibraryNumbers_spec={},hasRequiredFixLibraryNumbers_spec;function requireFixLibraryNumbers_spec(){if(hasRequiredFixLibraryNumbers_spec)return fixLibraryNumbers_spec;hasRequiredFixLibraryNumbers_spec=1;var e=require$$0,t=requireHelpers(),r=requireFixLibraryNumbers();e.use(t);var a=e.expect;return describe("compiler pass |fixLibraryNumbers|",(function(){it("Adds library numbers for import * as",(function(){a(r).to.changeAST('\nimport * as foo from "./foo.js";\nimport * as bar from "./foo.js";\n\na = foo.one / bar.two\n      ',{rules:[{type:"rule",name:"a",expression:{type:"choice",alternatives:[{type:"library_ref",name:"one",library:"foo",libraryNumber:0},{type:"library_ref",name:"two",library:"bar",libraryNumber:1}]}}]})})),it("fails on unknown module names",(function(){a(r).to.reportError("a = foo.bar",{message:'Unknown module "foo"'})}))})),fixLibraryNumbers_spec}requireFixLibraryNumbers_spec();var generateBytecode_spec={},hasRequiredGenerateBytecode_spec;function requireGenerateBytecode_spec(){if(hasRequiredGenerateBytecode_spec)return generateBytecode_spec;hasRequiredGenerateBytecode_spec=1;var e=require$$0,t=requireHelpers(),r=requireGenerateBytecode();e.use(t);var a=e.expect;return describe("compiler pass |generateBytecode|",(function(){function e(e){return{rules:[{bytecode:e}]}}function t(e,t){return{rules:[{bytecode:e}],locations:t}}function n(e,t,r,a){return{literals:e,classes:t,expectations:r,functions:a}}describe("for grammar",(function(){it("generates correct bytecode",(function(){a(r).to.changeAST(["a = 'a'","b = 'b'","c = 'c'"].join("\n"),{rules:[{bytecode:[18,0,2,2,22,0,23,0]},{bytecode:[18,1,2,2,22,1,23,1]},{bytecode:[18,2,2,2,22,2,23,2]}]})})),it("allows Object prototype property names as literals",(function(){a(r).to.changeAST(["a = '__proto__'","b = 'constructor'","c = 'hasOwnProperty'","d = 'isPrototypeOf'","e = 'propertyIsEnumerable'","f = 'toLocaleString'","g = 'toString'","h = 'valueOf'"].join("\n"),{rules:[{bytecode:[18,0,2,2,22,0,23,0]},{bytecode:[18,1,2,2,22,1,23,1]},{bytecode:[18,2,2,2,22,2,23,2]},{bytecode:[18,3,2,2,22,3,23,3]},{bytecode:[18,4,2,2,22,4,23,4]},{bytecode:[18,5,2,2,22,5,23,5]},{bytecode:[18,6,2,2,22,6,23,6]},{bytecode:[18,7,2,2,22,7,23,7]}]})})),it("defines correct constants",(function(){a(r).to.changeAST(["a = 'a'","b = 'b'","c = 'c'"].join("\n"),n(["a","b","c"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1},{type:"literal",value:"c",ignoreCase:!1}],[]))})),it("generates correct source mapping",(function(){a(r).to.changeAST(["a = 'a'"].join("\n"),t([37,0,18,0,2,2,22,0,23,0,38],[{source:"-",start:{offset:4,line:1,column:5},end:{offset:7,line:1,column:8}}]),{grammarSource:"-",output:"source-and-map"})})),it("generates correct plucking bytecode",(function(){a(r).to.changeAST("start = 'a' @'b' 'c'",e([5,18,0,2,2,22,0,23,0,15,34,3,18,1,2,2,22,1,23,1,15,19,4,18,2,2,2,22,2,23,2,15,4,4,36,4,1,1,8,3,7,3,8,2,7,3,6,7,3])),a(r).to.changeAST("start = 'a' @'b' @'c'",e([5,18,0,2,2,22,0,23,0,15,35,3,18,1,2,2,22,1,23,1,15,20,4,18,2,2,2,22,2,23,2,15,5,4,36,4,2,1,0,8,3,7,3,8,2,7,3,6,7,3]))}))})),describe("for rule",(function(){it("generates correct bytecode",(function(){a(r).to.changeAST("start = 'a'",e([18,0,2,2,22,0,23,0]))}))})),describe("for named",(function(){var t="start 'start' = 'a'";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([28,18,0,2,2,22,0,23,1,29,14,2,0,23,0]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"rule",value:"start"},{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("for choice",(function(){it("generates correct bytecode and source mapping",(function(){a(r).to.changeAST("start = 'a' / label:'b' / 'c'",t([37,5,37,0,18,0,2,2,22,0,23,0,38,14,36,0,6,37,3,39,0,2,2,37,1,18,1,2,2,22,1,23,1,38,40,0,38,14,12,0,6,37,4,18,3,2,2,22,3,23,2,38,38],[{source:"-",start:{offset:8,line:1,column:9},end:{offset:11,line:1,column:12}},{source:"-",start:{offset:20,line:1,column:21},end:{offset:23,line:1,column:24}},{source:"-",start:{offset:14,line:1,column:15},end:{offset:19,line:1,column:20}},{source:"-",start:{offset:14,line:1,column:15},end:{offset:23,line:1,column:24}},{source:"-",start:{offset:26,line:1,column:27},end:{offset:29,line:1,column:30}},{source:"-",start:{offset:8,line:1,column:9},end:{offset:29,line:1,column:30}}]),{grammarSource:"-",output:"source-and-map"})}))})),describe("for action",(function(){describe("without labels",(function(){var t="start = 'a' { code }";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,18,0,2,2,22,0,23,0,15,6,0,24,1,26,0,1,0,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!1,params:[],body:" code ",location:{source:void 0,start:{offset:13,line:1,column:14},end:{offset:19,line:1,column:20}}}]))}))})),describe("with one label",(function(){var t="start = a:'a' { code }";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,18,0,2,2,22,0,23,0,15,7,0,24,1,26,0,1,1,0,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!1,params:["a"],body:" code ",location:{source:void 0,start:{offset:15,line:1,column:16},end:{offset:21,line:1,column:22}}}]))}))})),describe("with multiple labels",(function(){var t="start = a:'a' b:'b' c:'c' { code }";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,18,0,2,2,22,0,23,0,15,39,3,18,1,2,2,22,1,23,1,15,24,4,18,2,2,2,22,2,23,2,15,9,4,24,3,26,0,4,3,2,1,0,8,3,7,3,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b","c"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1},{type:"literal",value:"c",ignoreCase:!1}],[{predicate:!1,params:["a","b","c"],body:" code ",location:{source:void 0,start:{offset:27,line:1,column:28},end:{offset:33,line:1,column:34}}}]))}))}))})),describe("for sequence",(function(){var t="start = 'a' 'b' 'c'";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,18,0,2,2,22,0,23,0,15,33,3,18,1,2,2,22,1,23,1,15,18,4,18,2,2,2,22,2,23,2,15,3,4,11,3,9,8,3,7,3,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b","c"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1},{type:"literal",value:"c",ignoreCase:!1}],[]))}))})),describe("for labeled",(function(){it("generates correct bytecode",(function(){a(r).to.changeAST("start = a:'a'",e([18,0,2,2,22,0,23,0]))}))})),describe("for text",(function(){it("generates correct bytecode",(function(){a(r).to.changeAST("start = $'a'",e([5,18,0,2,2,22,0,23,0,15,2,1,6,12,9]))}))})),describe("for simple_and",(function(){var t="start = &'a'";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,28,18,0,2,2,22,0,23,0,29,15,3,3,6,7,1,6,6,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("for simple_not",(function(){var t="start = !'a'";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,28,18,0,2,2,22,0,23,0,29,14,3,3,6,6,1,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("for optional",(function(){var t="start = 'a'?";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([18,0,2,2,22,0,23,0,14,2,0,6,2]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("for zero_or_more",(function(){var t="start = 'a'*";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,16,9,10,18,0,2,2,22,0,23,0,6]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("for one_or_more",(function(){var t="start = 'a'+";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,15,12,3,16,9,10,18,0,2,2,22,0,23,0,6,6,6,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("for repeated",(function(){describe("without delimiter",(function(){describe("| .. | (edge case -- no boundaries)",(function(){var t="start = 'a'| .. |";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,16,9,10,18,0,2,2,22,0,23,0,6]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("with constant boundaries",(function(){describe("| ..3| (edge case -- no min boundary)",(function(){var t="start = 'a'| ..3|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,16,14,10,31,3,1,8,3,18,0,2,2,22,0,23,0,6]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("| ..1| (edge case -- no min boundary -- same as |optional|)",(function(){var t="start = 'a'| ..1|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,16,14,10,31,1,1,8,3,18,0,2,2,22,0,23,0,6]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("|2.. | (edge case -- no max boundary)",(function(){var t="start = 'a'|2.. |";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,4,18,0,2,2,22,0,23,0,16,9,10,18,0,2,2,22,0,23,0,6,30,2,3,1,6,7,3,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("|0.. | (edge case -- no max boundary -- same as |zero or more|)",(function(){var t="start = 'a'|0.. |";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,16,9,10,18,0,2,2,22,0,23,0,6]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("|1.. | (edge case -- no max boundary -- same as |one or more|)",(function(){var t="start = 'a'|1.. |";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,4,18,0,2,2,22,0,23,0,16,9,10,18,0,2,2,22,0,23,0,6,30,1,3,1,6,7,3,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("|2..3|",(function(){var t="start = 'a'|2..3|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,4,18,0,2,2,22,0,23,0,16,14,10,31,3,1,8,3,18,0,2,2,22,0,23,0,6,30,2,3,1,6,7,3,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("| 42 | (edge case -- exact repetitions)",(function(){var t="start = 'a'|42|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,4,18,0,2,2,22,0,23,0,16,14,10,31,42,1,8,3,18,0,2,2,22,0,23,0,6,30,42,3,1,6,7,3,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))}))})),describe("with variable boundaries",(function(){describe("| ..x| (edge case -- no min boundary)",(function(){var t="start = max:('a'{return 42;}) 'a'| ..max|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,18,0,2,2,22,0,23,0,15,6,0,24,1,26,0,1,0,9,15,41,3,4,33,1,1,8,3,18,0,2,2,22,0,23,0,16,14,10,33,1,1,8,3,18,0,2,2,22,0,23,0,6,15,3,4,11,2,9,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"}]))}))})),describe("|x.. | (edge case -- no max boundary)",(function(){var t="start = min:('a'{return 42;}) 'a'|min.. |";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,18,0,2,2,22,0,23,0,15,6,0,24,1,26,0,1,0,9,15,40,3,5,4,18,0,2,2,22,0,23,0,16,9,10,18,0,2,2,22,0,23,0,6,32,2,3,1,6,7,3,9,15,3,4,11,2,9,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"}]))}))})),describe("|x..y|",(function(){var t="start = min:('a'{return 42;}) max:('a'{return 42;}) 'a'|min..max|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,18,0,2,2,22,0,23,0,15,6,0,24,1,26,0,1,0,9,15,77,3,5,18,0,2,2,22,0,23,0,15,7,0,24,1,26,1,1,1,2,9,15,50,4,5,4,33,2,1,8,3,18,0,2,2,22,0,23,0,16,14,10,33,2,1,8,3,18,0,2,2,22,0,23,0,6,32,3,3,1,6,7,3,9,15,3,4,11,3,9,8,3,7,3,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"},{predicate:!1,params:["min"],body:"return 42;"}]))}))})),describe("|exact| (edge case -- exact repetitions)",(function(){var t="start = exact:('a'{return 42;}) 'a'|exact|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,18,0,2,2,22,0,23,0,15,6,0,24,1,26,0,1,0,9,15,50,3,5,4,33,2,1,8,3,18,0,2,2,22,0,23,0,16,14,10,33,2,1,8,3,18,0,2,2,22,0,23,0,6,32,2,3,1,6,7,3,9,15,3,4,11,2,9,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"}]))}))}))})),describe("with function boundaries",(function(){describe("| ..x| (edge case -- no min boundary)",(function(){var t="start = 'a'| ..{return 42;}|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([26,0,0,0,4,33,1,1,8,3,18,0,2,2,22,0,23,0,16,14,10,33,1,1,8,3,18,0,2,2,22,0,23,0,6,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!0,params:[],body:"return 42;"}]))}))})),describe("|x.. | (edge case -- no max boundary)",(function(){var t="start = 'a'|{return 42;}.. |";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([26,0,0,0,5,4,18,0,2,2,22,0,23,0,16,9,10,18,0,2,2,22,0,23,0,6,32,2,3,1,6,7,3,9,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!0,params:[],body:"return 42;"}]))}))})),describe("|x..y|",(function(){var t="start = 'a'|{return 41;}..{return 43;}|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([26,0,0,0,26,1,0,0,5,4,33,2,1,8,3,18,0,2,2,22,0,23,0,16,14,10,33,2,1,8,3,18,0,2,2,22,0,23,0,6,32,3,3,1,6,7,3,9,9,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!0,params:[],body:"return 41;"},{predicate:!0,params:[],body:"return 43;"}]))}))})),describe("|exact| (edge case -- exact repetitions)",(function(){var t="start = 'a'|{return 42;}|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([26,0,0,0,5,4,33,2,1,8,3,18,0,2,2,22,0,23,0,16,14,10,33,2,1,8,3,18,0,2,2,22,0,23,0,6,32,2,3,1,6,7,3,9,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[{predicate:!0,params:[],body:"return 42;"}]))}))}))}))})),describe("with delimiter",(function(){describe("| .. , delim| (edge case -- no boundaries)",(function(){var t="start = 'a'| .. , 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,16,30,10,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[]))}))})),describe("with constant boundaries",(function(){describe("| ..3, delim| (edge case -- no min boundary)",(function(){var t="start = 'a'| ..3, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,16,35,10,31,3,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[]))}))})),describe("| ..1, delim| (edge case -- no min boundary -- same as |optional|)",(function(){var t="start = 'a'| ..1, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,16,35,10,31,1,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[]))}))})),describe("|2.. , delim| (edge case -- no max boundary)",(function(){var t="start = 'a'|2.. , 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,4,18,0,2,2,22,0,23,0,16,30,10,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,30,2,3,1,6,7,3,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[]))}))})),describe("|0.. , delim| (edge case -- no max boundary -- same as |zero or more|)",(function(){var t="start = 'a'|0.. , 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([4,18,0,2,2,22,0,23,0,16,30,10,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[]))}))})),describe("|1.. , delim| (edge case -- no max boundary -- same as |one or more|)",(function(){var t="start = 'a'|1.. , 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,4,18,0,2,2,22,0,23,0,16,30,10,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,30,1,3,1,6,7,3,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[]))}))})),describe("|2..3, delim|",(function(){var t="start = 'a'|2..3, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,4,18,0,2,2,22,0,23,0,16,35,10,31,3,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,30,2,3,1,6,7,3,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[]))}))})),describe("| 42 , delim| (edge case -- exact repetitions)",(function(){var t="start = 'a'|42, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,4,18,0,2,2,22,0,23,0,16,35,10,31,42,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,30,42,3,1,6,7,3,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[]))}))}))})),describe("with variable boundaries",(function(){describe("| ..x, delim| (edge case -- no min boundary)",(function(){var t="start = max:(''{return 42;}) 'a'| ..max, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,35,15,6,0,24,1,26,0,1,0,9,15,62,3,4,33,1,1,8,3,18,0,2,2,22,0,23,0,16,35,10,33,1,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,15,3,4,11,2,9,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"}]))}))})),describe("|x.. , delim| (edge case -- no max boundary)",(function(){var t="start = min:(''{return 42;}) 'a'|min.. , 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,35,15,6,0,24,1,26,0,1,0,9,15,61,3,5,4,18,0,2,2,22,0,23,0,16,30,10,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,32,2,3,1,6,7,3,9,15,3,4,11,2,9,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"}]))}))})),describe("|x..y, delim|",(function(){var t="start = min:(''{return 42;}) max:(''{return 42;}) 'a'|min..max, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,35,15,6,0,24,1,26,0,1,0,9,15,91,3,5,35,15,7,0,24,1,26,1,1,1,2,9,15,71,4,5,4,33,2,1,8,3,18,0,2,2,22,0,23,0,16,35,10,33,2,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,32,3,3,1,6,7,3,9,15,3,4,11,3,9,8,3,7,3,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"},{predicate:!1,params:["min"],body:"return 42;"}]))}))})),describe("|exact, delim| (edge case -- exact repetitions)",(function(){var t="start = exact:(''{return 42;}) 'a'|exact, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,35,15,6,0,24,1,26,0,1,0,9,15,71,3,5,4,33,2,1,8,3,18,0,2,2,22,0,23,0,16,35,10,33,2,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,32,2,3,1,6,7,3,9,15,3,4,11,2,9,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"}]))}))})),describe("used in delimiter",(function(){describe("delim|min..|",(function(){var t="start = min:(''{return 42;}) 'a'|.., 'b'|min..| |";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,35,15,6,0,24,1,26,0,1,0,9,15,74,3,4,18,0,2,2,22,0,23,0,16,52,10,5,5,4,18,1,2,2,22,1,23,1,16,9,10,18,1,2,2,22,1,23,1,6,32,4,3,1,6,7,3,9,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,15,3,4,11,2,9,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"}]))}))})),describe("delim|..max|",(function(){var t="start = max:(''{return 42;}) 'a'|.., 'b'|..max| |";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,35,15,6,0,24,1,26,0,1,0,9,15,75,3,4,18,0,2,2,22,0,23,0,16,53,10,5,4,33,3,1,8,3,18,1,2,2,22,1,23,1,16,14,10,33,3,1,8,3,18,1,2,2,22,1,23,1,6,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,15,3,4,11,2,9,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"}]))}))})),describe("delim|exact|",(function(){var t="start = exact:(''{return 42;}) 'a'|.., 'b'|exact| |";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,5,35,15,6,0,24,1,26,0,1,0,9,15,84,3,4,18,0,2,2,22,0,23,0,16,62,10,5,5,4,33,4,1,8,3,18,1,2,2,22,1,23,1,16,14,10,33,4,1,8,3,18,1,2,2,22,1,23,1,6,32,4,3,1,6,7,3,9,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,15,3,4,11,2,9,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!1,params:[],body:"return 42;"}]))}))}))}))})),describe("with function boundaries",(function(){describe("| ..x, delim| (edge case -- no min boundary)",(function(){var t="start = 'a'| ..{return 42;}, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([26,0,0,0,4,33,1,1,8,3,18,0,2,2,22,0,23,0,16,35,10,33,1,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!0,params:[],body:"return 42;"}]))}))})),describe("|x.. , delim| (edge case -- no max boundary)",(function(){var t="start = 'a'|{return 42;}.. , 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([26,0,0,0,5,4,18,0,2,2,22,0,23,0,16,30,10,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,32,2,3,1,6,7,3,9,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!0,params:[],body:"return 42;"}]))}))})),describe("|x..y, delim|",(function(){var t="start = 'a'|{return 41;}..{return 43;}, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([26,0,0,0,26,1,0,0,5,4,33,2,1,8,3,18,0,2,2,22,0,23,0,16,35,10,33,2,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,32,3,3,1,6,7,3,9,9,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!0,params:[],body:"return 41;"},{predicate:!0,params:[],body:"return 43;"}]))}))})),describe("|exact, delim| (edge case -- exact repetitions)",(function(){var t="start = 'a'|{return 42;}, 'b'|";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([26,0,0,0,5,4,33,2,1,8,3,18,0,2,2,22,0,23,0,16,35,10,33,2,1,29,3,5,18,1,2,2,22,1,23,1,15,16,1,6,18,0,2,2,22,0,23,0,14,3,1,6,7,3,9,9,6,32,2,3,1,6,7,3,9,9]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1}],[{predicate:!0,params:[],body:"return 42;"}]))}))}))}))}))})),describe("for group",(function(){var t="start = ('a')";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([18,0,2,2,22,0,23,0]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("for semantic_and",(function(){describe("without labels",(function(){var t="start = &{ code }";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([25,26,0,0,0,13,2,2,6,1,6,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n([],[],[],[{predicate:!0,params:[],body:" code ",location:{source:void 0,start:{offset:10,line:1,column:11},end:{offset:16,line:1,column:17}}}]))}))})),describe("with labels",(function(){var t="start = a:'a' b:'b' c:'c' &{ code }";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,18,0,2,2,22,0,23,0,15,55,3,18,1,2,2,22,1,23,1,15,40,4,18,2,2,2,22,2,23,2,15,25,4,25,26,0,0,3,2,1,0,13,2,2,6,1,6,3,15,3,4,11,4,9,8,4,7,3,8,3,7,3,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b","c"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1},{type:"literal",value:"c",ignoreCase:!1}],[{predicate:!0,params:["a","b","c"],body:" code ",location:{source:void 0,start:{offset:28,line:1,column:29},end:{offset:34,line:1,column:35}}}]))}))}))})),describe("for semantic_not",(function(){describe("without labels",(function(){var t="start = !{ code }";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([25,26,0,0,0,13,2,2,6,3,6,1]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n([],[],[],[{predicate:!0,params:[],body:" code ",location:{source:void 0,start:{offset:10,line:1,column:11},end:{offset:16,line:1,column:17}}}]))}))})),describe("with labels",(function(){var t="start = a:'a' b:'b' c:'c' !{ code }";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([5,18,0,2,2,22,0,23,0,15,55,3,18,1,2,2,22,1,23,1,15,40,4,18,2,2,2,22,2,23,2,15,25,4,25,26,0,0,3,2,1,0,13,2,2,6,3,6,1,15,3,4,11,4,9,8,4,7,3,8,3,7,3,8,2,7,3,6,7,3]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a","b","c"],[],[{type:"literal",value:"a",ignoreCase:!1},{type:"literal",value:"b",ignoreCase:!1},{type:"literal",value:"c",ignoreCase:!1}],[{predicate:!0,params:["a","b","c"],body:" code ",location:{source:void 0,start:{offset:28,line:1,column:29},end:{offset:34,line:1,column:35}}}]))}))}))})),describe("for rule_ref",(function(){it("generates correct bytecode",(function(){a(r).to.changeAST(["start = other","other = 'other'"].join("\n"),{rules:[{bytecode:[27,1]},{}]})}))})),describe("for literal",(function(){describe("empty",(function(){var t="start = ''";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([35]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n([],[],[],[]))}))})),describe("non-empty case-sensitive",(function(){var t="start = 'a'";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([18,0,2,2,22,0,23,0]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"a",ignoreCase:!1}],[]))}))})),describe("non-empty case-insensitive",(function(){var t="start = 'A'i";it("generates correct bytecode",(function(){a(r).to.changeAST(t,e([19,0,2,2,21,1,23,0]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n(["a"],[],[{type:"literal",value:"A",ignoreCase:!0}],[]))}))}))})),describe("for class",(function(){it("generates correct bytecode",(function(){a(r).to.changeAST("start = [a]",e([20,0,2,2,21,1,23,0]))})),describe("non-inverted case-sensitive",(function(){it("defines correct constants",(function(){a(r).to.changeAST("start = [a]",n([],[{value:["a"],ignoreCase:!1,inverted:!1}],[{type:"class",value:["a"],ignoreCase:!1,inverted:!1}],[]))}))})),describe("inverted case-sensitive",(function(){it("defines correct constants",(function(){a(r).to.changeAST("start = [^a]",n([],[{value:["a"],ignoreCase:!1,inverted:!0}],[{type:"class",value:["a"],ignoreCase:!1,inverted:!0}],[]))}))})),describe("non-inverted case-insensitive",(function(){it("defines correct constants",(function(){a(r).to.changeAST("start = [a]i",n([],[{value:["a"],ignoreCase:!0,inverted:!1}],[{type:"class",value:["a"],ignoreCase:!0,inverted:!1}],[]))}))})),describe("complex",(function(){it("defines correct constants",(function(){a(r).to.changeAST("start = [ab-def-hij-l]",n([],[{value:["a",["b","d"],"e",["f","h"],"i",["j","l"]],ignoreCase:!1,inverted:!1}],[{type:"class",value:["a",["b","d"],"e",["f","h"],"i",["j","l"]],ignoreCase:!1,inverted:!1}],[]))}))}))})),describe("for any",(function(){var t="start = .";it("generates bytecode",(function(){a(r).to.changeAST(t,e([17,2,2,21,1,23,0]))})),it("defines correct constants",(function(){a(r).to.changeAST(t,n([],[],[{type:"any"}],[]))}))}))})),generateBytecode_spec}requireGenerateBytecode_spec();var generateJs_spec={},hasRequiredGenerateJs_spec;function requireGenerateJs_spec(){if(hasRequiredGenerateJs_spec)return generateJs_spec;hasRequiredGenerateJs_spec=1;var e=generateJs_spec&&generateJs_spec.__assign||function(){return e=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},e.apply(this,arguments)},t=require$$0,r=requireGenerateJs(),a=t.expect;return describe("compiler pass |generateJS|",(function(){describe("coverage",(function(){var t={type:"grammar",imports:[],rules:[],location:{source:"",start:{line:1,column:1,offset:0},end:{line:1,column:1,offset:0}}},n={};it("throws unless various grammar fields are set",(function(){a((function(){return r(t,n)})).to.throw(Error,"generateJS: generate bytecode was not called."),t.literals=[],a((function(){return r(e(e({},t),{literals:[]}),n)})).to.throw(Error,"generateJS: generate bytecode was not called."),t.locations=[],a((function(){return r(e(e({},t),{literals:[]}),n)})).to.throw(Error,"generateJS: generate bytecode was not called."),t.classes=[],a((function(){return r(e(e({},t),{literals:[]}),n)})).to.throw(Error,"generateJS: generate bytecode was not called."),t.expectations=[],a((function(){return r(e(e({},t),{literals:[]}),n)})).to.throw(Error,"generateJS: generate bytecode was not called."),t.functions=[],a((function(){return r(e(e({},t),{literals:[]}),n)})).to.throw(Error,"generateJS: generate bytecode was not called."),t.importedNames=[],a((function(){return r(t,n)})).to.throw(Error,"generateJS: options.allowedStartRules was not set."),n.allowedStartRules=["start"],a((function(){return r(t,n)})).to.not.throw()}))}))})),generateJs_spec}requireGenerateJs_spec();var inferenceMatchResult_spec={},hasRequiredInferenceMatchResult_spec;function requireInferenceMatchResult_spec(){if(hasRequiredInferenceMatchResult_spec)return inferenceMatchResult_spec;hasRequiredInferenceMatchResult_spec=1;var e=require$$0,t=requireHelpers(),r=requireInferenceMatchResult();e.use(t);var a=e.expect;return describe("compiler pass |inferenceMatchResult|",(function(){it("calculate |match| property for |any| correctly",(function(){a(r).to.changeAST("start = .",{rules:[{match:0}]})})),it("calculate |match| property for |literal| correctly",(function(){a(r).to.changeAST("start = ''",{rules:[{match:1}]}),a(r).to.changeAST("start = ''i",{rules:[{match:1}]}),a(r).to.changeAST("start = 'a'",{rules:[{match:0}]}),a(r).to.changeAST("start = 'a'i",{rules:[{match:0}]})})),it("calculate |match| property for |class| correctly",(function(){a(r).to.changeAST("start = []",{rules:[{match:-1}]}),a(r).to.changeAST("start = []i",{rules:[{match:-1}]}),a(r).to.changeAST("start = [a]",{rules:[{match:0}]}),a(r).to.changeAST("start = [a]i",{rules:[{match:0}]}),a(r).to.changeAST("start = [a-b]",{rules:[{match:0}]}),a(r).to.changeAST("start = [a-b]i",{rules:[{match:0}]})})),it("calculate |match| property for |sequence| correctly",(function(){a(r).to.changeAST("start = 'a' 'b'",{rules:[{match:0}]}),a(r).to.changeAST("start = 'a' ''",{rules:[{match:0}]}),a(r).to.changeAST("start = '' 'b'",{rules:[{match:0}]}),a(r).to.changeAST("start = '' ''",{rules:[{match:1}]}),a(r).to.changeAST("start = 'a' []",{rules:[{match:-1}]}),a(r).to.changeAST("start = [] 'b'",{rules:[{match:-1}]}),a(r).to.changeAST("start = [] []",{rules:[{match:-1}]})})),it("calculate |match| property for |choice| correctly",(function(){a(r).to.changeAST("start = 'a' / 'b'",{rules:[{match:0}]}),a(r).to.changeAST("start = 'a' / ''",{rules:[{match:0}]}),a(r).to.changeAST("start = ''  / 'b'",{rules:[{match:0}]}),a(r).to.changeAST("start = ''  / ''",{rules:[{match:1}]}),a(r).to.changeAST("start = 'a' / []",{rules:[{match:0}]}),a(r).to.changeAST("start = []  / 'b'",{rules:[{match:0}]}),a(r).to.changeAST("start = []  / []",{rules:[{match:-1}]})})),it("calculate |match| property for predicates correctly",(function(){a(r).to.changeAST("start = &.",{rules:[{match:0}]}),a(r).to.changeAST("start = &''",{rules:[{match:1}]}),a(r).to.changeAST("start = &[]",{rules:[{match:-1}]}),a(r).to.changeAST("start = !.",{rules:[{match:0}]}),a(r).to.changeAST("start = !''",{rules:[{match:-1}]}),a(r).to.changeAST("start = ![]",{rules:[{match:1}]}),a(r).to.changeAST("start = &{ code }",{rules:[{match:0}]}),a(r).to.changeAST("start = !{ code }",{rules:[{match:0}]})})),it("calculate |match| property for |text| correctly",(function(){a(r).to.changeAST("start = $.",{rules:[{match:0}]}),a(r).to.changeAST("start = $''",{rules:[{match:1}]}),a(r).to.changeAST("start = $[]",{rules:[{match:-1}]})})),it("calculate |match| property for |action| correctly",(function(){a(r).to.changeAST("start = .  { code }",{rules:[{match:0}]}),a(r).to.changeAST("start = '' { code }",{rules:[{match:1}]}),a(r).to.changeAST("start = [] { code }",{rules:[{match:-1}]})})),it("calculate |match| property for |labeled| correctly",(function(){a(r).to.changeAST("start = a:.",{rules:[{match:0}]}),a(r).to.changeAST("start = a:''",{rules:[{match:1}]}),a(r).to.changeAST("start = a:[]",{rules:[{match:-1}]})})),it("calculate |match| property for |named| correctly",(function(){a(r).to.changeAST("start 'start' = .",{rules:[{match:0}]}),a(r).to.changeAST("start 'start' = ''",{rules:[{match:1}]}),a(r).to.changeAST("start 'start' = []",{rules:[{match:-1}]})})),it("calculate |match| property for |optional| correctly",(function(){a(r).to.changeAST("start = .?",{rules:[{match:1}]}),a(r).to.changeAST("start = ''?",{rules:[{match:1}]}),a(r).to.changeAST("start = []?",{rules:[{match:1}]})})),it("calculate |match| property for |zero_or_more| correctly",(function(){a(r).to.changeAST("start = .*",{rules:[{match:1}]}),a(r).to.changeAST("start = ''*",{rules:[{match:1}]}),a(r).to.changeAST("start = []*",{rules:[{match:1}]})})),it("calculate |match| property for |one_or_more| correctly",(function(){a(r).to.changeAST("start = .+",{rules:[{match:0}]}),a(r).to.changeAST("start = ''+",{rules:[{match:1}]}),a(r).to.changeAST("start = []+",{rules:[{match:-1}]})})),describe("calculate |match| property for |repeated|",(function(){describe("without delimiter",(function(){describe("with constant boundaries",(function(){it("for | .. | correctly",(function(){a(r).to.changeAST("start =  .| .. |",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| .. |",{rules:[{match:1}]}),a(r).to.changeAST("start = []| .. |",{rules:[{match:1}]})})),it("for | ..1| correctly",(function(){a(r).to.changeAST("start =  .| ..1|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| ..1|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| ..1|",{rules:[{match:1}]})})),it("for | ..3| correctly",(function(){a(r).to.changeAST("start =  .| ..3|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| ..3|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| ..3|",{rules:[{match:1}]})})),it("for |0.. | correctly",(function(){a(r).to.changeAST("start =  .|0.. |",{rules:[{match:1}]}),a(r).to.changeAST("start = ''|0.. |",{rules:[{match:1}]}),a(r).to.changeAST("start = []|0.. |",{rules:[{match:1}]})})),it("for |1.. | correctly",(function(){a(r).to.changeAST("start =  .|1.. |",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|1.. |",{rules:[{match:1}]}),a(r).to.changeAST("start = []|1.. |",{rules:[{match:-1}]})})),it("for |2.. | correctly",(function(){a(r).to.changeAST("start =  .|2.. |",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|2.. |",{rules:[{match:1}]}),a(r).to.changeAST("start = []|2.. |",{rules:[{match:-1}]})})),it("for |2..3| correctly",(function(){a(r).to.changeAST("start =  .|2..3|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|2..3|",{rules:[{match:1}]}),a(r).to.changeAST("start = []|2..3|",{rules:[{match:-1}]})})),it("for | 42 | correctly",(function(){a(r).to.changeAST("start =  .| 42 |",{rules:[{match:0}]}),a(r).to.changeAST("start = ''| 42 |",{rules:[{match:1}]}),a(r).to.changeAST("start = []| 42 |",{rules:[{match:-1}]})}))})),describe("with variable boundaries",(function(){it("for |   ..max| correctly",(function(){a(r).to.changeAST("start =  .|   ..max|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|   ..max|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|   ..max|",{rules:[{match:0}]})})),it("for |min..   | correctly",(function(){a(r).to.changeAST("start =  .|min..   |",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|min..   |",{rules:[{match:0}]}),a(r).to.changeAST("start = []|min..   |",{rules:[{match:0}]})})),it("for |min..max| correctly",(function(){a(r).to.changeAST("start =  .|min..max|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|min..max|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|min..max|",{rules:[{match:0}]})})),it("for | exact  | correctly",(function(){a(r).to.changeAST("start =  .|exact|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|exact|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|exact|",{rules:[{match:0}]})}))})),describe("with function boundaries",(function(){it("for |  ..{}| correctly",(function(){a(r).to.changeAST("start =  .|   ..{}|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|   ..{}|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|   ..{}|",{rules:[{match:0}]})})),it("for |{}..  | correctly",(function(){a(r).to.changeAST("start =  .|{}..   |",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|{}..   |",{rules:[{match:0}]}),a(r).to.changeAST("start = []|{}..   |",{rules:[{match:0}]})})),it("for |{}..{}| correctly",(function(){a(r).to.changeAST("start =  .|{}..{}|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|{}..{}|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|{}..{}|",{rules:[{match:0}]})})),it("for |  {}  | correctly",(function(){a(r).to.changeAST("start =  .|{}|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|{}|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|{}|",{rules:[{match:0}]})}))}))})),describe("with delimiter",(function(){describe("with constant boundaries",(function(){it("for | .. , delimiter| correctly",(function(){a(r).to.changeAST("start =  .| .. , .|",{rules:[{match:1}]}),a(r).to.changeAST("start =  .| .. ,''|",{rules:[{match:1}]}),a(r).to.changeAST("start =  .| .. ,[]|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| .. , .|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| .. ,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| .. ,[]|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| .. , .|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| .. ,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| .. ,[]|",{rules:[{match:1}]})})),it("for | ..1, delimiter| correctly",(function(){a(r).to.changeAST("start =  .| ..1, .|",{rules:[{match:1}]}),a(r).to.changeAST("start =  .| ..1,''|",{rules:[{match:1}]}),a(r).to.changeAST("start =  .| ..1,[]|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| ..1, .|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| ..1,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| ..1,[]|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| ..1, .|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| ..1,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| ..1,[]|",{rules:[{match:1}]})})),it("for | ..3, delimiter| correctly",(function(){a(r).to.changeAST("start =  .| ..3, .|",{rules:[{match:1}]}),a(r).to.changeAST("start =  .| ..3,''|",{rules:[{match:1}]}),a(r).to.changeAST("start =  .| ..3,[]|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| ..3, .|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| ..3,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| ..3,[]|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| ..3, .|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| ..3,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = []| ..3,[]|",{rules:[{match:1}]})})),it("for |0.. , delimiter| correctly",(function(){a(r).to.changeAST("start =  .|0.. , .|",{rules:[{match:1}]}),a(r).to.changeAST("start =  .|0.. ,''|",{rules:[{match:1}]}),a(r).to.changeAST("start =  .|0.. ,[]|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''|0.. , .|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''|0.. ,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''|0.. ,[]|",{rules:[{match:1}]}),a(r).to.changeAST("start = []|0.. , .|",{rules:[{match:1}]}),a(r).to.changeAST("start = []|0.. ,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = []|0.. ,[]|",{rules:[{match:1}]})})),it("for |1.. , delimiter| correctly",(function(){a(r).to.changeAST("start =  .|1.. , .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|1.. ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|1.. ,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|1.. , .|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''|1.. ,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''|1.. ,[]|",{rules:[{match:1}]}),a(r).to.changeAST("start = []|1.. , .|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []|1.. ,''|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []|1.. ,[]|",{rules:[{match:-1}]})})),it("for |2.. , delimiter| correctly",(function(){a(r).to.changeAST("start =  .|2.. , .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|2.. ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|2.. ,[]|",{rules:[{match:-1}]}),a(r).to.changeAST("start = ''|2.. , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|2.. ,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''|2.. ,[]|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []|2.. , .|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []|2.. ,''|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []|2.. ,[]|",{rules:[{match:-1}]})})),it("for |2..3, delimiter| correctly",(function(){a(r).to.changeAST("start =  .|2..3, .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|2..3,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|2..3,[]|",{rules:[{match:-1}]}),a(r).to.changeAST("start = ''|2..3, .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|2..3,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''|2..3,[]|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []|2..3, .|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []|2..3,''|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []|2..3,[]|",{rules:[{match:-1}]})})),it("for | 42 , delimiter| correctly",(function(){a(r).to.changeAST("start =  .| 42 , .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .| 42 ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .| 42 ,[]|",{rules:[{match:-1}]}),a(r).to.changeAST("start = ''| 42 , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''| 42 ,''|",{rules:[{match:1}]}),a(r).to.changeAST("start = ''| 42 ,[]|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []| 42 , .|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []| 42 ,''|",{rules:[{match:-1}]}),a(r).to.changeAST("start = []| 42 ,[]|",{rules:[{match:-1}]})}))})),describe("with variable boundaries",(function(){it("for |   ..max, delimiter| correctly",(function(){a(r).to.changeAST("start =  .|   ..max, .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|   ..max,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|   ..max,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|   ..max, .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|   ..max,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|   ..max,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|   ..max, .|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|   ..max,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|   ..max,[]|",{rules:[{match:0}]})})),it("for |min..   , delimiter| correctly",(function(){a(r).to.changeAST("start =  .|min..   , .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|min..   ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|min..   ,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|min..   , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|min..   ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|min..   ,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|min..   , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|min..   ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|min..   ,[]|",{rules:[{match:0}]})})),it("for |min..max, delimiter| correctly",(function(){a(r).to.changeAST("start =  .|min..max, .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|min..max,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|min..max,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|min..max, .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|min..max,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|min..max,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|min..max, .|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|min..max,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|min..max,[]|",{rules:[{match:0}]})})),it("for | exact  , delimiter| correctly",(function(){a(r).to.changeAST("start =  .| exact  , .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .| exact  ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .| exact  ,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''| exact  , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''| exact  ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''| exact  ,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = []| exact  , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = []| exact  ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = []| exact  ,[]|",{rules:[{match:0}]})}))})),describe("with function boundaries",(function(){it("for |  ..{}, delimiter| correctly",(function(){a(r).to.changeAST("start =  .|   ..{}, .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|   ..{},''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|   ..{},[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|   ..{}, .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|   ..{},''|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|   ..{},[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|   ..{}, .|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|   ..{},''|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|   ..{},[]|",{rules:[{match:0}]})})),it("for |{}..  , delimiter| correctly",(function(){a(r).to.changeAST("start =  .|{}..   , .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|{}..   ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|{}..   ,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|{}..   , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|{}..   ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|{}..   ,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|{}..   , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|{}..   ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|{}..   ,[]|",{rules:[{match:0}]})})),it("for |{}..{}, delimiter| correctly",(function(){a(r).to.changeAST("start =  .|{}..{}, .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|{}..{},''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .|{}..{},[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|{}..{}, .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|{}..{},''|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''|{}..{},[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|{}..{}, .|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|{}..{},''|",{rules:[{match:0}]}),a(r).to.changeAST("start = []|{}..{},[]|",{rules:[{match:0}]})})),it("for |  {}  , delimiter| correctly",(function(){a(r).to.changeAST("start =  .| {}  , .|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .| {}  ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start =  .| {}  ,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''| {}  , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''| {}  ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = ''| {}  ,[]|",{rules:[{match:0}]}),a(r).to.changeAST("start = []| {}  , .|",{rules:[{match:0}]}),a(r).to.changeAST("start = []| {}  ,''|",{rules:[{match:0}]}),a(r).to.changeAST("start = []| {}  ,[]|",{rules:[{match:0}]})}))}))}))})),it("calculate |match| property for |group| correctly",(function(){a(r).to.changeAST("start = (.)",{rules:[{match:0}]}),a(r).to.changeAST("start = ('')",{rules:[{match:1}]}),a(r).to.changeAST("start = ([])",{rules:[{match:-1}]})})),it("calculate |match| property for |rule_ref| correctly",(function(){a(r).to.changeAST(["start = end","end = . "].join("\n"),{rules:[{match:0},{match:0}]}),a(r).to.changeAST(["start = end","end = ''"].join("\n"),{rules:[{match:1},{match:1}]}),a(r).to.changeAST(["start = end","end = []"].join("\n"),{rules:[{match:-1},{match:-1}]}),a(r).to.changeAST("start = .  start",{rules:[{match:0}]}),a(r).to.changeAST("start = '' start",{rules:[{match:0}]}),a(r).to.changeAST("start = [] start",{rules:[{match:-1}]}),a(r).to.changeAST("start = . start []",{rules:[{match:-1}]})}))})),inferenceMatchResult_spec}requireInferenceMatchResult_spec();var mergeCharacterClasses_spec={},hasRequiredMergeCharacterClasses_spec;function requireMergeCharacterClasses_spec(){if(hasRequiredMergeCharacterClasses_spec)return mergeCharacterClasses_spec;hasRequiredMergeCharacterClasses_spec=1;var e=require$$0,t=requireHelpers(),r=requireMergeCharacterClasses();e.use(t);var a=e.expect;return describe("compiler pass |mergeCharacterClasses|",(function(){it("Merges single character literals, class, and ref_rules",(function(){a(r).to.changeAST(["one = three / $('a' / 'd') / [c-f] / [efh] / [c-h] / [c-g]","two = 'P' / 'P' / three / 'P' / [Q-T]","three = $('x' / [u-w])","four = 'a' / [aaa] / 'a'"].join("\n"),{rules:[{name:"one",expression:{type:"class",parts:["a",["c","h"],["u","x"]],ignoreCase:!1,inverted:!1,location:{start:{line:1,column:7},end:{line:1,column:59}}}},{name:"two",expression:{type:"class",parts:[["P","T"],["u","x"]],ignoreCase:!1,inverted:!1,location:{start:{line:2,column:7},end:{line:2,column:38}}}},{name:"three",expression:{type:"class",parts:[["u","x"]],ignoreCase:!1,inverted:!1,location:{start:{line:3,column:9},end:{line:3,column:23}}}},{name:"four",expression:{type:"literal",value:"a",ignoreCase:!1,location:{start:{line:4,column:8},end:{line:4,column:25}}}}]},{mergeCharacterClasses:!0})})),it("Merges case-independent single character literals, class, and ref_rules",(function(){a(r).to.changeAST(["one = three / $('a'i / 'd'i) / [c-f]i / [efh]i / [c-h]i / [c-g]i","two = 'P'i / 'P'i / three / 'P'i / [Q-T]i","three = $('x'i / [u-w]i)","four = 'a'i / [aaa]i / 'a'i"].join("\n"),{rules:[{name:"one",expression:{type:"class",parts:["a",["c","h"],["u","x"]],ignoreCase:!0,inverted:!1,location:{start:{line:1,column:7},end:{line:1,column:65}}}},{name:"two",expression:{type:"class",parts:[["P","T"],["u","x"]],ignoreCase:!0,inverted:!1,location:{start:{line:2,column:7},end:{line:2,column:42}}}},{name:"three",expression:{type:"class",parts:[["u","x"]],ignoreCase:!0,inverted:!1,location:{start:{line:3,column:9},end:{line:3,column:25}}}},{name:"four",expression:{type:"literal",value:"a",ignoreCase:!0,location:{start:{line:4,column:8},end:{line:4,column:28}}}}]},{mergeCharacterClasses:!0})})),it("Doesn't merge inappropriately",(function(){a(r).to.changeAST(["case = action / 'a'i / [c-g]","invert = action / 'P' / [^Q-T]","action = 'x' { return 42; } / [u-w]"].join("\n"),{rules:[{name:"case",expression:{type:"choice",alternatives:[{type:"rule_ref",name:"action"},{type:"literal",value:"a",ignoreCase:!0},{type:"class",parts:[["c","g"]],ignoreCase:!1,inverted:!1}]}},{name:"invert",expression:{type:"choice",alternatives:[{type:"rule_ref",name:"action"},{type:"literal",value:"P",ignoreCase:!1},{type:"class",parts:[["Q","T"]],ignoreCase:!1,inverted:!0}]}},{name:"action",expression:{type:"choice",alternatives:[{type:"action"},{type:"class",parts:[["u","w"]],ignoreCase:!1,inverted:!1}]}}]},{mergeCharacterClasses:!0})})),it("Handles undefined rule_refs",(function(){a(r).to.changeAST(["start = unknown / 'a' / [c-g]"].join("\n"),{rules:[{name:"start",expression:{type:"choice",alternatives:[{type:"rule_ref",name:"unknown"},{type:"class",parts:["a",["c","g"]],ignoreCase:!1,inverted:!1}]}}]},{mergeCharacterClasses:!0})}))})),mergeCharacterClasses_spec}requireMergeCharacterClasses_spec();var removeProxyRules_spec={},hasRequiredRemoveProxyRules_spec;function requireRemoveProxyRules_spec(){if(hasRequiredRemoveProxyRules_spec)return removeProxyRules_spec;hasRequiredRemoveProxyRules_spec=1;var e=require$$0,t=requireHelpers(),r=requireRemoveProxyRules();e.use(t);var a=e.expect;return describe("compiler pass |removeProxyRules|",(function(){describe("when a proxy rule isn't listed in |allowedStartRules|",(function(){it("updates references and removes it",(function(){a(r).to.changeAST(["start = proxy","proxy = proxied","proxied = 'a'"].join("\n"),{rules:[{name:"start",expression:{type:"rule_ref",name:"proxied"}},{name:"proxied"}]},{allowedStartRules:["start"]})}))})),describe("when a proxy rule is listed in |allowedStartRules|",(function(){it("updates references but doesn't remove it",(function(){a(r).to.changeAST(["start = proxy","proxy = proxied","proxied = 'a'"].join("\n"),{rules:[{name:"start",expression:{type:"rule_ref",name:"proxied"}},{name:"proxy",expression:{type:"rule_ref",name:"proxied"}},{name:"proxied"}]},{allowedStartRules:["start","proxy"]})}))}))})),removeProxyRules_spec}requireRemoveProxyRules_spec();var reportDuplicateImports_spec={},hasRequiredReportDuplicateImports_spec;function requireReportDuplicateImports_spec(){if(hasRequiredReportDuplicateImports_spec)return reportDuplicateImports_spec;hasRequiredReportDuplicateImports_spec=1;var e=require$$0,t=requireHelpers(),r=requireReportDuplicateImports();e.use(t);var a=e.expect;return describe("compiler pass |reportDuplicateImports|",(function(){it("Errors when the same import all name is used twice",(function(){a(r).to.reportError('\nimport {unrelated} from "./foo.js"\nimport * as foo from "./foo.js"\nimport * as foo from "./bar.js"\n\na = foo.one\n',{message:'Module "foo" is already imported'})}))})),reportDuplicateImports_spec}requireReportDuplicateImports_spec();var reportDuplicateLabels_spec={},hasRequiredReportDuplicateLabels_spec;function requireReportDuplicateLabels_spec(){if(hasRequiredReportDuplicateLabels_spec)return reportDuplicateLabels_spec;hasRequiredReportDuplicateLabels_spec=1;var e=require$$0,t=requireHelpers(),r=requireReportDuplicateLabels();e.use(t);var a=e.expect;return describe("compiler pass |reportDuplicateLabels|",(function(){describe("in a sequence",(function(){it("reports labels duplicate with labels of preceding elements",(function(){a(r).to.reportError("start = a:'a' a:'a'",{message:'Label "a" is already defined',location:{source:void 0,start:{offset:14,line:1,column:15},end:{offset:15,line:1,column:16}},diagnostics:[{message:"Original label location",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:9,line:1,column:10}}}]})})),it("doesn't report labels duplicate with labels in subexpressions",(function(){a(r).to.not.reportError("start = ('a' / a:'a' / 'a') a:'a'"),a(r).to.not.reportError("start = (a:'a' { }) a:'a'"),a(r).to.not.reportError("start = ('a' a:'a' 'a') a:'a'"),a(r).to.not.reportError("start = b:(a:'a') a:'a'"),a(r).to.not.reportError("start = $(a:'a') a:'a'"),a(r).to.not.reportError("start = &(a:'a') a:'a'"),a(r).to.not.reportError("start = !(a:'a') a:'a'"),a(r).to.not.reportError("start = (a:'a')? a:'a'"),a(r).to.not.reportError("start = (a:'a')* a:'a'"),a(r).to.not.reportError("start = (a:'a')+ a:'a'"),a(r).to.not.reportError("start = (a:'a')|2..3| a:'a'"),a(r).to.not.reportError("start = 'a'|2..3, a:'a'| a:'a'"),a(r).to.not.reportError("start = (a:'a') a:'a'")}))})),describe("in a choice",(function(){it("doesn't report labels duplicate with labels of preceding alternatives",(function(){a(r).to.not.reportError("start = a:'a' / a:'a'")}))})),describe("in outer sequence",(function(){it("reports labels duplicate with labels of preceding elements",(function(){a(r).to.reportError("start = a:'a' (a:'a')",{message:'Label "a" is already defined',location:{source:void 0,start:{offset:15,line:1,column:16},end:{offset:16,line:1,column:17}},diagnostics:[{message:"Original label location",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:9,line:1,column:10}}}]})})),it("doesn't report labels duplicate with the label of the current element",(function(){a(r).to.not.reportError("start = a:(a:'a')")})),it("doesn't report labels duplicate with labels of following elements",(function(){a(r).to.not.reportError("start = (a:'a') a:'a'")}))}))})),reportDuplicateLabels_spec}requireReportDuplicateLabels_spec();var reportDuplicateRules_spec={},hasRequiredReportDuplicateRules_spec;function requireReportDuplicateRules_spec(){if(hasRequiredReportDuplicateRules_spec)return reportDuplicateRules_spec;hasRequiredReportDuplicateRules_spec=1;var e=require$$0,t=requireHelpers(),r=requireReportDuplicateRules();e.use(t);var a=e.expect;return describe("compiler pass |reportDuplicateRules|",(function(){it("reports duplicate rules",(function(){a(r).to.reportError(["start = 'a'","start = 'b'"].join("\n"),{message:'Rule "start" is already defined',location:{source:void 0,start:{offset:12,line:2,column:1},end:{offset:17,line:2,column:6}},diagnostics:[{message:"Original rule location",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:5,line:1,column:6}}}]})}))})),reportDuplicateRules_spec}requireReportDuplicateRules_spec();var reportIncorrectPlucking_spec={},hasRequiredReportIncorrectPlucking_spec;function requireReportIncorrectPlucking_spec(){if(hasRequiredReportIncorrectPlucking_spec)return reportIncorrectPlucking_spec;hasRequiredReportIncorrectPlucking_spec=1;var e=require$$0,t=requireHelpers(),r=requireReportIncorrectPlucking();e.use(t);var a=e.expect;return describe("compiler pass |reportIncorrectPlucking|",(function(){it('prevents "@" from being used with an action block',(function(){a(r).to.reportError("start1 = 'a' @'b' 'c' { /* empty action block */ }",{message:'"@" cannot be used with an action block',location:{source:void 0,start:{offset:13,line:1,column:14},end:{offset:14,line:1,column:15}},diagnostics:[{message:"Action block location",location:{source:void 0,start:{offset:23,line:1,column:24},end:{offset:49,line:1,column:50}}}]}),a(r).to.reportError("start2 = 'a' @('b' @'c' { /* empty action block */ })",{message:'"@" cannot be used with an action block',location:{source:void 0,start:{offset:19,line:1,column:20},end:{offset:20,line:1,column:21}},diagnostics:[{message:"Action block location",location:{source:void 0,start:{offset:25,line:1,column:26},end:{offset:51,line:1,column:52}}}]})})),it("allows valid plucking",(function(){a(r).not.to.reportError("\n\n      start1 =  @'1'               // return '1'\n      start2 =  @'1' / @'2'        // return '1' or '2'\n      start2 =   '1'   @'2' '3'    // return '2'\n      start3 =   '1' @b:'2' '3'    // return '2', label \"b\" can be used in semantic predicates\n      start4 = a:'1' @b:'2' '3'    // return '2', labels \"a\" and \"b\" can be used in semantic predicates\n      start5 =  @'1'   @'2' '3'    // return ['1', '2']\n      start6 =  @'1' @b:'2' '3'    // return ['1', '2'], label \"b\" can be used in semantic predicates\n      start7 = a:'1'   @'2' &{}    // return '2' if the semantic predicate doesnt fail\n      start8 = @a:$[a-z]i+ &{ return a === 'foo' } // return \"foo\"\n\n    ")}))})),reportIncorrectPlucking_spec}requireReportIncorrectPlucking_spec();var reportInfiniteRecursion_spec={},hasRequiredReportInfiniteRecursion_spec;function requireReportInfiniteRecursion_spec(){if(hasRequiredReportInfiniteRecursion_spec)return reportInfiniteRecursion_spec;hasRequiredReportInfiniteRecursion_spec=1;var e=require$$0,t=requireHelpers(),r=requireReportInfiniteRecursion();e.use(t);var a=e.expect;return describe("compiler pass |reportInfiniteRecursion|",(function(){it("reports direct left recursion",(function(){a(r).to.reportError("start = start",{message:"Possible infinite loop when parsing (left recursion: start -> start)",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:5,line:1,column:6}}})})),it("reports indirect left recursion",(function(){a(r).to.reportError(["start = stop","stop = start"].join("\n"),{message:"Possible infinite loop when parsing (left recursion: start -> stop -> start)",location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:5,line:1,column:6}}})})),describe("in sequences",(function(){it("reports left recursion if all preceding elements match empty string",(function(){a(r).to.reportError("start = '' '' '' start")})),it("doesn't report left recursion if some preceding element doesn't match empty string",(function(){a(r).to.not.reportError("start = 'a' '' '' start"),a(r).to.not.reportError("start = '' 'a' '' start"),a(r).to.not.reportError("start = '' '' 'a' start")})),it("reports left recursion when rule reference is wrapped in an expression",(function(){a(r).to.reportError("start = '' start?")})),it("computes expressions that always consume input on success correctly",(function(){a(r).to.reportError(["start = a start","a 'a' = ''"].join("\n")),a(r).to.not.reportError(["start = a start","a 'a' = 'a'"].join("\n")),a(r).to.reportError("start = ('' / 'a' / 'b') start"),a(r).to.reportError("start = ('a' / '' / 'b') start"),a(r).to.reportError("start = ('a' / 'b' / '') start"),a(r).to.not.reportError("start = ('a' / 'b' / 'c') start"),a(r).to.reportError("start = ('' { }) start"),a(r).to.not.reportError("start = ('a' { }) start"),a(r).to.reportError("start = ('' '' '') start"),a(r).to.not.reportError("start = ('a' '' '') start"),a(r).to.not.reportError("start = ('' 'a' '') start"),a(r).to.not.reportError("start = ('' '' 'a') start"),a(r).to.reportError("start = a:'' start"),a(r).to.not.reportError("start = a:'a' start"),a(r).to.reportError("start = $'' start"),a(r).to.not.reportError("start = $'a' start"),a(r).to.reportError("start = &'' start"),a(r).to.reportError("start = &'a' start"),a(r).to.reportError("start = !'' start"),a(r).to.reportError("start = !'a' start"),a(r).to.reportError("start = ''? start"),a(r).to.reportError("start = 'a'? start"),a(r).to.reportError("start = ''* start"),a(r).to.reportError("start = 'a'* start"),a(r).to.reportError("start = ''+ start"),a(r).to.not.reportError("start = 'a'+ start"),a(r).to.reportError("start = ''| .. | start"),a(r).to.reportError("start = ''|0.. | start"),a(r).to.reportError("start = ''|1.. | start"),a(r).to.reportError("start = ''|2.. | start"),a(r).to.reportError("start = ''| ..1| start"),a(r).to.reportError("start = ''| ..3| start"),a(r).to.reportError("start = ''|2..3| start"),a(r).to.reportError("start = ''| 42 | start"),a(r).to.reportError("start = 'a'| .. | start"),a(r).to.reportError("start = 'a'|0.. | start"),a(r).to.not.reportError("start = 'a'|1.. | start"),a(r).to.not.reportError("start = 'a'|2.. | start"),a(r).to.reportError("start = 'a'| ..1| start"),a(r).to.reportError("start = 'a'| ..3| start"),a(r).to.not.reportError("start = 'a'|2..3| start"),a(r).to.not.reportError("start = 'a'| 42 | start"),a(r).to.reportError("start = ('') start"),a(r).to.not.reportError("start = ('a') start"),a(r).to.reportError("start = &{ } start"),a(r).to.reportError("start = !{ } start"),a(r).to.reportError(["start = a start","a = ''"].join("\n")),a(r).to.not.reportError(["start = a start","a = 'a'"].join("\n")),a(r).to.reportError("start = '' start"),a(r).to.not.reportError("start = 'a' start"),a(r).to.not.reportError("start = [a-d] start"),a(r).to.not.reportError("start = . start")}))})),describe("in repeated with delimiter",(function(){it("doesn't report left recursion for delimiter if expression not match empty string",(function(){a(r).to.not.reportError("start = 'a'| .. , start|"),a(r).to.not.reportError("start = 'a'|0.. , start|"),a(r).to.not.reportError("start = 'a'|1.. , start|"),a(r).to.not.reportError("start = 'a'|2.. , start|"),a(r).to.not.reportError("start = 'a'| ..3, start|"),a(r).to.not.reportError("start = 'a'|2..3, start|"),a(r).to.not.reportError("start = 'a'| 42 , start|")})),it("reports left recursion for delimiter if expression match empty string",(function(){a(r).to.reportError("start = ''| .. , start|"),a(r).to.reportError("start = ''|0.. , start|"),a(r).to.reportError("start = ''|1.. , start|"),a(r).to.reportError("start = ''|2.. , start|"),a(r).to.reportError("start = ''| ..3, start|"),a(r).to.reportError("start = ''|2..3, start|"),a(r).to.reportError("start = ''| 42 , start|")})),it("does not inifinite loop",(function(){a(r).to.reportError('\n        start = expr*\n\n        expr\n          = expr "++"\n      ',{message:"Possible infinite loop when parsing (left recursion: start -> expr -> expr)"})}))}))})),reportInfiniteRecursion_spec}requireReportInfiniteRecursion_spec();var reportInfiniteRepetition_spec={},hasRequiredReportInfiniteRepetition_spec;function requireReportInfiniteRepetition_spec(){if(hasRequiredReportInfiniteRepetition_spec)return reportInfiniteRepetition_spec;hasRequiredReportInfiniteRepetition_spec=1;var e=require$$0,t=requireHelpers(),r=requireReportInfiniteRepetition();e.use(t);var a=e.expect;return describe("compiler pass |reportInfiniteRepetition|",(function(){it("reports infinite loops for zero_or_more",(function(){a(r).to.reportError("start = ('')*",{message:"Possible infinite loop when parsing (repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:13,line:1,column:14}}})})),it("reports infinite loops for one_or_more",(function(){a(r).to.reportError("start = ('')+",{message:"Possible infinite loop when parsing (repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:13,line:1,column:14}}})})),describe("reports infinite loops for repeated",(function(){describe("without delimiter",(function(){it("with constant boundaries",(function(){a(r).to.reportError("start = ('')|..|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:16,line:1,column:17}}}),a(r).to.reportError("start = ('')|0..|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:17,line:1,column:18}}}),a(r).to.reportError("start = ('')|1..|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:17,line:1,column:18}}}),a(r).to.reportError("start = ('')|2..|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:17,line:1,column:18}}}),a(r).to.not.reportError("start = ('')| ..1|"),a(r).to.not.reportError("start = ('')| ..3|"),a(r).to.not.reportError("start = ('')|2..3|"),a(r).to.not.reportError("start = ('')| 42 |")})),it("with variable boundaries",(function(){a(r).to.reportError("start = ('')|len..|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:19,line:1,column:20}}}),a(r).to.not.reportError("start = ('')|..len|"),a(r).to.not.reportError("start = ('')|len1..len2|"),a(r).to.not.reportError("start = ('')|len|")})),it("with function boundaries",(function(){a(r).to.reportError("start = ('')|{}..|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:18,line:1,column:19}}}),a(r).to.not.reportError("start = ('')|..{}|"),a(r).to.not.reportError("start = ('')|{}..{}|"),a(r).to.not.reportError("start = ('')|{}|")}))})),describe("with empty delimiter",(function(){it("with constant boundaries",(function(){a(r).to.reportError("start = ('')| .., ''|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:21,line:1,column:22}}}),a(r).to.reportError("start = ('')|0.., ''|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:21,line:1,column:22}}}),a(r).to.reportError("start = ('')|1.., ''|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:21,line:1,column:22}}}),a(r).to.reportError("start = ('')|2.., ''|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:21,line:1,column:22}}}),a(r).to.not.reportError("start = ('')| ..1, ''|"),a(r).to.not.reportError("start = ('')| ..3, ''|"),a(r).to.not.reportError("start = ('')|2..3, ''|"),a(r).to.not.reportError("start = ('')| 42 , ''|")})),it("with variable boundaries",(function(){a(r).to.reportError("start = ('')|len.., ''|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:23,line:1,column:24}}}),a(r).to.not.reportError("start = ('')|..len, ''|"),a(r).to.not.reportError("start = ('')|len1..len2, ''|"),a(r).to.not.reportError("start = ('')|len, ''|")})),it("with function boundaries",(function(){a(r).to.reportError("start = ('')|{}.., ''|",{message:"Possible infinite loop when parsing (unbounded range repetition used with an expression that may not consume any input)",location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:22,line:1,column:23}}}),a(r).to.not.reportError("start = ('')|..{}, ''|"),a(r).to.not.reportError("start = ('')|{}..{}, ''|"),a(r).to.not.reportError("start = ('')|{}, ''|")}))})),describe("with non-empty delimiter",(function(){it("with constant boundaries",(function(){a(r).to.not.reportError("start = ('')| .., 'a'|"),a(r).to.not.reportError("start = ('')|0.., 'a'|"),a(r).to.not.reportError("start = ('')|1.., 'a'|"),a(r).to.not.reportError("start = ('')|2.., 'a'|"),a(r).to.not.reportError("start = ('')| ..1, 'a'|"),a(r).to.not.reportError("start = ('')| ..3, 'a'|"),a(r).to.not.reportError("start = ('')|2..3, 'a'|"),a(r).to.not.reportError("start = ('')| 42 , 'a'|")})),it("with variable boundaries",(function(){a(r).to.not.reportError("start = ('')|len.., 'a'|"),a(r).to.not.reportError("start = ('')|..len, 'a'|"),a(r).to.not.reportError("start = ('')|len1..len2, 'a'|"),a(r).to.not.reportError("start = ('')|len, 'a'|")})),it("with function boundaries",(function(){a(r).to.not.reportError("start = ('')|{}.., 'a'|"),a(r).to.not.reportError("start = ('')|..{}, 'a'|"),a(r).to.not.reportError("start = ('')|{}..{}, 'a'|"),a(r).to.not.reportError("start = ('')|{}, 'a'|")}))}))})),it("computes expressions that always consume input on success correctly",(function(){a(r).to.reportError(["start = a*","a 'a' = ''"].join("\n")),a(r).to.not.reportError(["start = a*","a 'a' = 'a'"].join("\n")),a(r).to.reportError("start = ('' / 'a' / 'b')*"),a(r).to.reportError("start = ('a' / '' / 'b')*"),a(r).to.reportError("start = ('a' / 'b' / '')*"),a(r).to.not.reportError("start = ('a' / 'b' / 'c')*"),a(r).to.reportError("start = ('' { })*"),a(r).to.not.reportError("start = ('a' { })*"),a(r).to.reportError("start = ('' '' '')*"),a(r).to.not.reportError("start = ('a' '' '')*"),a(r).to.not.reportError("start = ('' 'a' '')*"),a(r).to.not.reportError("start = ('' '' 'a')*"),a(r).to.reportError("start = (a:'')*"),a(r).to.not.reportError("start = (a:'a')*"),a(r).to.reportError("start = ($'')*"),a(r).to.not.reportError("start = ($'a')*"),a(r).to.reportError("start = (&'')*"),a(r).to.reportError("start = (&'a')*"),a(r).to.reportError("start = (!'')*"),a(r).to.reportError("start = (!'a')*"),a(r).to.reportError("start = (''?)*"),a(r).to.reportError("start = ('a'?)*"),a(r).to.reportError("start = (''*)*"),a(r).to.reportError("start = ('a'*)*"),a(r).to.reportError("start = (''+)*"),a(r).to.not.reportError("start = ('a'+)*"),a(r).to.reportError("start = ('')*"),a(r).to.not.reportError("start = ('a')*"),a(r).to.reportError("start = (&{ })*"),a(r).to.reportError("start = (!{ })*"),a(r).to.reportError("start = 'a'|.., ('')*|"),a(r).to.not.reportError("start = 'a'|.., ('b')*|"),a(r).to.reportError(["start = a*","a = ''"].join("\n")),a(r).to.not.reportError(["start = a*","a = 'a'"].join("\n")),a(r).to.reportError("start = ''*"),a(r).to.not.reportError("start = 'a'*"),a(r).to.not.reportError("start = [a-d]*"),a(r).to.not.reportError("start = .*")}))})),reportInfiniteRepetition_spec}requireReportInfiniteRepetition_spec();var reportUndefinedRules_spec={},hasRequiredReportUndefinedRules_spec;function requireReportUndefinedRules_spec(){if(hasRequiredReportUndefinedRules_spec)return reportUndefinedRules_spec;hasRequiredReportUndefinedRules_spec=1;var e=require$$0,t=requireHelpers(),r=requireReportUndefinedRules();e.use(t);var a=e.expect;return describe("compiler pass |reportUndefinedRules|",(function(){it("reports undefined rules",(function(){a(r).to.reportError("start = undefined",{message:'Rule "undefined" is not defined',location:{source:void 0,start:{offset:8,line:1,column:9},end:{offset:17,line:1,column:18}}})}))})),reportUndefinedRules_spec}requireReportUndefinedRules_spec();var stack_spec={},hasRequiredStack_spec;function requireStack_spec(){if(hasRequiredStack_spec)return stack_spec;hasRequiredStack_spec=1;var e=require$$0,t=requireStack(),r=e.expect;return describe("utility class Stack",(function(){describe("for an empty stack",(function(){var e=void 0;beforeEach((function(){e=new t("rule","v","let",[42])})),describe("throws an error when attempting",(function(){it("`pop`",(function(){r((function(){return e.pop()})).to.throw(RangeError,"Rule 'rule': The variable stack underflow: attempt to use a variable 'v<x>' at an index -1.\nBytecode: 42")})),it("`top`",(function(){r((function(){return e.top()})).to.throw(RangeError,"Rule 'rule': The variable stack underflow: attempt to use a variable 'v<x>' at an index -1.\nBytecode: 42")})),it("`result`",(function(){r((function(){return e.result()})).to.throw(RangeError,"Rule 'rule': The variable stack is empty, can't get the result")})),it("`index`",(function(){r((function(){return e.index(-2)})).to.throw(RangeError,"Rule 'rule': The variable stack overflow: attempt to get a variable at a negative index -2.\nBytecode: 42"),r((function(){return e.index(0)})).to.throw(RangeError,"Rule 'rule': The variable stack underflow: attempt to use a variable 'v<x>' at an index -1.\nBytecode: 42"),r((function(){return e.index(2)})).to.throw(RangeError,"Rule 'rule': The variable stack underflow: attempt to use a variable 'v<x>' at an index -3.\nBytecode: 42")})),it("`sourceMapPop`",(function(){r((function(){return e.sourceMapPop()})).to.throw(RangeError,"Rule 'rule': Attempting to pop an empty source map stack.\nBytecode: 42")}))})),it("`defines` returns an empty string",(function(){r(e.defines()).to.equal("")}))})),it("throws an error when attempting `pop` more than `push`",(function(){var e=new t("rule","v","let",[42]);e.push("1"),r((function(){return e.pop(3)})).to.throw(RangeError,"Rule 'rule': The variable stack underflow: attempt to use a variable 'v<x>' at an index -2.\nBytecode: 42")})),it("returns a variable with an index 0 for `result`",(function(){var e=new t("rule","v","let",[]);e.push("1"),r(e.result()).to.equal("v0")})),it("`defines` returns a define expression for all used variables",(function(){var e=new t("rule","v","let",[]);e.push("1"),e.push("2"),e.pop(),e.push("3"),r(e.defines()).to.equal("let v0, v1;")})),describe("`checkedIf` method",(function(){var e=void 0;beforeEach((function(){(e=new t("rule","v","let",[42])).push("1")})),describe("does not throws an error",(function(){it("without the else brach",(function(){r((function(){return e.checkedIf(0,(function(){}))})).to.not.throw(),r((function(){return e.checkedIf(0,(function(){return e.pop()}))})).to.not.throw(),r((function(){return e.checkedIf(0,(function(){return e.push("2")}))})).to.not.throw()})),describe("when the stack pointer",(function(){it("was not moving in both the arms",(function(){function t(){}function a(){e.push("1"),e.pop()}function n(){e.push("1"),e.push("2"),e.pop(2)}function o(){e.push("1"),e.pop(),e.push("2"),e.pop()}r((function(){return e.checkedIf(0,t,t)})).to.not.throw(),r((function(){return e.checkedIf(0,a,a)})).to.not.throw(),r((function(){return e.checkedIf(0,n,n)})).to.not.throw(),r((function(){return e.checkedIf(0,o,o)})).to.not.throw()})),it("increases on the same value in both the arms",(function(){r((function(){return e.checkedIf(0,(function(){return e.push("1")}),(function(){return e.push("2")}))})).to.not.throw()})),it("decreases on the same value in both the arms",(function(){e.push("2"),r((function(){return e.checkedIf(0,(function(){return e.pop(2)}),(function(){e.pop(),e.pop()}))})).to.not.throw()}))}))})),describe("throws an error when the stack pointer",(function(){it("was not moving in `if` and decreases in `then`",(function(){r((function(){e.checkedIf(0,(function(){}),(function(){return e.pop()}))})).to.throw(Error,"Rule 'rule', position 0: Branches of a condition can't move the stack pointer differently (before: 0, after then: 0, after else: -1). Bytecode: 42")})),it("decreases in `if` and was not moving in `then`",(function(){r((function(){e.checkedIf(0,(function(){return e.pop()}),(function(){}))})).to.throw(Error,"Rule 'rule', position 0: Branches of a condition can't move the stack pointer differently (before: 0, after then: -1, after else: 0). Bytecode: 42")})),it("was not moving in `if` and increases in `then`",(function(){r((function(){e.checkedIf(0,(function(){}),(function(){return e.push("2")}))})).to.throw(Error,"Rule 'rule', position 0: Branches of a condition can't move the stack pointer differently (before: 0, after then: 0, after else: 1). Bytecode: 42")})),it("increases in `if` and was not moving in `then`",(function(){r((function(){e.checkedIf(0,(function(){return e.push("2")}),(function(){}))})).to.throw(Error,"Rule 'rule', position 0: Branches of a condition can't move the stack pointer differently (before: 0, after then: 1, after else: 0). Bytecode: 42")})),it("decreases in `if` and increases in `then`",(function(){r((function(){e.checkedIf(0,(function(){return e.pop()}),(function(){return e.push("2")}))})).to.throw(Error,"Rule 'rule', position 0: Branches of a condition can't move the stack pointer differently (before: 0, after then: -1, after else: 1). Bytecode: 42")})),it("increases in `if` and decreases in `then`",(function(){r((function(){e.checkedIf(0,(function(){return e.push("2")}),(function(){return e.pop()}))})).to.throw(Error,"Rule 'rule', position 0: Branches of a condition can't move the stack pointer differently (before: 0, after then: 1, after else: -1). Bytecode: 42")}))}))})),describe("`checkedLoop` method",(function(){var e=void 0;beforeEach((function(){(e=new t("rule","v","let",[42])).push("1")})),it("does not throws an error when the stack pointer was not moving",(function(){function t(){}function a(){e.push("1"),e.pop()}function n(){e.push("1"),e.push("2"),e.pop(2)}function o(){e.push("1"),e.pop(),e.push("2"),e.pop()}r((function(){return e.checkedLoop(0,t)})).to.not.throw(),r((function(){return e.checkedLoop(0,a)})).to.not.throw(),r((function(){return e.checkedLoop(0,n)})).to.not.throw(),r((function(){return e.checkedLoop(0,o)})).to.not.throw()})),it("throws an error when the stack pointer increases",(function(){r((function(){return e.checkedLoop(0,(function(){return e.push("1")}))})).to.throw(Error,"Rule 'rule', position 0: Body of a loop can't move the stack pointer (before: 0, after: 1). Bytecode: 42")})),it("throws an error when the stack pointer decreases",(function(){r((function(){return e.checkedLoop(0,(function(){return e.pop()}))})).to.throw(Error,"Rule 'rule', position 0: Body of a loop can't move the stack pointer (before: 0, after: -1). Bytecode: 42")}))})),describe("SourceNode handling",(function(){it("sourceNode handles unknown column",(function(){r(t.sourceNode({source:"",start:{line:1,column:0,offset:0},end:{line:1,column:0,offset:0}},["foo"],"test").column).to.equal(null)}))}))})),stack_spec}requireStack_spec();var utils_spec={},hasRequiredUtils_spec;function requireUtils_spec(){if(hasRequiredUtils_spec)return utils_spec;hasRequiredUtils_spec=1;var e=require$$0,t=requireUtils$1(),r=t.hex,a=t.stringEscape,n=t.regexpClassEscape,o=t.base64,s=e.expect;return describe("utility functions",(function(){it("hex",(function(){s(r("0")).to.equal("30"),s(r("\0")).to.equal("0"),s(r("\n")).to.equal("A"),s(r("\ufeff")).to.equal("FEFF")})),it("stringEscape",(function(){s(a("abc")).to.equal("abc"),s(a('\\"\0\b\t\n\v\f\r')).to.equal('\\\\\\"\\0\\b\\t\\n\\v\\f\\r'),s(a("")).to.equal("\\x01\\x0F"),s(a("")).to.equal("\\x10\\x1F\\x7F"),s(a("")).to.equal("\\u0100\\u0FFF"),s(a("")).to.equal("\\u1000\\uFFFF")})),it("regexpClassEscape",(function(){s(n("\\\0\b\t\n\v\f\r")).to.equal("\\\\\\0\\b\\t\\n\\v\\f\\r"),s(n("/]^-")).to.equal("\\/\\]\\^\\-"),s(n("")).to.equal("\\x01\\x0F"),s(n("")).to.equal("\\x10\\x1F\\x7F"),s(n("")).to.equal("\\u0100\\u0FFF"),s(n("")).to.equal("\\u1000\\uFFFF")})),it("base64",(function(){s(o(new Uint8Array([]))).to.equal(""),s(o(new Uint8Array([97]))).to.equal("YQ=="),s(o(new Uint8Array([97,98]))).to.equal("YWI="),s(o(new Uint8Array([97,98,99]))).to.equal("YWJj"),s(o(new Uint8Array([97,98,99,100]))).to.equal("YWJjZA=="),s(o(new Uint8Array([97,98,99,100,101]))).to.equal("YWJjZGU="),s(o(new Uint8Array([97,98,99,100,101,102]))).to.equal("YWJjZGVm")}))})),utils_spec}requireUtils_spec();var grammarError_spec={},hasRequiredGrammarError_spec;function requireGrammarError_spec(){if(hasRequiredGrammarError_spec)return grammarError_spec;hasRequiredGrammarError_spec=1;var e=require$$0,t=requirePeg(),r=t.GrammarError,a=t.GrammarLocation,n=e.expect,o={source:void 0,start:{offset:0,line:1,column:1},end:{offset:4,line:1,column:5}};return describe("Grammar Errors",(function(){it("might not have a location",(function(){var e=new r("message");n(e.location).to.equal(void 0),n(e.toString()).to.equal("GrammarError: message")})),it("might have locations",(function(){o.source=void 0;var e=new r("message",o);n(e.location).to.eql(o),n(e.toString()).to.equal("GrammarError: message\n at 1:1"),e=new r("message",null,[{message:"Subinfo",location:o}]),n(e.location).to.equal(null),n(e.toString()).to.equal("GrammarError: message\n from 1:1: Subinfo"),o.source="foo.peggy",e=new r("message",o,[{message:"Subinfo",location:o}]),n(e.toString()).to.equal("GrammarError: message\n at foo.peggy:1:1\n from foo.peggy:1:1: Subinfo")})),describe("formats",(function(){var e={source:"foo.peggy",text:"some error\nthat"},t={source:"foo.peggy",start:{offset:5,line:1,column:6},end:{offset:11,line:2,column:1}},s=[{message:"Subinfo",location:t}];describe("single problem",(function(){describe("with main location",(function(){o.source="foo.peggy";var t=new r("message",o,s);it("with zero-length error at the end",(function(){var t=new r("message",{source:"foo.peggy",start:{offset:4,line:1,column:5},end:{offset:4,line:1,column:5}});n(t.format([e])).to.equal("error: message\n --\x3e foo.peggy:1:5\n  |\n1 | some error\n  |     ^")})),it("with source",(function(){n(t.format([e])).to.equal("error: message\n --\x3e foo.peggy:1:1\n  |\n1 | some error\n  | ^^^^\nnote: Subinfo\n --\x3e foo.peggy:1:6\n  |\n1 | some error\n  |      ^^^^^")})),it("without source",(function(){n(t.format([])).to.equal("error: message\n at foo.peggy:1:1\n at foo.peggy:1:6: Subinfo")}))})),describe("without main location",(function(){var t=new r("message",null,s);it("with source",(function(){n(t.format([e])).to.equal("error: message\nnote: Subinfo\n --\x3e foo.peggy:1:6\n  |\n1 | some error\n  |      ^^^^^")})),it("without source",(function(){n(t.format([])).to.equal("error: message\n at foo.peggy:1:6: Subinfo")}))}))})),describe("several problems",(function(){describe("with main location",(function(){o.source="foo.peggy";var i=new r("message",o,s);i.problems.push(["warning","Warning message",t,[{message:"Warning Subinfo",location:t}]]),i.problems.push(["info","Info message",null,[]]),it("null source text",(function(){n(i.format([{source:null,text:null}])).to.equal("error: message\n at foo.peggy:1:1\n at foo.peggy:1:6: Subinfo\n\nwarning: Warning message\n at foo.peggy:1:6\n at foo.peggy:1:6: Warning Subinfo"),n(i.format([{source:null,text:void 0}])).to.equal("error: message\n at foo.peggy:1:1\n at foo.peggy:1:6: Subinfo\n\nwarning: Warning message\n at foo.peggy:1:6\n at foo.peggy:1:6: Warning Subinfo")})),it("with source",(function(){n(i.format([e])).to.equal("error: message\n --\x3e foo.peggy:1:1\n  |\n1 | some error\n  | ^^^^\nnote: Subinfo\n --\x3e foo.peggy:1:6\n  |\n1 | some error\n  |      ^^^^^\n\nwarning: Warning message\n --\x3e foo.peggy:1:6\n  |\n1 | some error\n  |      ^^^^^\nnote: Warning Subinfo\n --\x3e foo.peggy:1:6\n  |\n1 | some error\n  |      ^^^^^")})),it("with GrammarLocation",(function(){var r=new a("foo.peggy",{offset:12,line:15,column:8});n(String(r)).to.equal("foo.peggy"),o.source=r,t.source=r,i.diagnostics.push({message:"Column not offset",location:{source:r,start:{offset:11,line:2,column:1},end:{offset:15,line:2,column:5}}}),n(i.format([{source:r,text:e.text}])).to.equal("error: message\n --\x3e foo.peggy:15:8\n   |\n15 | some error\n   | ^^^^\nnote: Subinfo\n --\x3e foo.peggy:15:13\n   |\n15 | some error\n   |      ^^^^^\nnote: Column not offset\n --\x3e foo.peggy:16:1\n   |\n16 | that\n   | ^^^^\n\nwarning: Warning message\n --\x3e foo.peggy:15:13\n   |\n15 | some error\n   |      ^^^^^\nnote: Warning Subinfo\n --\x3e foo.peggy:15:13\n   |\n15 | some error\n   |      ^^^^^"),o.source="foo.peggy",t.source="foo.peggy",i.diagnostics.pop()})),it("without source",(function(){n(i.format([])).to.equal("error: message\n at foo.peggy:1:1\n at foo.peggy:1:6: Subinfo\n\nwarning: Warning message\n at foo.peggy:1:6\n at foo.peggy:1:6: Warning Subinfo")}))})),describe("without main location",(function(){var a=new r("message",null,s);a.problems.push(["warning","Warning message",null,[{message:"Warning Subinfo",location:t}]]),a.problems.push(["info","Info message",null,[]]),it("with source",(function(){n(a.format([e])).to.equal("error: message\nnote: Subinfo\n --\x3e foo.peggy:1:6\n  |\n1 | some error\n  |      ^^^^^\n\nwarning: Warning message\nnote: Warning Subinfo\n --\x3e foo.peggy:1:6\n  |\n1 | some error\n  |      ^^^^^")})),it("without source",(function(){n(a.format([])).to.equal("error: message\n at foo.peggy:1:6: Subinfo\n\nwarning: Warning message\n at foo.peggy:1:6: Warning Subinfo")}))}))}))}))})),grammarError_spec}requireGrammarError_spec();var parser_spec={},hasRequiredParser_spec;function requireParser_spec(){if(hasRequiredParser_spec)return parser_spec;hasRequiredParser_spec=1;var e=parser_spec&&parser_spec.__spreadArray||function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))},t=require$$0,r=requireParser(),a=t.expect;return describe("Peggy grammar parser",(function(){var n={type:"literal",value:"abcd",ignoreCase:!1},o={type:"literal",value:"efgh",ignoreCase:!1},s={type:"literal",value:"ijkl",ignoreCase:!1},i={type:"literal",value:"mnop",ignoreCase:!1},c={type:"semantic_and",code:" code "},u={type:"semantic_not",code:" code "},l={type:"optional",expression:n},p={type:"zero_or_more",expression:n},f={type:"one_or_more",expression:n},d={type:"text",expression:l},m={type:"simple_not",expression:n},h={type:"simple_and",expression:l},g={type:"simple_not",expression:l},b={type:"labeled",label:"a",expression:n},v={type:"labeled",label:"b",expression:o},y={type:"labeled",label:"a",expression:m},A={type:"sequence",elements:[n,o,s]},x={type:"sequence",elements:[b,v]},_={type:"sequence",elements:[b,v,{type:"labeled",label:"c",expression:s},{type:"labeled",label:"d",expression:i}]},S={type:"group",expression:b},E={type:"group",expression:A},R={type:"action",expression:n,code:" code "},C={type:"action",expression:o,code:" code "},T={type:"action",expression:A,code:" code "},w={type:"choice",alternatives:[n,o,s]},P={type:"choice",alternatives:[R,C]},q={type:"choice",alternatives:[R,C,{type:"action",expression:s,code:" code "},{type:"action",expression:i,code:" code "}]},F={type:"named",name:"start rule",expression:n},$={type:"rule",name:"a",expression:n},L={type:"rule",name:"b",expression:o},B={type:"rule",name:"c",expression:s},D={type:"rule",name:"start",expression:n},I={type:"top_level_initializer",code:" top level code "},k={type:"initializer",code:" code "};function O(e){return{type:"grammar",imports:[],topLevelInitializer:null,initializer:null,rules:[{type:"rule",name:"start",expression:e}]}}function j(e){return O({type:"action",expression:n,code:e})}function M(e,t){return O({type:"literal",value:e,ignoreCase:t})}function N(e,t,r){return O({type:"class",parts:e,inverted:t,ignoreCase:r})}function U(){return O({type:"any"})}function G(e){return O({type:"rule_ref",name:e})}function z(e,t,r,a){return void 0===r&&(r="variable"),void 0===a&&(a=null),O({type:"repeated",min:{type:"string"==typeof e?r:"constant",value:e},max:{type:"string"==typeof t?r:"constant",value:t},expression:n,delimiter:a})}function H(e,t){return z(e,t,"function")}function V(e,t){return z(e,t,"variable",o)}function W(e,t){return z(e,t,"function",o)}var J=M("abcd",!1),Y={type:"grammar",imports:[],topLevelInitializer:null,initializer:null,rules:[$,L]},Z=function(){function t(e){delete e.location,delete e.codeLocation,delete e.nameLocation,delete e.labelLocation}function r(e){delete e.location,delete e.codeLocation,delete e.nameLocation,delete e.labelLocation,o(e.expression)}function a(e){return function(t){delete t.location,delete t.codeLocation,delete t.nameLocation,delete t.labelLocation,t[e].forEach(o)}}var n,o=(n={grammar:function(e){delete e.location,delete e.codeLocation,delete e.nameLocation,delete e.labelLocation,e.topLevelInitializer&&o(e.topLevelInitializer),e.initializer&&o(e.initializer),e.rules.forEach(o)},top_level_initializer:t,initializer:t,rule:r,named:r,choice:a("alternatives"),action:r,sequence:a("elements"),labeled:r,text:r,simple_and:r,simple_not:r,optional:r,zero_or_more:r,one_or_more:r,repeated:function(e){e.min&&(delete e.min.location,delete e.min.codeLocation),delete e.max.location,delete e.max.codeLocation,delete e.location,o(e.expression),e.delimiter&&(delete e.delimiter.location,o(e.delimiter))},group:r,semantic_and:t,semantic_not:t,rule_ref:t,library_ref:t,literal:t,class:t,any:t},function(t){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];return n[t.type].apply(n,e([t],r,!1))});return o}();function K(e,t){var a=e.Assertion;a.addMethod("parseAs",(function(e){var a=r.parse(t.flag(this,"object"));Z(a),this.assert(t.eql(a,e),"expected #{this} to parse as #{exp} but got #{act}","expected #{this} to not parse as #{exp}",e,a,!t.flag(this,"negate"))})),a.addMethod("failToParse",(function(e){var n=!1,o=void 0;try{o=r.parse(t.flag(this,"object")),n=!0}catch(e){o=e}n&&Z(o),this.assert(!n,"expected #{this} to fail to parse but got #{act}","expected #{this} to not fail to parse but it failed with #{act}",null,o),n||void 0===e||Object.keys(e).forEach((function(t){new a(o).to.have.property(t).that.is.deep.equal(e[t])}))}))}beforeEach((function(){t.use(K)})),it("parses Grammar",(function(){a("\na = 'abcd';\n").to.parseAs({type:"grammar",imports:[],topLevelInitializer:null,initializer:null,rules:[$]}),a("\na = 'abcd'; /* comment */; // comment\n;\nb = 'efgh';\nc = 'ijkl';\n").to.parseAs({type:"grammar",imports:[],topLevelInitializer:null,initializer:null,rules:[$,L,B]}),a("\n{ code };\na = 'abcd';\n").to.parseAs({type:"grammar",imports:[],topLevelInitializer:null,initializer:k,rules:[$]}),a("\n{{ top level code }};\na = 'abcd';\n").to.parseAs({type:"grammar",imports:[],topLevelInitializer:I,initializer:null,rules:[$]}),a("\n{{ top level code }};\n{ code };\na = 'abcd';\n").to.parseAs({type:"grammar",imports:[],topLevelInitializer:I,initializer:k,rules:[$]})})),it("parses Top-Level Initializer",(function(){a("{{ top level code }};start = 'abcd'").to.parseAs({type:"grammar",imports:[],topLevelInitializer:I,initializer:null,rules:[D]})})),it("parses Initializer",(function(){a("{ code };start = 'abcd'").to.parseAs({type:"grammar",imports:[],topLevelInitializer:null,initializer:k,rules:[D]})})),it("parses Rule",(function(){a("start\n=\n'abcd';").to.parseAs(O(n)),a("start\n'start rule'\n=\n'abcd';").to.parseAs(O(F))})),it("parses Expression",(function(){a("start = 'abcd' / 'efgh' / 'ijkl'").to.parseAs(O(w))})),it("parses ChoiceExpression",(function(){a("start = 'abcd' { code }").to.parseAs(O(R)),a("start = 'abcd' { code }\n/\n'efgh' { code }").to.parseAs(O(P)),a("start = 'abcd' { code }\n/\n'efgh' { code }\n/\n'ijkl' { code }\n/\n'mnop' { code }").to.parseAs(O(q))})),it("parses ActionExpression",(function(){a("start = 'abcd' 'efgh' 'ijkl'").to.parseAs(O(A)),a("start = 'abcd' 'efgh' 'ijkl'\n{ code }").to.parseAs(O(T))})),it("parses SequenceExpression",(function(){a("start = a:'abcd'").to.parseAs(O(b)),a("start = a:'abcd'\nb:'efgh'").to.parseAs(O(x)),a("start = a: 'abcd'\nb :'efgh'").to.parseAs(O(x)),a("start = a:'abcd'\nb:'efgh'\nc:'ijkl'\nd:'mnop'").to.parseAs(O(_))})),it("parses `@` (value plucking)",(function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return O({type:"sequence",elements:e})}function t(e,t){return{type:"labeled",pick:!0,label:e,expression:t}}a("start = @'abcd'").to.parseAs(e(t(null,n))),a("start = @a:'abcd'").to.parseAs(e(t("a",n))),a("start = @a: 'abcd'").to.parseAs(e(t("a",n))),a("start = @a :'abcd'").to.parseAs(e(t("a",n))),a("start = @a : 'abcd'").to.parseAs(e(t("a",n))),a("start = 'abcd' @'efgh'").to.parseAs(e(n,t(null,o))),a("start = a:'abcd' @b:'efgh'").to.parseAs(e(b,t("b",o))),a("start = @'abcd' b:'efgh'").to.parseAs(e(t(null,n),v)),a("start = a:'abcd' @'efgh' 'ijkl' @d:'mnop'").to.parseAs(e(b,t(null,o),s,t("d",i)))})),it("parses LabeledExpression",(function(){a("start = a\n:\n!'abcd'").to.parseAs(O(y)),a("start = !'abcd'").to.parseAs(O(m))})),it("parses PrefixedExpression",(function(){a("start = !\n'abcd'?").to.parseAs(O(g)),a("start = 'abcd'?").to.parseAs(O(l))})),it("parses PrefixedOperator",(function(){a("start = $'abcd'?").to.parseAs(O(d)),a("start = &'abcd'?").to.parseAs(O(h)),a("start = !'abcd'?").to.parseAs(O(g))})),it("parses SuffixedExpression",(function(){a("start = 'abcd'\n?").to.parseAs(O(l)),a("start = 'abcd'").to.parseAs(O(n))})),it("parses SuffixedOperator",(function(){a("start = 'abcd'?").to.parseAs(O(l)),a("start = 'abcd'*").to.parseAs(O(p)),a("start = 'abcd'+").to.parseAs(O(f))})),it("parses PrimaryExpression",(function(){a("start = 'abcd'").to.parseAs(J),a("start = [a-d]").to.parseAs(N([["a","d"]],!1,!1)),a("start = .").to.parseAs(U()),a("start = a").to.parseAs(G("a")),a("start = &{ code }").to.parseAs(O(c)),a("start = (\na:'abcd'\n)").to.parseAs(O(S)),a("start = (\n'abcd' 'efgh' 'ijkl'\n)").to.parseAs(O(E)),a("start = (\n'abcd'\n)").to.parseAs(J)})),describe("parses RepeatedExpression",(function(){describe("without delimiter",(function(){it("with constant boundaries",(function(){var e=z(2,3);a("start = 'abcd'|2..3|  ").to.parseAs(e),a("start = 'abcd'\n|2..3|").to.parseAs(e),a("start = 'abcd'|\n2..3|").to.parseAs(e),a("start = 'abcd'|2\n..3|").to.parseAs(e),a("start = 'abcd'|2..\n3|").to.parseAs(e),a("start = 'abcd'|2..3\n|").to.parseAs(e),e=O({type:"repeated",min:null,max:{type:"constant",value:3},expression:n,delimiter:null}),a("start = 'abcd'\n|3|").to.parseAs(e),a("start = 'abcd'|\n3|").to.parseAs(e),a("start = 'abcd'|3\n|").to.parseAs(e)})),it("with variable boundaries",(function(){var e=z("min","max");a("start = 'abcd'|min..max|  ").to.parseAs(e),a("start = 'abcd'\n|min..max|").to.parseAs(e),a("start = 'abcd'|\nmin..max|").to.parseAs(e),a("start = 'abcd'|min\n..max|").to.parseAs(e),a("start = 'abcd'|min..\nmax|").to.parseAs(e),a("start = 'abcd'|min..max\n|").to.parseAs(e),e=O({type:"repeated",min:null,max:{type:"variable",value:"exact"},expression:n,delimiter:null}),a("start = 'abcd'\n|exact|").to.parseAs(e),a("start = 'abcd'|\nexact|").to.parseAs(e),a("start = 'abcd'|exact\n|").to.parseAs(e)})),it("with function boundaries",(function(){var e=H("min","max");a("start = 'abcd'|{min}..{max}|  ").to.parseAs(e),a("start = 'abcd'\n|{min}..{max}|").to.parseAs(e),a("start = 'abcd'|\n{min}..{max}|").to.parseAs(e),a("start = 'abcd'|{min}\n..{max}|").to.parseAs(e),a("start = 'abcd'|{min}..\n{max}|").to.parseAs(e),a("start = 'abcd'|{min}..{max}\n|").to.parseAs(e),e=O({type:"repeated",min:null,max:{type:"function",value:"exact"},expression:n,delimiter:null}),a("start = 'abcd'\n|{exact}|").to.parseAs(e),a("start = 'abcd'|\n{exact}|").to.parseAs(e),a("start = 'abcd'|{exact}\n|").to.parseAs(e)})),it("with mixed boundaries",(function(){var e=z(2,"max");a("start = 'abcd'|2..max|  ").to.parseAs(e),a("start = 'abcd'\n|2..max|").to.parseAs(e),a("start = 'abcd'|\n2..max|").to.parseAs(e),a("start = 'abcd'|2\n..max|").to.parseAs(e),a("start = 'abcd'|2..\nmax|").to.parseAs(e),a("start = 'abcd'|2..max\n|").to.parseAs(e),e=z("min",3),a("start = 'abcd'|min..3|  ").to.parseAs(e),a("start = 'abcd'\n|min..3|").to.parseAs(e),a("start = 'abcd'|\nmin..3|").to.parseAs(e),a("start = 'abcd'|min\n..3|").to.parseAs(e),a("start = 'abcd'|min..\n3|").to.parseAs(e),a("start = 'abcd'|min..3\n|").to.parseAs(e)}))})),describe("with delimiter",(function(){it("with constant boundaries",(function(){var e=V(2,3);a("start = 'abcd'|2..3,'efgh'|  ").to.parseAs(e),a("start = 'abcd'\n|2..3,'efgh'|").to.parseAs(e),a("start = 'abcd'|\n2..3,'efgh'|").to.parseAs(e),a("start = 'abcd'|2\n..3,'efgh'|").to.parseAs(e),a("start = 'abcd'|2..\n3,'efgh'|").to.parseAs(e),a("start = 'abcd'|2..3\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|2..3,\n'efgh'|").to.parseAs(e),a("start = 'abcd'|2..3,'efgh'\n|").to.parseAs(e),e=O({type:"repeated",min:null,max:{type:"constant",value:3},expression:n,delimiter:o}),a("start = 'abcd'\n|3,'efgh'|").to.parseAs(e),a("start = 'abcd'|\n3,'efgh'|").to.parseAs(e),a("start = 'abcd'|3\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|3,\n'efgh'|").to.parseAs(e),a("start = 'abcd'|3,'efgh'\n|").to.parseAs(e),a("start = 'abcd'|3, 'efgh'?|").to.parseAs(O({type:"repeated",min:null,max:{type:"constant",value:3},expression:n,delimiter:{type:"optional",expression:o}}))})),it("with variable boundaries",(function(){var e=V("min","max");a("start = 'abcd'|min..max,'efgh'|  ").to.parseAs(e),a("start = 'abcd'\n|min..max,'efgh'|").to.parseAs(e),a("start = 'abcd'|\nmin..max,'efgh'|").to.parseAs(e),a("start = 'abcd'|min\n..max,'efgh'|").to.parseAs(e),a("start = 'abcd'|min..\nmax,'efgh'|").to.parseAs(e),a("start = 'abcd'|min..max\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|min..max,\n'efgh'|").to.parseAs(e),a("start = 'abcd'|min..max,'efgh'\n|").to.parseAs(e),e=O({type:"repeated",min:null,max:{type:"variable",value:"exact"},expression:n,delimiter:o}),a("start = 'abcd'\n|exact,'efgh'|").to.parseAs(e),a("start = 'abcd'|\nexact,'efgh'|").to.parseAs(e),a("start = 'abcd'|exact\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|exact,\n'efgh'|").to.parseAs(e),a("start = 'abcd'|exact,'efgh'\n|").to.parseAs(e),a("start = 'abcd'|exact, 'efgh'?|").to.parseAs(O({type:"repeated",min:null,max:{type:"variable",value:"exact"},expression:n,delimiter:{type:"optional",expression:o}}))})),it("with function boundaries",(function(){var e=W("min","max");a("start = 'abcd'|{min}..{max},'efgh'|  ").to.parseAs(e),a("start = 'abcd'\n|{min}..{max},'efgh'|").to.parseAs(e),a("start = 'abcd'|\n{min}..{max},'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}\n..{max},'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}..\n{max},'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}..{max}\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}..{max},\n'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}..{max},'efgh'\n|").to.parseAs(e),e=O({type:"repeated",min:null,max:{type:"function",value:"exact"},expression:n,delimiter:o}),a("start = 'abcd'\n|{exact},'efgh'|").to.parseAs(e),a("start = 'abcd'|\n{exact},'efgh'|").to.parseAs(e),a("start = 'abcd'|{exact}\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|{exact},\n'efgh'|").to.parseAs(e),a("start = 'abcd'|{exact},'efgh'\n|").to.parseAs(e),a("start = 'abcd'|{exact}, 'efgh'?|").to.parseAs(O({type:"repeated",min:null,max:{type:"function",value:"exact"},expression:n,delimiter:{type:"optional",expression:o}}))})),it("with mixed boundaries",(function(){var e=V(2,"max");a("start = 'abcd'|2..max,'efgh'|  ").to.parseAs(e),a("start = 'abcd'\n|2..max,'efgh'|").to.parseAs(e),a("start = 'abcd'|\n2..max,'efgh'|").to.parseAs(e),a("start = 'abcd'|2\n..max,'efgh'|").to.parseAs(e),a("start = 'abcd'|2..\nmax,'efgh'|").to.parseAs(e),a("start = 'abcd'|2..max\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|2..max,\n'efgh'|").to.parseAs(e),a("start = 'abcd'|2..max,'efgh'\n|").to.parseAs(e),e=V("min",3),a("start = 'abcd'|min..3,'efgh'|  ").to.parseAs(e),a("start = 'abcd'\n|min..3,'efgh'|").to.parseAs(e),a("start = 'abcd'|\nmin..3,'efgh'|").to.parseAs(e),a("start = 'abcd'|min\n..3,'efgh'|").to.parseAs(e),a("start = 'abcd'|min..\n3,'efgh'|").to.parseAs(e),a("start = 'abcd'|min..3\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|min..3,\n'efgh'|").to.parseAs(e),a("start = 'abcd'|min..3,'efgh'\n|").to.parseAs(e),e=W(2,"max"),a("start = 'abcd'|2..{max},'efgh'|  ").to.parseAs(e),a("start = 'abcd'\n|2..{max},'efgh'|").to.parseAs(e),a("start = 'abcd'|\n2..{max},'efgh'|").to.parseAs(e),a("start = 'abcd'|2\n..{max},'efgh'|").to.parseAs(e),a("start = 'abcd'|2..\n{max},'efgh'|").to.parseAs(e),a("start = 'abcd'|2..{max}\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|2..{max},\n'efgh'|").to.parseAs(e),a("start = 'abcd'|2..{max},'efgh'\n|").to.parseAs(e),e=W("min",3),a("start = 'abcd'|{min}..3,'efgh'|  ").to.parseAs(e),a("start = 'abcd'\n|{min}..3,'efgh'|").to.parseAs(e),a("start = 'abcd'|\n{min}..3,'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}\n..3,'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}..\n3,'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}..3\n,'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}..3,\n'efgh'|").to.parseAs(e),a("start = 'abcd'|{min}..3,'efgh'\n|").to.parseAs(e)}))}))})),describe("parses RepeatedOperator",(function(){describe("without delimiter",(function(){it("with constant boundaries",(function(){a("start = 'abcd'| .. |").to.parseAs(z(0,null)),a("start = 'abcd'|0.. |").to.parseAs(z(0,null)),a("start = 'abcd'|1.. |").to.parseAs(z(1,null)),a("start = 'abcd'|2.. |").to.parseAs(z(2,null)),a("start = 'abcd'| ..1|").to.parseAs(z(0,1)),a("start = 'abcd'| ..2|").to.parseAs(z(0,2)),a("start = 'abcd'|2..2|").to.parseAs(z(2,2)),a("start = 'abcd'|2..3|").to.parseAs(z(2,3)),a("start = 'abcd'|3|   ").to.parseAs(O({type:"repeated",min:null,max:{type:"constant",value:3},expression:n,delimiter:null})),a("start = 'abcd'| ..0|").to.failToParse(),a("start = 'abcd'|0..0|").to.failToParse(),a("start = 'abcd'|0|   ").to.failToParse()})),it("with variable boundaries",(function(){a("start = 'abcd'|min..   |").to.parseAs(z("min",null)),a("start = 'abcd'|   ..max|").to.parseAs(z(0,"max")),a("start = 'abcd'|min..max|").to.parseAs(z("min","max")),a("start = 'abcd'|exact|   ").to.parseAs(O({type:"repeated",min:null,max:{type:"variable",value:"exact"},expression:n,delimiter:null}))})),it("with function boundaries",(function(){a("start = 'abcd'|{min}..     |").to.parseAs(H("min",null)),a("start = 'abcd'|     ..{max}|").to.parseAs(H(0,"max")),a("start = 'abcd'|{min}..{max}|").to.parseAs(H("min","max")),a("start = 'abcd'|{exact}|     ").to.parseAs(O({type:"repeated",min:null,max:{type:"function",value:"exact"},expression:n,delimiter:null}))})),it("with mixed boundaries",(function(){a("start = 'abcd'|2..max|").to.parseAs(z(2,"max")),a("start = 'abcd'|min..3|").to.parseAs(z("min",3)),a("start = 'abcd'|2..{max}|").to.parseAs(H(2,"max")),a("start = 'abcd'|{min}..3|").to.parseAs(H("min",3))}))})),describe("with delimiter",(function(){it("with constant boundaries",(function(){a("start = 'abcd'| .. , 'efgh'|").to.parseAs(V(0,null)),a("start = 'abcd'|0.. , 'efgh'|").to.parseAs(V(0,null)),a("start = 'abcd'|1.. , 'efgh'|").to.parseAs(V(1,null)),a("start = 'abcd'|2.. , 'efgh'|").to.parseAs(V(2,null)),a("start = 'abcd'| ..1, 'efgh'|").to.parseAs(V(0,1)),a("start = 'abcd'| ..2, 'efgh'|").to.parseAs(V(0,2)),a("start = 'abcd'|2..2, 'efgh'|").to.parseAs(V(2,2)),a("start = 'abcd'|2..3, 'efgh'|").to.parseAs(V(2,3)),a("start = 'abcd'|3   , 'efgh'|").to.parseAs(O({type:"repeated",min:null,max:{type:"constant",value:3},expression:n,delimiter:o})),a("start = 'abcd'| ..0, 'efgh'|").to.failToParse(),a("start = 'abcd'|0..0, 'efgh'|").to.failToParse(),a("start = 'abcd'|0   , 'efgh'|").to.failToParse()})),it("with variable boundaries",(function(){a("start = 'abcd'|min..   , 'efgh'|").to.parseAs(V("min",null)),a("start = 'abcd'|   ..max, 'efgh'|").to.parseAs(V(0,"max")),a("start = 'abcd'|min..max, 'efgh'|").to.parseAs(V("min","max")),a("start = 'abcd'|exact, 'efgh'|   ").to.parseAs(O({type:"repeated",min:null,max:{type:"variable",value:"exact"},expression:n,delimiter:o}))})),it("with function boundaries",(function(){a("start = 'abcd'|{min}..     , 'efgh'|").to.parseAs(W("min",null)),a("start = 'abcd'|     ..{max}, 'efgh'|").to.parseAs(W(0,"max")),a("start = 'abcd'|{min}..{max}, 'efgh'|").to.parseAs(W("min","max")),a("start = 'abcd'|{exact},      'efgh'|").to.parseAs(O({type:"repeated",min:null,max:{type:"function",value:"exact"},expression:n,delimiter:o}))})),it("with mixed boundaries",(function(){a("start = 'abcd'|2..max, 'efgh'|").to.parseAs(V(2,"max")),a("start = 'abcd'|min..3, 'efgh'|").to.parseAs(V("min",3)),a("start = 'abcd'|2..{max}, 'efgh'|").to.parseAs(W(2,"max")),a("start = 'abcd'|{min}..3, 'efgh'|").to.parseAs(W("min",3))}))}))})),it("parses RuleReferenceExpression",(function(){a("start = a").to.parseAs(G("a")),a("start = a\n=").to.failToParse(),a("start = a\n'abcd'\n=").to.failToParse()})),it("parses SemanticPredicateExpression",(function(){a("start = !\n{ code }").to.parseAs(O(u))})),it("parses SemanticPredicateOperator",(function(){a("start = &{ code }").to.parseAs(O(c)),a("start = !{ code }").to.parseAs(O(u))})),it("parses WhiteSpace",(function(){a("start =\t'abcd'").to.parseAs(J),a("start =\v'abcd'").to.parseAs(J),a("start =\f'abcd'").to.parseAs(J),a("start = 'abcd'").to.parseAs(J),a("start ='abcd'").to.parseAs(J),a("start =\ufeff'abcd'").to.parseAs(J),a("start ='abcd'").to.parseAs(J)})),it("parses LineTerminator",(function(){a("start = '\n'").to.failToParse(),a("start = '\r'").to.failToParse(),a("start = '\u2028'").to.failToParse(),a("start = '\u2029'").to.failToParse()})),it("parses LineTerminatorSequence",(function(){a("start =\n'abcd'").to.parseAs(J),a("start =\r\n'abcd'").to.parseAs(J),a("start =\r'abcd'").to.parseAs(J),a("start =\u2028'abcd'").to.parseAs(J),a("start =\u2029'abcd'").to.parseAs(J)})),it("parses Comment",(function(){a("start =// comment\n'abcd'").to.parseAs(J),a("start =/* comment */'abcd'").to.parseAs(J)})),it("parses MultiLineComment",(function(){a("start =/**/'abcd'").to.parseAs(J),a("start =/*a*/'abcd'").to.parseAs(J),a("start =/*abc*/'abcd'").to.parseAs(J),a("start =/**/*/'abcd'").to.failToParse()})),it("parses MultiLineCommentNoLineTerminator",(function(){a("a = 'abcd'/**/\r\nb = 'efgh'").to.parseAs(Y),a("a = 'abcd'/*a*/\r\nb = 'efgh'").to.parseAs(Y),a("a = 'abcd'/*abc*/\r\nb = 'efgh'").to.parseAs(Y),a("a = 'abcd'/**/*/\r\nb = 'efgh'").to.failToParse(),a("a = 'abcd'/*\n*/\r\nb = 'efgh'").to.failToParse()})),it("parses SingleLineComment",(function(){a("start =//\n'abcd'").to.parseAs(J),a("start =//a\n'abcd'").to.parseAs(J),a("start =//abc\n'abcd'").to.parseAs(J),a("start =//\n@\n'abcd'").to.failToParse()})),it("parses Identifier",(function(){a("start = a:'abcd'").to.parseAs(O(b))})),it("parses IdentifierName",(function(){a("start = a").to.parseAs(G("a")),a("start = ab").to.parseAs(G("ab")),a("start = abcd").to.parseAs(G("abcd"))})),it("parses IdentifierStart",(function(){a("start = a").to.parseAs(G("a")),a("start = $").to.failToParse(),a("$start = a").to.failToParse(),a("start = a$b").to.parseAs(G("a$b")),a("start = _").to.parseAs(G("_")),a("start = \\u0061").to.parseAs(G("a"))})),it("parses IdentifierPart",(function(){a("start = aa").to.parseAs(G("aa")),a("start = a").to.parseAs(G("a")),a("start = a0").to.parseAs(G("a0")),a("start = a").to.parseAs(G("a")),a("start = a").to.parseAs(G("a")),a("start = a").to.parseAs(G("a"))})),it("parses LiteralMatcher",(function(){a("start = 'abcd'").to.parseAs(M("abcd",!1)),a("start = 'abcd'i").to.parseAs(M("abcd",!0))})),it("parses StringLiteral",(function(){a('start = ""').to.parseAs(M("",!1)),a('start = "a"').to.parseAs(M("a",!1)),a('start = "abc"').to.parseAs(M("abc",!1)),a("start = ''").to.parseAs(M("",!1)),a("start = 'a'").to.parseAs(M("a",!1)),a("start = 'abc'").to.parseAs(M("abc",!1))})),it("parses DoubleStringCharacter",(function(){a('start = "a"').to.parseAs(M("a",!1)),a('start = "\\n"').to.parseAs(M("\n",!1)),a('start = "\\\n"').to.parseAs(M("",!1)),a('start = """').to.failToParse(),a('start = "\\"').to.failToParse(),a('start = "\n"').to.failToParse()})),it("parses SingleStringCharacter",(function(){a("start = 'a'").to.parseAs(M("a",!1)),a("start = '\\n'").to.parseAs(M("\n",!1)),a("start = '\\\n'").to.parseAs(M("",!1)),a("start = '''").to.failToParse(),a("start = '\\'").to.failToParse(),a("start = '\n'").to.failToParse()})),it("parses CharacterClassMatcher",(function(){a("start = []").to.parseAs(N([],!1,!1)),a("start = [a-d]").to.parseAs(N([["a","d"]],!1,!1)),a("start = [a]").to.parseAs(N(["a"],!1,!1)),a("start = [a-de-hi-l]").to.parseAs(N([["a","d"],["e","h"],["i","l"]],!1,!1)),a("start = [^a-d]").to.parseAs(N([["a","d"]],!0,!1)),a("start = [a-d]i").to.parseAs(N([["a","d"]],!1,!0)),a("start = [\\\n]").to.parseAs(N([],!1,!1))})),it("parses ClassCharacterRange",(function(){a("start = [a-d]").to.parseAs(N([["a","d"]],!1,!1)),a("start = [a-a]").to.parseAs(N([["a","a"]],!1,!1)),a("start = [b-a]").to.failToParse({message:"Invalid character range: b-a."})})),it("parses ClassCharacter",(function(){a("start = [a]").to.parseAs(N(["a"],!1,!1)),a("start = [\\n]").to.parseAs(N(["\n"],!1,!1)),a("start = [\\\n]").to.parseAs(N([],!1,!1)),a("start = []]").to.failToParse(),a("start = [\\]").to.failToParse(),a("start = [\n]").to.failToParse()})),it("parses LineContinuation",(function(){a("start = '\\\r\n'").to.parseAs(M("",!1))})),it("parses EscapeSequence",(function(){a("start = '\\n'").to.parseAs(M("\n",!1)),a("start = '\\0'").to.parseAs(M("\0",!1)),a("start = '\\xFF'").to.parseAs(M("",!1)),a("start = '\\uFFFF'").to.parseAs(M("",!1)),a("start = '\\09'").to.failToParse()})),it("parses CharacterEscapeSequence",(function(){a("start = '\\n'").to.parseAs(M("\n",!1)),a("start = '\\a'").to.parseAs(M("a",!1))})),it("parses SingleEscapeCharacter",(function(){a("start = '\\''").to.parseAs(M("'",!1)),a("start = '\\\"'").to.parseAs(M('"',!1)),a("start = '\\\\'").to.parseAs(M("\\",!1)),a("start = '\\b'").to.parseAs(M("\b",!1)),a("start = '\\f'").to.parseAs(M("\f",!1)),a("start = '\\n'").to.parseAs(M("\n",!1)),a("start = '\\r'").to.parseAs(M("\r",!1)),a("start = '\\t'").to.parseAs(M("\t",!1)),a("start = '\\v'").to.parseAs(M("\v",!1))})),it("parses NonEscapeCharacter",(function(){a("start = '\\a'").to.parseAs(M("a",!1))})),it("parses HexEscapeSequence",(function(){a("start = '\\xFF'").to.parseAs(M("",!1))})),it("parses UnicodeEscapeSequence",(function(){a("start = '\\uFFFF'").to.parseAs(M("",!1))})),it("parses AnyMatcher",(function(){a("start = .").to.parseAs(U())})),it("parses CodeBlock",(function(){a("start = 'abcd' { code }").to.parseAs(j(" code "))})),it("parses Code",(function(){a("start = 'abcd' {a}").to.parseAs(j("a")),a("start = 'abcd' {abc}").to.parseAs(j("abc")),a("start = 'abcd' {{a}}").to.parseAs(j("{a}")),a("start = 'abcd' {{a}{b}{c}}").to.parseAs(j("{a}{b}{c}")),a("start = 'abcd' {{}").to.failToParse(),a("start = 'abcd' {}}").to.failToParse()})),it("parses __",(function(){a("start ='abcd'").to.parseAs(J),a("start = 'abcd'").to.parseAs(J),a("start =\r\n'abcd'").to.parseAs(J),a("start =/* comment */'abcd'").to.parseAs(J),a("start =   'abcd'").to.parseAs(J)})),it("parses _",(function(){a("a = 'abcd'\r\nb = 'efgh'").to.parseAs(Y),a("a = 'abcd' \r\nb = 'efgh'").to.parseAs(Y),a("a = 'abcd'/* comment */\r\nb = 'efgh'").to.parseAs(Y),a("a = 'abcd'   \r\nb = 'efgh'").to.parseAs(Y)})),it("parses EOS",(function(){a("a = 'abcd'\n;b = 'efgh'").to.parseAs(Y),a("a = 'abcd' \r\nb = 'efgh'").to.parseAs(Y),a("a = 'abcd' // comment\r\nb = 'efgh'").to.parseAs(Y),a("a = 'abcd'\nb = 'efgh'").to.parseAs(Y)})),it("parses EOF",(function(){a("start = 'abcd'\n").to.parseAs(J)})),it("generates codeLocation / nameLocation / labelLocation",(function(){var e=r.parse("\n{{\n  const foo = 12;\n}}\n{\n  const bar = 13;\n}\na = label:'abcd' &{ return true; } !{ return false; } { return 'so true'; }\nb = @LABEL:'efgh'\nc = @'ijkl'\n");a(e).to.eql({type:"grammar",imports:[],topLevelInitializer:{type:"top_level_initializer",code:"\n  const foo = 12;\n",codeLocation:{source:void 0,start:{offset:3,line:2,column:3},end:{offset:22,line:4,column:1}},location:{source:void 0,start:{offset:1,line:2,column:1},end:{offset:25,line:5,column:1}}},initializer:{type:"initializer",code:"\n  const bar = 13;\n",codeLocation:{source:void 0,start:{offset:26,line:5,column:2},end:{offset:45,line:7,column:1}},location:{source:void 0,start:{offset:25,line:5,column:1},end:{offset:47,line:8,column:1}}},rules:[{type:"rule",name:"a",nameLocation:{source:void 0,start:{offset:47,line:8,column:1},end:{offset:48,line:8,column:2}},expression:{type:"action",expression:{type:"sequence",elements:[{type:"labeled",label:"label",labelLocation:{source:void 0,start:{offset:51,line:8,column:5},end:{offset:56,line:8,column:10}},expression:{type:"literal",value:"abcd",ignoreCase:!1,location:{source:void 0,start:{offset:57,line:8,column:11},end:{offset:63,line:8,column:17}}},location:{source:void 0,start:{offset:51,line:8,column:5},end:{offset:63,line:8,column:17}}},{type:"semantic_and",code:" return true; ",codeLocation:{source:void 0,start:{offset:66,line:8,column:20},end:{offset:80,line:8,column:34}},location:{source:void 0,start:{offset:64,line:8,column:18},end:{offset:81,line:8,column:35}}},{type:"semantic_not",code:" return false; ",codeLocation:{source:void 0,start:{offset:84,line:8,column:38},end:{offset:99,line:8,column:53}},location:{source:void 0,start:{offset:82,line:8,column:36},end:{offset:100,line:8,column:54}}}],location:{source:void 0,start:{offset:51,line:8,column:5},end:{offset:100,line:8,column:54}}},code:" return 'so true'; ",codeLocation:{source:void 0,start:{offset:102,line:8,column:56},end:{offset:121,line:8,column:75}},location:{source:void 0,start:{offset:51,line:8,column:5},end:{offset:122,line:8,column:76}}},location:{source:void 0,start:{offset:47,line:8,column:1},end:{offset:123,line:9,column:1}}},{type:"rule",name:"b",nameLocation:{source:void 0,start:{offset:123,line:9,column:1},end:{offset:124,line:9,column:2}},expression:{type:"sequence",elements:[{type:"labeled",label:"LABEL",labelLocation:{source:void 0,start:{offset:128,line:9,column:6},end:{offset:133,line:9,column:11}},pick:!0,expression:{type:"literal",value:"efgh",ignoreCase:!1,location:{source:void 0,start:{offset:134,line:9,column:12},end:{offset:140,line:9,column:18}}},location:{source:void 0,start:{offset:127,line:9,column:5},end:{offset:140,line:9,column:18}}}],location:{source:void 0,start:{offset:127,line:9,column:5},end:{offset:140,line:9,column:18}}},location:{source:void 0,start:{offset:123,line:9,column:1},end:{offset:141,line:10,column:1}}},{type:"rule",name:"c",nameLocation:{source:void 0,start:{offset:141,line:10,column:1},end:{offset:142,line:10,column:2}},expression:{type:"sequence",elements:[{type:"labeled",label:null,labelLocation:{source:void 0,start:{offset:145,line:10,column:5},end:{offset:146,line:10,column:6}},pick:!0,expression:{type:"literal",value:"ijkl",ignoreCase:!1,location:{source:void 0,start:{offset:146,line:10,column:6},end:{offset:152,line:10,column:12}}},location:{source:void 0,start:{offset:145,line:10,column:5},end:{offset:152,line:10,column:12}}}],location:{source:void 0,start:{offset:145,line:10,column:5},end:{offset:152,line:10,column:12}}},location:{source:void 0,start:{offset:141,line:10,column:1},end:{offset:153,line:11,column:1}}}],location:{source:void 0,start:{offset:0,line:1,column:1},end:{offset:153,line:11,column:1}}})}))})),parser_spec}requireParser_spec()},"object"==typeof exports&&"undefined"!=typeof module?factory(require("chai"),require("whatwg-url")):"function"==typeof define&&define.amd?define(["chai","whatwg-url"],factory):factory((global="undefined"!=typeof globalThis?globalThis:global||self).chai,global.whatwgURL);